(()=>{var e={};e.id=1682,e.ids=[1682],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},9714:e=>{"use strict";e.exports=require("constants")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6162:e=>{"use strict";e.exports=require("worker_threads")},71568:e=>{"use strict";e.exports=require("zlib")},95622:(e,t,l)=>{"use strict";l.r(t),l.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>g,tree:()=>d}),l(83435),l(81597),l(93355),l(36811),l(20230),l(49356),l(90996);var a=l(30170),r=l(45002),n=l(83876),o=l.n(n),i=l(66299),s={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>i[e]);l.d(t,s);let d=["",{children:["opportunity",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(l.bind(l,83435)),"E:\\riot\\sparking\\sp_1\\src\\app\\opportunity\\dashboard\\page.tsx"]}]},{error:[()=>Promise.resolve().then(l.bind(l,81597)),"E:\\riot\\sparking\\sp_1\\src\\app\\opportunity\\dashboard\\error.tsx"]}]},{layout:[()=>Promise.resolve().then(l.bind(l,93355)),"E:\\riot\\sparking\\sp_1\\src\\app\\opportunity\\layout.tsx"],error:[()=>Promise.resolve().then(l.bind(l,36811)),"E:\\riot\\sparking\\sp_1\\src\\app\\opportunity\\error.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(l.bind(l,28204))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(l.bind(l,20230)),"E:\\riot\\sparking\\sp_1\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(l.bind(l,49356)),"E:\\riot\\sparking\\sp_1\\src\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(l.t.bind(l,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(l.bind(l,28204))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["E:\\riot\\sparking\\sp_1\\src\\app\\opportunity\\dashboard\\page.tsx"],u="/opportunity/dashboard/page",p={require:l,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/opportunity/dashboard/page",pathname:"/opportunity/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},31416:(e,t,l)=>{Promise.resolve().then(l.bind(l,98952))},65242:(e,t,l)=>{Promise.resolve().then(l.bind(l,28365))},2761:(e,t,l)=>{"use strict";l.d(t,{default:()=>r.a});var a=l(27692),r=l.n(a)},27692:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let a=l(20352);l(97247),l(28964);let r=a._(l(22404));function n(e,t){var l;let a={loading:e=>{let{error:t,isLoading:l,pastDelay:a}=e;return null}};"function"==typeof e&&(a.loader=e);let n={...a,...t};return(0,r.default)({...n,modules:null==(l=n.loadableGenerated)?void 0:l.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},99304:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}});let a=l(47173);function r(e){let{reason:t,children:l}=e;throw new a.BailoutToCSRError(t)}},22404:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let a=l(97247),r=l(28964),n=l(99304),o=l(24146);function i(e){return{default:e&&"default"in e?e.default:e}}let s={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},d=function(e){let t={...s,...e},l=(0,r.lazy)(()=>t.loader().then(i)),d=t.loading;function c(e){let i=d?(0,a.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,s=t.ssr?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.PreloadCss,{moduleIds:t.modules}),(0,a.jsx)(l,{...e})]}):(0,a.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(l,{...e})});return(0,a.jsx)(r.Suspense,{fallback:i,children:s})}return c.displayName="LoadableComponent",c}},24146:(e,t,l)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return n}});let a=l(97247),r=l(54580);function n(e){let{moduleIds:t}=e,l=(0,r.getExpectedRequestStore)("next/dynamic css"),n=[];if(l.reactLoadableManifest&&t){let e=l.reactLoadableManifest;for(let l of t){if(!e[l])continue;let t=e[l].files.filter(e=>e.endsWith(".css"));n.push(...t)}}return 0===n.length?null:(0,a.jsx)(a.Fragment,{children:n.map(e=>(0,a.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:l.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},98952:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>n});var a=l(97247),r=l(87467);function n({error:e,reset:t}){return a.jsx("div",{children:a.jsx(r.Z,{handleBtn:t,value:e.message})})}},28365:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>q});var a=l(97247),r=l(49509),n=l(2761),o=l(28964),i=l(82140),s=l(77951),d=l(41479),c=l(39884),u=l(61410),p=l(77709),g=l(96538),m=l(23102),h=l(76181),x=l(99539),f=l(19023),C=l(16523),b=l(67552),y=l(34178),v=l(69486),_=l(65170),j=l(8353),w=l(27035),T=l.n(w),F=l(17082);function N({idOpportunity:e,refBtn:t}){let[l,r]=(0,o.useState)(25),[n,i]=(0,o.useState)([]),[h,f]=(0,o.useState)(!1),[b,v]=(0,o.useState)(0),{datas:_}=(0,m.v9)(e=>e.unit_product),w=async e=>{let t=(e,t,l)=>{let a=e.split("\n");return l*(a.length+a.reduce((e,l)=>Math.ceil(l.length/t)-1+e,0))*100/80},l=e.parts.map(e=>({title:e.title,list:e.products.map(e=>({name:e.name,description:e.description,refresh_code:e.code_original,brand:e.brand.name+" "+e.original.name,unit:e.unit_product.name_unit,quantity:e.quantity,profit:e.profit.type_profit,price:e.price,list_detail:e.list_detail})),type:!!e.products.find(e=>e.list_detail.length>0)})),a=new(T()).Workbook,r=a.addWorksheet("Sheet 1"),n=await fetch("/image/header.png").then(e=>e.arrayBuffer()),o=[{title:"Điều khoản thương mại chung",list:["Địa điểm giao h\xe0ng: Gi\xe1 tr\xean được hiểu l\xe0 gi\xe1 giao h\xe0ng đến c\xf4ng tr\xecnh","Thiết bị cung cấp v\xe0 thi c\xf4ng, lắp đặt l\xe0 h\xe0ng h\xf3a mới 100%","Bảng gi\xe1 n\xe0y c\xf3 gi\xe1 trị 30 ng\xe0y kể từ ng\xe0y b\xe1o gi\xe1","Thời hạn thực hiện: Trong v\xf2ng 4-6 tuần kể từ ng\xe0y k\xfd hợp đồng hoặc b\xe1o gi\xe1 c\xf3 hiệu lực"]}],i=Buffer.from(n),s=a.addImage({buffer:i,extension:"png"});r.addImage(s,{tl:{col:1,row:0},ext:{width:1021,height:120}});let d=[{index:10,height:22.8},{index:11,height:20.4},{index:14,height:20.1},{index:15,height:20.1},{index:16,height:20.1},{index:17,height:20.1},{index:18,height:20.1},{index:19,height:20.1},{index:24,height:59.1}];r.mergeCells("B10:J10"),r.getCell("B10").alignment={horizontal:"center",vertical:"middle",wrapText:!0},r.mergeCells("B11:J11"),r.getCell("B11").alignment={horizontal:"center",vertical:"middle",wrapText:!0};for(let e=0;e<d.length;e++)r.getRow(d[e].index).height=100*d[e].height/80;r.getCell("B10").value={richText:[{text:e?.project?.name??"",font:{bold:!0,size:18,name:"Arial"}}]},r.getCell("B11").value={richText:[{text:"Option 2: Entrance and Exit controlled by manpower (Parking Toll: BOOTH)",font:{bold:!1,size:16,color:{argb:"FF0000"},name:"Arial"}}]},r.getCell("B14").value={richText:[{text:"K\xednh gửi/To: ",font:{bold:!1}},{text:e?.project?.customer?.name_company.toUpperCase()??e?.customer?.name_company.toUpperCase()??"",font:{bold:!0}}]},r.getCell("B15").value={richText:[{text:"Địa chỉ/Address: ",font:{bold:!1}},{text:(e?.project?.customer?.address_delivery??e?.customer?.address_delivery??","+e?.project?.customer?.province_delivery?.name_province).toUpperCase()??e?.customer?.province_delivery?.name_province.toUpperCase()??"",font:{bold:!0}}]},r.getCell("B16").value={richText:[{text:"Người nhận/Receiver: ",font:{bold:!1}},{text:e?.project?.customer?.name_company.toUpperCase()??e?.customer?.name_company.toUpperCase()??"",font:{bold:!0}}]},r.getCell("B17").value={richText:[{text:"Tel: ",font:{bold:!1}},{text:e?.project?.customer?.phone_number.toUpperCase()??e?.customer?.phone_number.toUpperCase()??"",font:{bold:!0}}]},r.getCell("B18").value={richText:[{text:"Email: ",font:{bold:!1}},{text:e?.project?.customer?.phone_number??e?.customer?.phone_number??"",font:{bold:!0}}]},r.getCell("G14").value={richText:[{text:"Số b\xe1o gi\xe1/Quotation: ",font:{bold:!1}},{text:e.price_quote_id.toUpperCase(),font:{bold:!0}}]},r.getCell("G15").value={richText:[{text:"Ng\xe0y b\xe1o gi\xe1/Date: ",font:{bold:!1}},{text:new Date(e.created_at).toLocaleDateString("vi-VN")??"N/A",font:{bold:!0}}]},r.getCell("G16").value={richText:[{text:"Người b\xe1o gi\xe1/ Quoted by: ",font:{bold:!1}},{text:(e.user_support?.first_name??" "+e.user_support?.last_name??"").toUpperCase(),font:{bold:!0}}]},r.getCell("G17").value={richText:[{text:"Phone: ",font:{bold:!1}},{text:"+84.906.862.780",font:{bold:!0}}]},r.getCell("G18").value={richText:[{text:"Email: ",font:{bold:!1}},{text:"contact@sparking.com.vn",font:{bold:!0}}]},r.getCell("B24").value={richText:[{text:"STT\n",font:{bold:!0,name:"Arial",size:12}},{text:"No.",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("C24").value={richText:[{text:"M\xf4 tả\n",font:{bold:!0,name:"Arial",size:12}},{text:"Description",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("D24").value={richText:[{text:"Diễn giải\n",font:{bold:!0,name:"Arial",size:12}},{text:"Note",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("E24").value={richText:[{text:"M\xe3 hiệu\n",font:{bold:!0,name:"Arial",size:12}},{text:"Code",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("F24").value={richText:[{text:"Thương hiệu/ Xuất xứ\n",font:{bold:!0,name:"Arial",size:12}},{text:"Brand/ Original",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("G24").value={richText:[{text:"ĐVT\n",font:{bold:!0,name:"Arial",size:12}},{text:"Unit",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("H24").value={richText:[{text:"Số lượng\n",font:{bold:!0,name:"Arial",size:12}},{text:"Qty.",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("I24").value={richText:[{text:"Đơn gi\xe1\n",font:{bold:!0,name:"Arial",size:12}},{text:"Unit Price\n",font:{bold:!1,name:"Arial",size:12}},{text:"(VND)",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("J24").value={richText:[{text:"Th\xe0nh tiền\n",font:{bold:!0,name:"Arial",size:12}},{text:"Amount Price",font:{bold:!1,name:"Arial",size:12}}]},r.getCell("M24").value={richText:[{text:"MUA",font:{bold:!0}}]},r.getCell("M24").border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}},r.getCell("N24").value={richText:[{text:"TỶ LỆ",font:{bold:!0}}]},r.getCell("N24").border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}},r.getCell("O24").value={richText:[{text:"TỔNG MUA",font:{bold:!0,color:{argb:"FF0000"}}}]},r.getCell("O24").fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFCC"}},r.getCell("O24").border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}},r.getCell("P24").value={richText:[{text:"B\xc1N",font:{bold:!0}}]},r.getCell("P24").border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}},(()=>{let e=25,a=1,n=[];l.forEach(l=>{n.push(e),r.getCell(`B${e}`).value={richText:[{text:`${l.title.toUpperCase()}`,font:{bold:!0,color:{argb:"FF0000"}}}]};for(let t=2;t<=16;t++)r.getCell(e,t).alignment={vertical:"middle"};r.getRow(e).height=43.875,r.getCell(`J${e}`).value={formula:`SUBTOTAL(9,J${e+1}:J${l.list.length+e})`,result:0},r.getCell(`J${e}`).font={color:{argb:"FF0000"},bold:!0},r.getCell(e,10).numFmt="#,##0",r.getCell(`M${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F2F2F2"}},r.getCell(`O${e}`).value={formula:`SUBTOTAL(9,O${e+1}:O${l.list.length+l.list.reduce((e,t)=>t?.list_detail.length>0?t.list_detail.length+e:e,0)+e})`,result:0},r.getCell(`O${e}`).font={bold:!0},r.getCell(e,15).numFmt="#,##0",r.getCell(`O${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFCC"}},r.getCell(`P${e}`).numFmt="0%",r.getCell(`P${e}`).value={formula:`(J${e}-O${e})/J${e}`,result:0},r.getCell(`P${e}`).font={color:{argb:"FF0000"},bold:!0},r.getCell(`P${e}`).fill={type:"pattern",pattern:"solid",fgColor:{argb:"CAEDFB"}},r.getCell(`J${e}`).border={right:{style:"thin"}};for(let t=1;t<=11;t++)r.getCell(e,t).fill={type:"pattern",pattern:"solid",fgColor:{argb:"CAEDFB"}};for(let t=13;t<17;t++)r.getCell(e,t).border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}};r.getCell(`B${e}`).border={left:{style:"thin"}},e++,l.type?l.list.forEach((l,a)=>{r.getRow(e).height=t(l.description,30,18),r.getCell(e,2).value=a+1,r.getCell(e,2).alignment={vertical:"middle",horizontal:"center",wrapText:!0};for(let t=2;t<11;t++)r.getCell(e,t).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};r.getCell(e,3).value=l.name,r.getCell(e,3).alignment={vertical:"middle",wrapText:!0},r.getCell(e,4).value=l.description,r.getCell(e,4).alignment={vertical:"middle",wrapText:!0},r.getCell(e,5).value=l.refresh_code,r.getCell(e,5).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,6).value=l.brand,r.getCell(e,6).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,7).value=l.unit,r.getCell(e,7).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,8).value=l.quantity,r.getCell(e,8).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,9).value={formula:`ROUNDUP(P${e},-4)`},r.getCell(e,9).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,9).numFmt="#,##0",r.getCell(e,10).numFmt="#,##0",r.getCell(e,15).numFmt="#,##0",r.getCell(e,16).numFmt="#,##0",r.getCell(e,10).value={formula:`H${e}*I${e}`},r.getCell(e,10).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,13).value={formula:`O${e}`},r.getCell(e,13).numFmt="#,##0",r.getCell(e,13).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,13).font={color:{argb:"FF0000"}},r.getCell(e,13).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F2F2F2"}},r.getCell(e,14).value=l.profit/100,r.getCell(e,14).numFmt="0%",r.getCell(e,14).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,15).value={formula:`SUBTOTAL(9,O${e+1}:O${l.list_detail.length+e})`},r.getCell(e,15).font={bold:!0},r.getCell(e,15).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,15).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFCC"}},r.getCell(e,16).value={formula:`M${e}*N${e}+M${e}`},r.getCell(e,16).alignment={vertical:"middle",horizontal:"right",wrapText:!0};for(let t=13;t<17;t++)r.getCell(e,t).border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}};e++,l.list_detail.forEach(t=>{let l=_.find(e=>e.unit_id===t.unit)?.name_unit;r.getCell(e,2).border={left:{style:"thin"},top:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}},r.getCell(e,10).border={left:{style:"dashed"},top:{style:"dashed"},bottom:{style:"dashed"},right:{style:"thin"}};for(let t=3;t<10;t++)r.getCell(e,t).border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}};r.getCell(e,4).value=t.description,r.getCell(e,4).alignment={vertical:"middle",wrapText:!0},r.getCell(e,7).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,8).value=t.quantity,r.getCell(e,8).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,13).value=t.price,r.getCell(e,13).numFmt="#,##0",r.getCell(e,13).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,13).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F2F2F2"}},isNaN(Number(l))?(r.getCell(e,7).value=l,r.getCell(e,15).value={formula:`M${e}*H${e}`}):(r.getCell(e,7).value=Number(l),r.getCell(e,15).value={formula:`M${e}/G${e}*H${e}`}),r.getCell(e,15).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,15).numFmt="#,##0",r.getCell(e,15).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFCC"}};for(let t=13;t<17;t++)r.getCell(e,t).border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}};e++})}):l.list.forEach(l=>{r.getRow(e).height=t(l.description,30,18),r.getCell(e,2).value=a++,r.getCell(e,2).alignment={vertical:"middle",horizontal:"center",wrapText:!0};for(let t=2;t<11;t++)r.getCell(e,t).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}};r.getCell(e,3).value=l.name,r.getCell(e,3).alignment={vertical:"middle",wrapText:!0},r.getCell(e,4).value=l.description,r.getCell(e,4).alignment={vertical:"middle",wrapText:!0},r.getCell(e,5).value=l.refresh_code,r.getCell(e,5).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,6).value=l.brand,r.getCell(e,6).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,7).value=l.unit,r.getCell(e,7).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,8).value=l.quantity,r.getCell(e,8).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,9).value={formula:`ROUNDUP(P${e},-4)`},r.getCell(e,9).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,9).numFmt="#,##0",r.getCell(e,10).numFmt="#,##0",r.getCell(e,15).numFmt="#,##0",r.getCell(e,16).numFmt="#,##0",r.getCell(e,10).value={formula:`H${e}*I${e}`},r.getCell(e,10).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,13).value=l.price,r.getCell(e,13).numFmt="#,##0",r.getCell(e,13).alignment={vertical:"middle",horizontal:"center",wrapText:!0},r.getCell(e,13).font={color:{argb:"FF0000"}},r.getCell(e,13).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F2F2F2"}},r.getCell(e,14).value=l.profit/100,r.getCell(e,14).numFmt="0%",r.getCell(e,14).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,15).value={formula:`M${e}*H${e}`},r.getCell(e,15).alignment={vertical:"middle",horizontal:"right",wrapText:!0},r.getCell(e,15).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFCC"}},r.getCell(e,16).value={formula:`M${e}*N${e}+M${e}`},r.getCell(e,16).alignment={vertical:"middle",horizontal:"right",wrapText:!0};for(let t=13;t<17;t++)r.getCell(e,t).border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}};e++})});for(let t=3;t<=10;t++)r.getCell(e,t).fill={type:"pattern",pattern:"solid",fgColor:{argb:"61CBF3"}},t>3&&t<10&&(r.getCell(e+4,t).fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9D9D9"}});for(let t=13;t<=16;t++)(15===t||16===t)&&(r.getCell(e,t).fill={type:"pattern",pattern:"solid",fgColor:{argb:"61CBF3"}}),r.getCell(e,t).border={top:{style:"dashed"},left:{style:"dashed"},bottom:{style:"dashed"},right:{style:"dashed"}};r.getCell(e,8).value={richText:[{text:"Amount before VAT",font:{bold:!0}}]},r.getRow(e).height=60.625,r.getCell(e,10).value={formula:`SUBTOTAL(9,J25:J${e-1})`},r.getCell(e,10).numFmt="#,##0",r.getCell(e,10).font={bold:!0},r.getCell(e,15).value={formula:`SUBTOTAL(9,O25:O${e-1})`},r.getCell(e,15).numFmt="#,##0",r.getCell(e,15).font={bold:!0},r.getRow(e).eachCell(e=>{e.alignment||(e.alignment={}),e.alignment.vertical="middle"}),r.getCell(e+1,15).value={formula:`J${e}-O${e}`},r.getCell(e+1,15).numFmt="#,##0",r.getCell(e+2,15).value={formula:`O${e+1}/J${e}`},r.getCell(e+2,15).numFmt="0%",r.getCell(e+4,4).value={richText:[{text:"SUMARY",font:{color:{argb:"FF0000"}}}]},n.forEach((t,a)=>{r.getCell(e+4+1+a,4).value={richText:[{text:l[a].title,font:{bold:!0}}]},r.getCell(e+4+1+a,9).value={formula:`J${t}`},r.getCell(e+4+1+a,9).numFmt="#,##0"});let i=e+8+n.length;o.forEach(e=>{r.getCell(i,2).value={richText:[{text:e.title+":",font:{bold:!0}}]},i++,e.list.forEach(e=>{r.getCell(i,3).value={richText:[{text:e,font:{bold:!1}}]},i++})})})();for(let e=13;e<=19;e++)for(let t=1;t<=11;t++)r.getCell(e,t).fill={type:"pattern",pattern:"solid",fgColor:{argb:"F2F2F2"}};let c=[2.4,5.2,21.1,47.1,18.9,15.9,10.6,9.9,14.5,15.9,2.7,2.6,13.4,7.3,16.8,15.9];for(let e=1;e<=16;e++)if(r.getColumn(e).width=100*c[e-1]/98,e>12&&(r.getCell(24,e).alignment={vertical:"middle",horizontal:"center",wrapText:!0}),e<12){let t=r.getCell(24,e);e>1&&e<11&&(t.alignment={vertical:"middle",horizontal:"center",wrapText:!0},t.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}),t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"D9D9D9"}}}r.eachRow({includeEmpty:!0},e=>{e.eachCell(e=>{e.font||(e.font={}),e.font.name="Arial",e.font.size=12})});try{let t=await a.xlsx.writeBuffer(),l=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,j.saveAs)(l,e.price_quote_id+".xlsx")}catch(e){console.log(e)}},[N,P]=(0,o.useState)([]),S=e=>{P(n?.filter(t=>String(t.created_at+" "+t.date_expired+" "+t.date_start+" "+t.project.name+" "+t.price_quote_id+" "+t.user_support.last_name+" "+t.status).toLowerCase().includes(e.toLowerCase())))},$=async e=>{let t=await F.Z.getExportPriceQuote(e);200===t.statusCode&&await w(t.data)},{postdata:z}=(0,x.Z)(),[O,A]=(0,o.useState)(!1),[D,k]=(0,o.useState)([]),B=async()=>{200===await z(()=>F.Z.deletePriceQuotes(D))&&(k([]),A(!1))};return(0,y.useSearchParams)(),(0,a.jsxs)(a.Fragment,{children:[a.jsx(s.ZP,{hidden:!0,onClick:()=>{f(!0)},ref:t}),a.jsx(u.Z,{open:h,footer:null,width:"100%",style:{maxWidth:"800px"},onCancel:()=>{f(!1)},title:`Danh s\xe1ch c\xf3 ${b} b\xe1o gi\xe1`,children:(0,a.jsxs)("div",{className:"",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(c.Z,{defaultValue:l,style:{width:83},onChange:e=>r(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),a.jsx(s.ZP,{hidden:!(D.length>0),children:"Xuất ra"}),a.jsx(s.ZP,{onClick:()=>{A(!0)},danger:!0,hidden:!(D.length>0),className:"text-xl",icon:a.jsx(C.FH3,{})}),a.jsx(u.Z,{open:O,title:"X\xf3a dữ liệu",onOk:B,onCancel:()=>{A(!1)},children:"Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng ?"})]}),a.jsx("div",{className:"flex items-center",children:a.jsx(g.Z,{onChange:e=>{S(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})})]}),a.jsx("div",{className:"w-full overflow-auto",children:a.jsx("div",{className:"min-w-fit",children:a.jsx(p.Z,{columns:[{title:"B\xe1o gi\xe1#",className:"text-xs",dataIndex:"price_quote_id",render:(e,t,l)=>(0,a.jsxs)("div",{className:"flex flex-col gap-1 ",children:[(0,a.jsxs)("strong",{children:["#",l+1,"."]}),a.jsx("div",{className:"flex gap-2",children:a.jsx(s.ZP,{type:"text",ghost:!0,className:"text-xs text-blue-600",onClick:()=>{$(e)},children:"Xuất"})})]}),sorter:(e,t)=>e.price_quote_id.localeCompare(t.price_quote_id)},{title:"Ng\xe0y b\xe1o gi\xe1",className:"text-xs",dataIndex:"date_start",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>e.date_start.toString().localeCompare(t.date_start.toString())},{title:"Ng\xe0y hết hạn",className:"text-xs",dataIndex:"date_expired",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>e.date_expired.toString().localeCompare(t.date_expired.toString())},{title:"M\xe3 tham chiếu",className:"text-xs",dataIndex:"reference_code",sorter:(e,t)=>e.reference_code.localeCompare(t.reference_code)},{title:"T\xecnh trạng",className:"text-xs",dataIndex:"status",render:e=>a.jsx(a.Fragment,{children:(0,a.jsxs)(d.Z,{color:"draff"===e?"gray":"send"===e?"lightblue":"open"===e?"blue":"edit"===e?"yellow":"refuse"===e?"red":"accept"===e?"green":"",children:[e.charAt(0).toUpperCase()+e.slice(1)," "]})}),sorter:(e,t)=>e.status.localeCompare(t.status)}],rowSelection:{onChange:(e,t)=>{k(t.map(e=>e.price_quote_id??""))}},dataSource:N,scroll:{x:"max-content"},pagination:{pageSize:l,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`},showSorterTooltip:{target:"sorter-icon"}})})})]})})]})}function P(){let e=(0,b.Z)(["admin-top","opportunity","opportunity-edit"]),[t,l]=(0,o.useState)(),r=(0,o.useRef)(),n=(0,o.useRef)(),{datas:i}=(0,m.v9)(e=>e.get_opportunities_by_price_quote),[j,w]=(0,o.useState)(25),[T,F]=(0,o.useState)(),P=[{title:"#",className:"",dataIndex:"opportunity_id",render:(t,o,i)=>(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("strong",{children:["#",i+1]}),a.jsx("div",{className:"flex gap-2",children:e&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(s.ZP,{type:"text",ghost:!0,className:"text-xs text-blue-600",onClick:()=>{l(t),n.current&&n?.current.click()},children:"Danh s\xe1ch b\xe1o gi\xe1"}),a.jsx(h.Z,{ID:t}),a.jsx(s.ZP,{type:"text",ghost:!0,className:"text-xs text-green-600",onClick:()=>{l(t),r.current&&r?.current.click()},children:"Th\xeam b\xe1o gi\xe1"})]})})]}),sorter:(e,t)=>e.opportunity_id.localeCompare(t.opportunity_id)},{title:"T\xean li\xean hệ",className:"",dataIndex:"name_contact",render:e=>e&&e.length>15?`${e.slice(0,15)}...`:e,sorter:(e,t)=>(e.name_contact||"").localeCompare(t.name_contact||"")},{title:"C\xf4ng ty",className:"",dataIndex:"company_name",sorter:(e,t)=>(e.company_name||"").localeCompare(t.company_name||""),render:e=>a.jsx(a.Fragment,{children:e})},{title:"Email",className:"",dataIndex:"email",sorter:(e,t)=>(e.company_name||"").localeCompare(t.company_name||""),render:e=>a.jsx(a.Fragment,{children:e})},{title:"Số điện thoại",className:"",dataIndex:"phone_number",sorter:(e,t)=>(e.company_name||"").localeCompare(t.company_name||""),render:e=>a.jsx(a.Fragment,{children:e})},{title:"Nh\xe2n vi\xean hỗ trợ",className:"",dataIndex:["user_support"],sorter:(e,t)=>(e.user_support?.last_name||"").localeCompare(t.user_support?.last_name||""),render:e=>(0,a.jsxs)(a.Fragment,{children:[e?.first_name," ",e?.last_name]})},{title:"T\xecnh trạng",className:"",dataIndex:["status"],sorter:(e,t)=>(e.status||"").localeCompare(t.status||""),render:e=>a.jsx(a.Fragment,{children:a.jsx(d.Z,{color:"cancel"===e?"gray":"send"===e?"blue":"pending"===e?"blue-inverse":"delete"===e?"red":"success"===e?"green":"pause"===e?"yellow":"",children:"cancel"===e?"Đ\xe3 hủy":"hide"===e?"Đang ẩn":"pending"===e?"Đang chờ":"delete"===e?"Đ\xe3 x\xf3a":"success"===e?"Th\xe0nh c\xf4ng":"send"===e?"Đ\xe3 gửi b\xe1o gi\xe1":"pause"===e?"Tạm dừng":""})})},{title:"Nguồn cơ hội",className:"",dataIndex:["type_source","name"],sorter:(e,t)=>(e.company_name||"").localeCompare(t.company_name||""),render:e=>a.jsx(a.Fragment,{children:e})},{title:"Lượt b\xe1o gi\xe1",className:"",dataIndex:"price_quotes"},{title:"Ng\xe0y tạo",className:"",dataIndex:"created_at",render:e=>new Date(e).toLocaleDateString("vi-VN"),sorter:(e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()}],S=e=>{F(i?.filter(t=>String(t.opportunity_id+" "+t.name_contact+" "+t.company_name+" "+t.price).toLowerCase().includes(e.toLowerCase())))},{postdata:$}=(0,x.Z)(),z=(0,m.I0)(),[O,A]=(0,o.useState)(!1),[D,k]=(0,o.useState)([]),B=async()=>{200===await $(()=>f.Z.deleteOpportunities(D))&&(z((0,_.s)()),k([]),A(!1))};return(0,y.useSearchParams)(),(0,a.jsxs)("div",{className:"",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(c.Z,{defaultValue:j,style:{width:83},onChange:e=>w(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"All"}]}),a.jsx(s.ZP,{hidden:!(D.length>0),children:"Xuất ra"}),a.jsx(s.ZP,{onClick:()=>{A(!0)},danger:!0,hidden:!(D.length>0),className:"text-xl",icon:a.jsx(C.FH3,{})}),a.jsx(u.Z,{open:O,title:"X\xf3a dữ liệu",onOk:B,onCancel:()=>{A(!1)},children:"Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng ?"})]}),a.jsx("div",{className:"flex items-center",children:a.jsx(g.Z,{onChange:e=>S(e.target.value),placeholder:"Search",style:{width:200}})})]}),a.jsx("div",{className:"w-full overflow-auto",children:a.jsx("div",{className:"min-w-fit",children:a.jsx(p.Z,{columns:P,rowSelection:{onChange:(e,t)=>{k(t.map(e=>e.opportunity_id))}},dataSource:T,scroll:{x:"max-content"},pagination:{pageSize:j,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`},showSorterTooltip:{target:"sorter-icon"}})})}),a.jsx(v.Z,{idOpportunity:t,refBtn:r}),a.jsx(N,{idOpportunity:t,refBtn:n})]})}var S=l(35090),$=l(99801),z=l.n($);function O(){let{RangePicker:e}=S.default,t=(0,b.Z)(["admin-top","opportunity","opportunity-edit"]),[l,r]=(0,o.useState)(new Date().getFullYear()),[n,i]=(0,o.useState)(new Date().getFullYear()),[j,w]=(0,o.useState)(""),T=(0,o.useRef)(),{datas:F}=(0,m.v9)(e=>e.get_opportunities_have_contract),[N,P]=(0,o.useState)(25),[$,O]=(0,o.useState)(),A=[{title:"#",className:"",dataIndex:"opportunity_id",render:(e,l,r)=>(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("strong",{children:["#",r+1]}),a.jsx("div",{className:"flex gap-2",children:t&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(s.ZP,{type:"text",ghost:!0,className:"text-xs text-blue-600",onClick:()=>{w(e),T.current&&T?.current.click()},children:"B\xe1o gi\xe1"}),a.jsx(h.Z,{ID:e})]})})]}),sorter:(e,t)=>e.opportunity_id.localeCompare(t.opportunity_id)},{title:"T\xean li\xean hệ",className:"",dataIndex:"name_contact",render:e=>e&&e.length>15?`${e.slice(0,15)}...`:e,sorter:(e,t)=>(e.name_contact||"").localeCompare(t.name_contact||"")},{title:"C\xf4ng ty",className:"",dataIndex:"company_name",sorter:(e,t)=>(e.company_name||"").localeCompare(t.company_name||""),render:e=>a.jsx(a.Fragment,{children:e})},{title:"Email",className:"",dataIndex:"email",sorter:(e,t)=>(e.company_name||"").localeCompare(t.company_name||""),render:e=>a.jsx(a.Fragment,{children:e})},{title:"Số điện thoại",className:"",dataIndex:"phone_number",sorter:(e,t)=>(e.company_name||"").localeCompare(t.company_name||""),render:e=>a.jsx(a.Fragment,{children:e})},{title:"Nh\xe2n vi\xean hỗ trợ",className:"",dataIndex:["user_support"],sorter:(e,t)=>(e.user_support?.last_name||"").localeCompare(t.user_support?.last_name||""),render:e=>(0,a.jsxs)(a.Fragment,{children:[e?.first_name," ",e?.last_name]})},{title:"T\xecnh trạng",className:"",dataIndex:["status"],sorter:(e,t)=>(e.status||"").localeCompare(t.status||""),render:e=>a.jsx(a.Fragment,{children:a.jsx(d.Z,{color:"cancel"===e?"gray":"send"===e?"blue":"pending"===e?"blue-inverse":"delete"===e?"red":"success"===e?"green":"pause"===e?"yellow":"",children:"cancel"===e?"Đ\xe3 hủy":"hide"===e?"Đang ẩn":"pending"===e?"Đang chờ":"delete"===e?"Đ\xe3 x\xf3a":"success"===e?"Th\xe0nh c\xf4ng":"send"===e?"Đ\xe3 gửi b\xe1o gi\xe1":"pause"===e?"Tạm dừng":""})})},{title:"Nguồn cơ hội",className:"",dataIndex:["type_source","name"],sorter:(e,t)=>(e.company_name||"").localeCompare(t.company_name||""),render:e=>a.jsx(a.Fragment,{children:e})},{title:"Hợp đồng",className:"",dataIndex:"contracts"},{title:"Ng\xe0y tạo",className:"",dataIndex:"created_at",render:e=>new Date(e).toLocaleDateString("vi-VN"),sorter:(e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime()}],D=e=>{O(F?.filter(t=>String(t.opportunity_id+" "+t.name_contact+" "+t.company_name+" "+t.price).toLowerCase().includes(e.toLowerCase())))},{postdata:k}=(0,x.Z)(),B=(0,m.I0)(),[Z,q]=(0,o.useState)(!1),[I,E]=(0,o.useState)([]),M=async()=>{200===await k(()=>f.Z.deleteOpportunities(I))&&(B((0,_.s)()),E([]),q(!1))};return(0,y.useSearchParams)(),(0,a.jsxs)("div",{className:"",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx(c.Z,{defaultValue:N,style:{width:83},onChange:e=>P(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"All"}]}),a.jsx(s.ZP,{hidden:!(I.length>0),children:"Xuất ra"}),a.jsx(s.ZP,{onClick:()=>{q(!0)},danger:!0,hidden:!(I.length>0),className:"text-xl",icon:a.jsx(C.FH3,{})}),a.jsx(u.Z,{open:Z,title:"X\xf3a dữ liệu",onOk:M,onCancel:()=>{q(!1)},children:"Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng ?"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"flex flex-wrap gap-2",children:a.jsx(e,{picker:"year",value:[z()(new Date(l,0,1).getTime()),z()(new Date(n,0,1).getTime())],onChange:(e,t)=>{r(Number(t[0])),i(Number(t[1]))}})}),a.jsx(g.Z,{onChange:e=>D(e.target.value),placeholder:"Search",style:{width:200}})]})]}),a.jsx("div",{className:"w-full overflow-auto",children:a.jsx("div",{className:"min-w-fit",children:a.jsx(p.Z,{columns:A,rowSelection:{onChange:(e,t)=>{E(t.map(e=>e.opportunity_id))}},dataSource:$,scroll:{x:"max-content"},pagination:{pageSize:N,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`},showSorterTooltip:{target:"sorter-icon"}})})}),a.jsx(v.Z,{idOpportunity:j,refBtn:T})]})}function A(){let e=[{key:"1",label:"C\xf3 B\xe1o Gi\xe1",children:a.jsx(P,{})},{key:"2",label:"C\xf3 Hợp Đồng",children:a.jsx(O,{})}];return(0,a.jsxs)("div",{className:"p-8 border-b-[1px]",children:[a.jsx("p",{className:"mb-2 text-xl font-semibold",children:"Danh s\xe1ch cơ hội"}),a.jsx(i.Z,{defaultActiveKey:"1",items:e})]})}l(84583);let D=(0,n.default)(()=>Promise.all([l.e(4523),l.e(8984),l.e(9081),l.e(3021)]).then(l.bind(l,63021)),{loadableGenerated:{modules:["components\\Opportunity\\Dashboard\\DashboardOpportunities.tsx -> @/components/Opportunity/Dashboard/ChartColumn"]}}),k=(0,n.default)(()=>Promise.all([l.e(1407),l.e(8319)]).then(l.bind(l,18319)),{loadableGenerated:{modules:["components\\Opportunity\\Dashboard\\DashboardOpportunities.tsx -> @/components/Opportunity/Dashboard/ChartPie"]}}),B=(0,n.default)(()=>Promise.all([l.e(8984),l.e(9081),l.e(7778)]).then(l.bind(l,77778)),{loadableGenerated:{modules:["components\\Opportunity\\Dashboard\\DashboardOpportunities.tsx -> @/components/Opportunity/Dashboard/ChartLine"]}});function Z(){return(0,a.jsxs)("div",{className:"flex flex-col gap-4 max-w-full",children:[a.jsx("div",{className:"border-b-[1px]",children:a.jsx(k,{})}),a.jsx(D,{}),a.jsx(B,{}),a.jsx(A,{})]})}function q(){(0,m.I0)();let e=(0,b.Z)(["admin-top","opportunity","opportunity-read"]);return a.jsx("div",{children:e?a.jsx(Z,{}):a.jsx(r.Z,{})})}l(11318)},81597:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>a});let a=(0,l(45347).createProxy)(String.raw`E:\riot\sparking\sp_1\src\app\opportunity\dashboard\error.tsx#default`)},83435:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>a});let a=(0,l(45347).createProxy)(String.raw`E:\riot\sparking\sp_1\src\app\opportunity\dashboard\page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var l=e=>t(t.s=e),a=t.X(0,[9379,4671,4564,2703,2602,5090,5791,5794,2754,7132,7504,8188,1290,7233,5983,7556],()=>l(95622));module.exports=a})();