(()=>{var e={};e.id=8158,e.ids=[8158],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},9714:e=>{"use strict";e.exports=require("constants")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},52769:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),a(25253),a(8764),a(20230),a(49356),a(90996);var r=a(30170),n=a(45002),i=a(83876),l=a.n(i),o=a(66299),s={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>o[e]);a.d(t,s);let d=["",{children:["system",{children:["report",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,25253)),"E:\\riot\\sparking\\sp_1\\src\\app\\system\\report\\page.tsx"]}]},{error:[()=>Promise.resolve().then(a.bind(a,8764)),"E:\\riot\\sparking\\sp_1\\src\\app\\system\\report\\error.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,28204))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,20230)),"E:\\riot\\sparking\\sp_1\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(a.bind(a,49356)),"E:\\riot\\sparking\\sp_1\\src\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,90996,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,28204))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["E:\\riot\\sparking\\sp_1\\src\\app\\system\\report\\page.tsx"],p="/system/report/page",m={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/system/report/page",pathname:"/system/report",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},17089:(e,t,a)=>{Promise.resolve().then(a.bind(a,49570))},18738:(e,t,a)=>{Promise.resolve().then(a.bind(a,81623))},49570:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(97247),n=a(87467);function i({error:e,reset:t}){return r.jsx("div",{children:r.jsx(n.Z,{handleBtn:t,value:e.message})})}},81623:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>O});var r=a(97247),n=a(49509),i=a(82140),l=a(28964),o=a(38960),s=a(77951),d=a(27035),c=a.n(d),p=a(23102),m=a(8353),u=a(80046),h=a(2987),x=a(84169),y=a(95856),g=a(36971),v=a(68967),f=a(10957);function w(){let[e,t]=(0,l.useState)(),[a,n]=(0,l.useState)([]),[i,o]=(0,l.useState)([]),[d,c]=(0,l.useState)(!1),m=(0,p.I0)(),{datas:w}=(0,p.v9)(e=>e.get_type_activities),{datas:_}=(0,p.v9)(e=>e.vat_system),{datas:N}=(0,p.v9)(e=>e.get_payment_total),{datas:k}=(0,p.v9)(e=>e.get_type_activities),{datas:C}=(0,p.v9)(e=>e.get_contracts),{datas:b}=(0,p.v9)(e=>e.get_classify_type),j=async a=>{m((0,u.cW)()),m((0,h.V)()),m((0,x.Wq)({year:a})),m((0,y.T)()),m((0,f.$)({}));let r=await g.Z.getNameClassifies(),i=await v.Z.getTypeFullContracts();r&&i&&(n(200===r.statusCode?r.data.types_product:[]),o(200===i.statusCode?i.data:[])),e?c(!0):t(a)};return r.jsx("div",{className:"w-full",children:r.jsx(s.ZP,{type:"primary",className:"ml-4 bg-[#23A69D]",onClick:()=>{j(2024)},children:"Xuất b\xe1o c\xe1o tổng k\xeat"})})}var _=a(35090),N=a(39884),k=a(41832),C=a(74231),b=a(60655),j=a(77709),T=a(96538),S=a(99801),B=a.n(S),D=a(34523),H=a.n(D);a(86488);var I=a(53803);async function P(e,t,a,r){try{let n=new(c()).Workbook,i=n.addWorksheet("BaoCaoDoanhThu");i.addRow([]),i.mergeCells("B2:H2"),i.getCell("B2").value=`B\xc1O C\xc1O DOANH THU THEO ${"month"===e?"TH\xc1NG":"quarter"===e?"QU\xdd":"NĂM"}`,i.getCell("B2").font={size:24,bold:!0},i.getCell("B2").alignment={vertical:"middle",horizontal:"center"},i.addRow([]),i.mergeCells("B3:H3"),i.getCell("B3").value=`TỪ ${a} - ${r}`,i.getCell("B3").font={size:18,bold:!0},i.getCell("B3").alignment={vertical:"middle",horizontal:"center"},i.columns=[{key:"empty1",width:5},{key:"date",width:2e3/90},{key:"created_at",width:30},{key:"contract",width:30},{key:"type",width:30},{key:"name_contract",width:30},{key:"code_contract",width:40},{key:"type_product",width:30},{key:"revenue",width:30},{key:"description",width:30},{key:"revenue_vat",width:30}],i.addRow(4).values=["",("quarter"===e?"Qu\xfd/Năm":"month"===e?"Th\xe1ng/Năm":"Năm").toUpperCase(),"THỜI GIAN","M\xc3 HỢP ĐỒNG","LOẠI C\xd4NG TR\xccNH","T\xcaN C\xd4NG TR\xccNH","SỐ CHỨNG TỪ","SẢN PHẨM DỊCH VỤ","DOANH THU(trước thuế)","M\xd4 TẢ","DOANH THU(sau thuế)"],i.getRow(4).font={bold:!0,size:12,color:{argb:"ffffff"}},i.getRow(4).alignment={vertical:"middle",horizontal:"center"};let l=i.getRow(4);for(let e=2;e<=11;e++)l.getCell(e).border={bottom:{style:"thin"},top:{style:"thin"},right:{style:"thin"},left:{style:"thin"}},l.getCell(e).fill={type:"pattern",pattern:"solid",fgColor:{argb:"1BA49D"}};let o=t.reduce((a,r,n)=>{a?.[r?.date]?r?.date!==t?.[n+1]?.date&&(a[r.date].end=n+5):a[r.date]={start:n+5,end:n+5},i.addRow({empty1:"",empty2:"",...r,date:t?.[n-1]?.date!==r?.date?"year"===e?Number(r?.date):r?.date:""});let l=i.getRow(n+5);for(let e=2;e<=11;e++)l.getCell(e).border={bottom:{style:"thin"},top:{style:"thin"},right:{style:"thin"},left:{style:"thin"}},l.getCell(e).font={size:12};return a},{});Object.keys(o).forEach(e=>{i.mergeCells(`B${o[e].start}:B${o[e].end}`),i.getCell(`B${o[e].start}`).alignment={vertical:"middle",horizontal:"center"}});let s=await n.xlsx.writeBuffer(),d=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,m.saveAs)(d,`B\xe1o c\xe1o doanh thu.xlsx`)}catch(e){console.log(e)}}var $=a(16523);function Z(){let[e,t]=(0,l.useState)(new Date("2024-12-01").getTime()),[a,n]=(0,l.useState)(new Date("2024-12-31").getTime()),[i,o]=(0,l.useState)(25),[d,c]=(0,l.useState)("year"),{RangePicker:m}=_.default;(0,p.I0)();let{datas:u}=(0,p.v9)(e=>e.get_payments),{datas:h}=(0,p.v9)(e=>e.vat_system),[x,y]=(0,l.useState)(),g=[{label:"Excel",key:"excel",icon:r.jsx(I.ugd,{})}],v=()=>{P(d,x?.map(e=>{let t=(h.find(t=>t.vat_id===e.vat)?.type_vat??0)/100*(e.price??0)+(e.price??0);return{date:e.date,created_at:e.created_at,contract:e.contract?.name_contract,type:e.contract?.project?.type?.name_type,name_contract:e.contract?.project?.name,code_contract:e.contract?.code_contract,type_product:e.type_product.name,revenue:(e.price??0).toLocaleString("vi-VN")+" ₫",description:e.description,revenue_vat:t.toLocaleString("vi-VN")+" ₫"}}),new Date(e??"").toLocaleDateString("vi-VN"),new Date(a??"").toLocaleDateString("vi-VN"))},f=[{title:"month"===d?"Th\xe1ng/Năm":"quarter"===d?"Qu\xfd/Năm":"Năm",dataIndex:["date"],key:"date",render:(e,t,a)=>{if(x?.[a-1]?.date!==e)return e}},{title:"Thời gian",dataIndex:["created_at"],key:"created_at",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A"},{title:"M\xe3 thanh to\xe1n",dataIndex:"payment_id",key:"payment_id"},{title:"M\xe3 hợp đồng",dataIndex:["contract","name_contract"],key:"name_contract"},{title:"Loại c\xf4ng tr\xecnh",dataIndex:["contract","project","type","name_type"],key:"name_type"},{title:"T\xean c\xf4ng tr\xecnh",dataIndex:["contract","project","name"],key:"name"},{title:"Số chứng từ",dataIndex:["contract","code_contract"],key:"code_contract"},{title:"Sản phẩm dịch vụ",dataIndex:["type_product","name"],key:"code_contract"},{title:"Doanh thu(trước thuế)",dataIndex:"price",key:"price",render:e=>e.toLocaleString("vi-VN")+" ₫"},{title:"M\xf4 tả",dataIndex:"description",key:"description"},{title:"Doanh thu(sau thuế)",dataIndex:"price",key:"price-vat",render:(e,t)=>((h.find(e=>e.vat_id===t.vat)?.type_vat??0)/100*e+e).toLocaleString("vi-VN")+" ₫"}],w=e=>{y(u?.filter(t=>String(t.payment_id+" "+t.created_at+" "+t.description+" "+t?.contract?.name_contract+" "+t?.date).toLowerCase().includes(e.toLowerCase())))};return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[r.jsx(N.Z,{defaultValue:i,style:{width:83},onChange:e=>o(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),r.jsx(k.Z,{menu:{items:g,onClick:e=>{"excel"===e.key&&v()}},children:(0,r.jsxs)(s.ZP,{children:[r.jsx(C.Z,{children:"Xuất ra"}),r.jsx($.Ix0,{})]})})]}),(0,r.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[r.jsx("div",{children:(0,r.jsxs)(b.ZP.Group,{value:d,buttonStyle:"solid",onChange:e=>{c(e.target.value)},children:[r.jsx(b.ZP.Button,{value:"month",children:"Th\xe1ng"}),r.jsx(b.ZP.Button,{value:"quarter",children:"Qu\xfd"}),r.jsx(b.ZP.Button,{value:"year",children:"Năm"})]})}),r.jsx(m,{className:"sm:w-auto w-full",picker:d,value:[e?B()(e):void 0,a?B()(a):void 0],onChange:(e,a)=>{if(""===a[0]||""===a[1])n(void 0),t(void 0);else if("year"===d&&(t(new Date(a[0]).getTime()),n(new Date(`${a[1]}-12-31`).getTime())),"month"===d&&(t(new Date(`${a[0]}-01`).getTime()),n(new Date(`${H()(new Date(`${e?.[1]?.year()}-${(e?.[1]?.month()??0)+2}-01`)).clone().subtract(1,"days")}`).getTime())),"quarter"===d&&""!==a[0]){let e=a[0].replace("Q","").split("-"),r=a[1].replace("Q","").split("-"),i=new Date(Number(e[0]),(Number(e[1])-1)*3,1),l=new Date(Number(r[0]),(Number(r[1])-1)*3+3,0,23,59,59,59);t(i.getTime()),n(l.getTime())}}}),r.jsx(T.Z,{onChange:e=>{w(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})]})]}),r.jsx("div",{className:"w-full overflow-auto",children:r.jsx("div",{className:"min-w-fit",children:r.jsx(j.Z,{columns:f,dataSource:x,scroll:{x:"max-content"},pagination:{pageSize:i,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`},showSorterTooltip:{target:"sorter-icon"}})})})]})}async function R(e,t,a,r){try{let n=new(c()).Workbook,i=n.addWorksheet("BaoCaoCongViec");i.addRow([]),i.mergeCells("B2:H2"),i.getCell("B2").value=`B\xc1O C\xc1O C\xd4NG VIỆC THỰC HIỆN THEO ${"month"===e?"TH\xc1NG":"week"===e?"TUẦN":"NĂM"}`,i.getCell("B2").font={size:24,bold:!0},i.getCell("B2").alignment={vertical:"middle",horizontal:"center"},i.addRow([]),i.mergeCells("B3:H3"),i.getCell("B3").value=`TỪ ${a} - ${r}`,i.getCell("B3").font={size:18,bold:!0},i.getCell("B3").alignment={vertical:"middle",horizontal:"center"},i.columns=[{key:"empty1",width:5},{key:"date",width:2e3/90},{key:"name",width:30},{key:"activity",width:30},{key:"contract",width:30},{key:"status",width:30},{key:"time_start",width:30},{key:"time_end",width:30},{key:"list_user",width:50}],i.addRow(4).values=["",("week"===e?"Tuần/Năm":"month"===e?"Th\xe1ng/Năm":"Năm").toUpperCase(),"T\xcaN C\xd4NG VIỆC","HOẠT ĐỘNG","HỢP ĐỒNG","T\xccNH TRẠNG","NG\xc0Y BẮT ĐẦU","NG\xc0Y KẾT TH\xdaC","NGƯỜI PHỤ TR\xc1CH"],i.getRow(4).font={bold:!0,size:12,color:{argb:"ffffff"}},i.getRow(4).alignment={vertical:"middle",horizontal:"center"};let l=i.getRow(4);for(let e=2;e<=9;e++)l.getCell(e).border={bottom:{style:"thin"},top:{style:"thin"},right:{style:"thin"},left:{style:"thin"}},l.getCell(e).fill={type:"pattern",pattern:"solid",fgColor:{argb:"1BA49D"}};let o=t.reduce((a,r,n)=>{a?.[r?.date]?r?.date!==t?.[n+1]?.date&&(a[r.date].end=n+5):a[r.date]={start:n+5,end:n+5},i.addRow({empty1:"",empty2:"",...r,date:t?.[n-1]?.date!==r?.date?"year"===e?Number(r?.date):r?.date:""});let l=i.getRow(n+5);for(let e=2;e<=9;e++)l.getCell(e).border={bottom:{style:"thin"},top:{style:"thin"},right:{style:"thin"},left:{style:"thin"}},l.getCell(e).font={size:12};return a},{});Object.keys(o).forEach(e=>{i.mergeCells(`B${o[e].start}:B${o[e].end}`),i.getCell(`B${o[e].start}`).alignment={vertical:"middle",horizontal:"center"}});let s=await n.xlsx.writeBuffer(),d=new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,m.saveAs)(d,`B\xe1o c\xe1o c\xf4ng việc.xlsx`)}catch(e){console.log(e)}}function z(){let[e,t]=(0,l.useState)(new Date("2024-12-01").getTime()),[a,n]=(0,l.useState)(new Date("2024-12-31").getTime()),[i,o]=(0,l.useState)(25),[d,c]=(0,l.useState)("year"),{RangePicker:m}=_.default;(0,p.I0)();let{datas:u}=(0,p.v9)(e=>e.get_works_filter),[h,x]=(0,l.useState)(),y=[{label:"Excel",key:"excel",icon:r.jsx(I.ugd,{})}],g=[{title:"month"===d?"Th\xe1ng/Năm":"week"===d?"Tuần/Năm":"Năm",dataIndex:["date"],key:"date",render:(e,t,a)=>{if(h?.[a-1]?.date!==e)return e}},{title:"T\xean c\xf4ng việc",dataIndex:"name",className:"text-xs",render:e=>e||"N/A",sorter:(e,t)=>(e.name||"").localeCompare(t.name||"")},{title:"Hoạt động",dataIndex:["activity","name"],className:"text-xs",render:e=>e?`${e}`:"N/A",sorter:(e,t)=>(e.activity?.name||"").localeCompare(t.activity?.name||"")},{title:"Hợp đồng",dataIndex:["activity","contract","name_contract"],className:"text-xs",render:e=>e?`${e}`:"N/A",sorter:(e,t)=>(e.activity?.contract?.name_contract||"").localeCompare(t.activity?.contract?.name_contract||"")},{title:"T\xecnh trạng",dataIndex:["status","name"],className:"text-xs",render:e=>e||"N/A",sorter:(e,t)=>(e.status?.name||"").localeCompare(t.status?.name||"")},{title:"Ng\xe0y bắt đầu",dataIndex:"time_start",className:"text-xs",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>new Date(e.time_start||0).getTime()-new Date(t.time_start||0).getTime()},{title:"Ng\xe0y kết th\xfac",dataIndex:"time_end",className:"text-xs",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>new Date(e.time_end||0).getTime()-new Date(t.time_end||0).getTime()}],v=e=>{x(u?.filter(t=>String(t.work_id+" "+t.created_at+" "+t.description+" "+t?.activity?.contract?.name_contract+" "+t?.date).toLowerCase().includes(e.toLowerCase())))},f=()=>{R(d,h?.map(e=>({date:e.date,name:e.name,activity:e.activity?.name,contract:e.activity?.contract?.name_contract,status:e?.status?.name,time_start:new Date(e.time_start).toLocaleDateString("vi-VN"),time_end:new Date(e.time_end).toLocaleDateString("vi-VN"),list_user:e.list_user?.reduce((e,t,a)=>0===a?t.first_name+" "+t.last_name:e+" , "+t.first_name+" "+t.last_name,"")})),new Date(e??"").toLocaleDateString("vi-VN"),new Date(a??"").toLocaleDateString("vi-VN"))};return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[r.jsx(N.Z,{defaultValue:i,style:{width:83},onChange:e=>o(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),r.jsx(k.Z,{menu:{items:y,onClick:e=>{"excel"===e.key&&f()}},children:(0,r.jsxs)(s.ZP,{children:[r.jsx(C.Z,{children:"Xuất ra"}),r.jsx($.Ix0,{})]})})]}),(0,r.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[r.jsx("div",{children:(0,r.jsxs)(b.ZP.Group,{value:d,buttonStyle:"solid",onChange:e=>{c(e.target.value)},children:[r.jsx(b.ZP.Button,{value:"week",children:"Tuần"}),r.jsx(b.ZP.Button,{value:"month",children:"Th\xe1ng"}),r.jsx(b.ZP.Button,{value:"year",children:"Năm"})]})}),r.jsx(m,{className:"sm:w-auto w-full",picker:d,value:[e?B()(e):void 0,a?B()(a):void 0],onChange:(e,a)=>{if(""===a[0]||""===a[1])n(void 0),t(void 0);else if("year"===d&&(t(new Date(a[0]).getTime()),n(new Date(`${a[1]}-12-31`).getTime())),"month"===d&&(t(new Date(`${a[0]}-01`).getTime()),n(new Date(`${H()(new Date(`${e?.[1]?.year()}-${(e?.[1]?.month()??0)+2}-01`)).clone().subtract(1,"days")}`).getTime())),"week"===d){let r=H()().year(e?.[0]?.year()??0).isoWeek(Number(a[0].replace(`${e?.[0]?.year()}-`,"").replace(/\D/g,""))).startOf("isoWeek").clone().format("YYYY-MM-DD"),i=H()().year(e?.[1]?.year()??0).isoWeek(Number(a[1].replace(`${e?.[1]?.year()}-`,"").replace(/\D/g,""))).startOf("isoWeek").clone().add(5,"days").format("YYYY-MM-DD");t(r?new Date(r).getTime():0),n(i?new Date(i).getTime():0)}}}),r.jsx(T.Z,{onChange:e=>{v(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})]})]}),r.jsx("div",{className:"w-full overflow-auto",children:r.jsx("div",{className:"min-w-fit",children:r.jsx(j.Z,{columns:g,dataSource:h,scroll:{x:"max-content"},pagination:{pageSize:i,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`},showSorterTooltip:{target:"sorter-icon"}})})})]})}async function L(e){try{let t=new(c()).Workbook,a=t.addWorksheet("BaoCaoCongNoCanTra");a.addRow([]),a.mergeCells("B2:H2"),a.getCell("B2").value=`B\xc1O C\xc1O C\xd4NG NỢ CẦN TRẢ`,a.getCell("B2").font={size:24,bold:!0},a.getCell("B2").alignment={vertical:"middle",horizontal:"center"},a.columns=[{key:"empty1",width:5},{key:"date_expired",width:30},{key:"payment_id",width:30},{key:"name_supplier",width:30},{key:"type_product",width:30},{key:"description",width:30},{key:"price",width:30}],a.addRow(3).values=["","HẠN C\xd4NG NỢ","M\xc3 THANH TO\xc1N","T\xcaN NH\xc0 CUNG CẤP","SẢN PHẨM DỊCH VỤ","M\xd4 TẢ","C\xd4NG NỢ"],a.getRow(3).font={bold:!0,size:12,color:{argb:"ffffff"}},a.getRow(3).alignment={vertical:"middle",horizontal:"center"};let r=a.getRow(3);for(let e=2;e<=7;e++)r.getCell(e).border={bottom:{style:"thin"},top:{style:"thin"},right:{style:"thin"},left:{style:"thin"}},r.getCell(e).fill={type:"pattern",pattern:"solid",fgColor:{argb:"1BA49D"}};let n=e.reduce((t,r,n)=>{t?.[r?.date_expired]?r?.date_expired!==e?.[n+1]?.date_expired&&(t[r.date].end=n+4):t[r.date_expired]={start:n+4,end:n+4},a.addRow({empty1:"",empty2:"",...r,date_expired:e?.[n-1]?.date_expired!==r?.date_expired?r?.date_expired:""});let i=a.getRow(n+4);for(let e=2;e<=7;e++)i.getCell(e).border={bottom:{style:"thin"},top:{style:"thin"},right:{style:"thin"},left:{style:"thin"}},i.getCell(e).font={size:12};return t},{});Object.keys(n).forEach(e=>{a.mergeCells(`B${n[e].start}:B${n[e].end}`),a.getCell(`B${n[e].start}`).alignment={vertical:"middle",horizontal:"center"}});let i=await t.xlsx.writeBuffer(),l=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,m.saveAs)(l,`B\xe1o c\xe1o cần trả c\xf4ng nợ.xlsx`)}catch(e){console.log(e)}}function V(){let[e,t]=(0,l.useState)(25);(0,p.I0)();let{datas:a}=(0,p.v9)(e=>e.get_payments),[n,i]=(0,l.useState)(),o=[{label:"Excel",key:"excel",icon:r.jsx(I.ugd,{})}],d=()=>{L(n?.map(e=>({date_expired:new Date(e.date_expired??"").toLocaleDateString("vi-VN"),payment_id:e.payment_id,name_supplier:e.supplier?.name,type_product:e.type_product.name,description:e.description,price:(e.price??0).toLocaleString("vi-VN")+" ₫"})))},c=e=>{i(a?.filter(t=>String(t.payment_id+" "+t.created_at+" "+t.description+" "+t?.supplier?.name).toLowerCase().includes(e.toLowerCase())))};return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[r.jsx(N.Z,{defaultValue:e,style:{width:83},onChange:e=>t(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),r.jsx(k.Z,{menu:{items:o,onClick:e=>{"excel"===e.key&&d()}},children:(0,r.jsxs)(s.ZP,{children:[r.jsx(C.Z,{children:"Xuất ra"}),r.jsx($.Ix0,{})]})})]}),r.jsx("div",{className:"flex gap-2 items-center flex-wrap",children:r.jsx(T.Z,{onChange:e=>{c(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})})]}),r.jsx("div",{className:"w-full overflow-auto",children:r.jsx("div",{className:"min-w-fit",children:r.jsx(j.Z,{columns:[{title:"Thời gian",dataIndex:["created_at"],key:"created_at",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A"},{title:"M\xe3 thanh to\xe1n",dataIndex:"payment_id",key:"payment_id"},{title:"T\xean nh\xe0 cung cấp",dataIndex:["supplier","name"],key:"name"},{title:"Hết hạn",dataIndex:["date_expired"],key:"date_expired",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A"},{title:"Sản phẩm dịch vụ",dataIndex:["type_product","name"],key:"code_contract"},{title:"M\xf4 tả",dataIndex:"description",key:"description"},{title:"C\xf4ng nơ",dataIndex:"price",key:"price",render:e=>e.toLocaleString("vi-VN")+" ₫"}],dataSource:n,scroll:{x:"max-content"},pagination:{pageSize:e,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`},showSorterTooltip:{target:"sorter-icon"}})})})]})}async function G(e){try{let t=new(c()).Workbook,a=t.addWorksheet("BaoCaoCongNoCanThu");a.addRow([]),a.mergeCells("B2:H2"),a.getCell("B2").value=`B\xc1O C\xc1O C\xd4NG NỢ CẦN THU`,a.getCell("B2").font={size:24,bold:!0},a.getCell("B2").alignment={vertical:"middle",horizontal:"center"},a.columns=[{key:"empty1",width:5},{key:"date_expired",width:30},{key:"payment_id",width:30},{key:"name_contract",width:30},{key:"type_project",width:30},{key:"name_project",width:40},{key:"code_contract",width:30},{key:"type_product",width:30},{key:"description",width:30},{key:"price",width:30}],a.addRow(3).values=["","HẠN THU HỒI","M\xc3 THANH TO\xc1N","M\xc3 HỢP ĐỒNG","LOẠI C\xd4NG TR\xccNH","T\xcaN C\xd4NG TR\xccNH","SỐ CHỨNG TỪ","SẢN PHẨM DỊCH VỤ","M\xd4 TẢ","CẦN THU HỒI"],a.getRow(3).font={bold:!0,size:12,color:{argb:"ffffff"}},a.getRow(3).alignment={vertical:"middle",horizontal:"center"};let r=a.getRow(3);for(let e=2;e<=10;e++)r.getCell(e).border={bottom:{style:"thin"},top:{style:"thin"},right:{style:"thin"},left:{style:"thin"}},r.getCell(e).fill={type:"pattern",pattern:"solid",fgColor:{argb:"1BA49D"}};let n=e.reduce((t,r,n)=>{t?.[r?.date_expired]?r?.date_expired!==e?.[n+1]?.date_expired&&(t[r.date].end=n+4):t[r.date_expired]={start:n+4,end:n+4},a.addRow({empty1:"",empty2:"",...r,date_expired:e?.[n-1]?.date_expired!==r?.date_expired?r?.date_expired:""});let i=a.getRow(n+4);for(let e=2;e<=10;e++)i.getCell(e).border={bottom:{style:"thin"},top:{style:"thin"},right:{style:"thin"},left:{style:"thin"}},i.getCell(e).font={size:12};return t},{});Object.keys(n).forEach(e=>{a.mergeCells(`B${n[e].start}:B${n[e].end}`),a.getCell(`B${n[e].start}`).alignment={vertical:"middle",horizontal:"center"}});let i=await t.xlsx.writeBuffer(),l=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(0,m.saveAs)(l,`B\xe1o c\xe1o cần thu hồi c\xf4ng nợ.xlsx`)}catch(e){console.log(e)}}function q(){let[e,t]=(0,l.useState)(25);(0,p.I0)();let{datas:a}=(0,p.v9)(e=>e.get_payments),{datas:n}=(0,p.v9)(e=>e.vat_system),[i,o]=(0,l.useState)(),d=[{label:"Excel",key:"excel",icon:r.jsx(I.ugd,{})}],c=()=>{G(i?.map(e=>{let t=(n.find(t=>t.vat_id===e.vat)?.type_vat??0)/100*(e.price??0)+(e.price??0);return{date_expired:new Date(e.date_expired??"").toLocaleDateString("vi-VN"),payment_id:e.payment_id,name_contract:e.contract?.name_contract,type_project:e.contract?.project?.type?.name_type,name_project:e.contract?.project?.name,code_contract:e.contract?.code_contract,type_product:e.type_product.name,description:e.description,price:t.toLocaleString("vi-VN")+" ₫"}}))},m=e=>{o(a?.filter(t=>String(t.payment_id+" "+t.created_at+" "+t.description+" "+t?.contract?.name_contract).toLowerCase().includes(e.toLowerCase())))};return(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[r.jsx(N.Z,{defaultValue:e,style:{width:83},onChange:e=>t(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),r.jsx(k.Z,{menu:{items:d,onClick:e=>{"excel"===e.key&&c()}},children:(0,r.jsxs)(s.ZP,{children:[r.jsx(C.Z,{children:"Xuất ra"}),r.jsx($.Ix0,{})]})})]}),r.jsx("div",{className:"flex gap-2 items-center flex-wrap",children:r.jsx(T.Z,{onChange:e=>{m(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})})]}),r.jsx("div",{className:"w-full overflow-auto",children:r.jsx("div",{className:"min-w-fit",children:r.jsx(j.Z,{columns:[{title:"Hạn thu hồi",dataIndex:["date_expired"],key:"date_expired",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A"},{title:"M\xe3 thanh to\xe1n",dataIndex:"payment_id",key:"payment_id"},{title:"M\xe3 hợp đồng",dataIndex:["contract","name_contract"],key:"name_contract"},{title:"Loại c\xf4ng tr\xecnh",dataIndex:["contract","project","type","name_type"],key:"name_type"},{title:"T\xean c\xf4ng tr\xecnh",dataIndex:["contract","project","name"],key:"name"},{title:"Số chứng từ",dataIndex:["contract","code_contract"],key:"code_contract"},{title:"Sản phẩm dịch vụ",dataIndex:["type_product","name"],key:"code_contract"},{title:"M\xf4 tả",dataIndex:"description",key:"description"},{title:"Cần thu hồi",dataIndex:"price",key:"price-vat",render:(e,t)=>((n.find(e=>e.vat_id===t.vat)?.type_vat??0)/100*e+e).toLocaleString("vi-VN")+" ₫"}],dataSource:i,scroll:{x:"max-content"},pagination:{pageSize:e,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`},showSorterTooltip:{target:"sorter-icon"}})})})]})}function A(){let e=(0,o.ZP)({maxWidth:639}),[t,a]=(0,l.useState)("report-work"),n=[{label:"B\xe1o c\xe1o c\xf4ng việc",key:"report-work",children:"report-work"===t&&r.jsx(z,{})},{label:"B\xe1o c\xe1o doanh thu",key:"report-revenue",children:"report-revenue"===t&&r.jsx(Z,{})},{label:"B\xe1o c\xe1o c\xf4ng nợ phải thu",key:"report-debt-customer",children:"report-debt-customer"===t&&r.jsx(q,{})},{label:"B\xe1o c\xe1o c\xf4ng nợ nh\xe0 cung cấp",key:"report-debt-supplier",children:"report-debt-supplier"===t&&r.jsx(V,{})}];return(0,r.jsxs)("div",{className:"flex flex-col p-4",children:[r.jsx("div",{className:"w-full",children:r.jsx(w,{})}),r.jsx("div",{className:"flex-1",children:r.jsx(i.Z,{items:n,tabPosition:`${e?"top":"right"}`,onChange:e=>{a(e)}})})]})}a(92704),a(74552);var M=a(67552);function O(){(0,p.I0)();let e=(0,M.Z)(["admin-top","system","system-read"]);return r.jsx("div",{className:"p-4",children:e?r.jsx(A,{}):r.jsx(n.Z,{})})}},49509:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var r=a(97247),n=a(82547),i=a(77951);function l(){return r.jsx(n.ZP,{status:"403",title:"403",subTitle:"Sorry, you are not authorized to access this page.",extra:r.jsx(i.ZP,{type:"primary",children:"Quay lại"})})}a(28964)},8764:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(45347).createProxy)(String.raw`E:\riot\sparking\sp_1\src\app\system\report\error.tsx#default`)},25253:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(45347).createProxy)(String.raw`E:\riot\sparking\sp_1\src\app\system\report\page.tsx#default`)},28204:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i}),a(72051);var r=a(54564);let n={size:{width:32,height:32},contentType:"image/png"};async function i(e){let{__metadata_id__:t,...a}=e.params,i=(0,r.fillMetadataSegment)(".",a,"icon"),{generateImageMetadata:l}=n;function o(e,t){let a={alt:e.alt,type:e.contentType||"image/png",url:i+(t?"/"+t:"")+"?4a97cfd375538d02"},{size:r}=e;return r&&(a.sizes=r.width+"x"+r.height),a}return l?(await l({params:a})).map((e,t)=>{let a=(e.id||t)+"";return o(e,a)}):[o(n,"")]}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[9379,4671,4564,2703,2602,5090,4523,7504,8188],()=>a(52769));module.exports=r})();