"use strict";exports.id=7233,exports.ids=[7233],exports.modules={57233:(e,s,t)=>{t.d(s,{Z:()=>F});var r=t(97247),n=t(28964),l=t(77951),a=t(61410),i=t(12927),d=t(1880),c=t(39884),o=t(95718),h=t(65794),m=t(35090),x=t(88506),u=t(77784),p=t(69160),f=t(23102),g=t(98065),j=t(99539),y=t(83473),v=t(50678),b=t(2805),N=t(41290),Z=t(48738),w=t(34178),_=t(55757),C=t(99219),k=t(57989),T=t(89779),I=t(37013),O=t(51740),S=t(87597),W=t(28852);let F=({refBtnProject:e})=>{let{customerID:s}=(0,w.useParams)(),[t,F]=(0,n.useState)(),[P,R]=(0,n.useState)(""),[V,L]=(0,n.useState)(""),[A,B]=(0,n.useState)([]),[z,q]=(0,n.useState)(!1),$=(0,n.useRef)(),E=(0,n.useRef)(),G=(0,f.I0)(),{datas:H}=(0,f.v9)(e=>e.get_users),{datas:M}=(0,f.v9)(e=>e.role_projects),Y=(H??[])?.filter(e=>!A.some(s=>s.user===e.user_id)),{datas:X}=(0,f.v9)(e=>e.get_opportunities);(0,n.useEffect)(()=>{s&&U.setFieldValue("customer",s)},[s]);let{datas:D}=(0,f.v9)(e=>e.type_projects),{datas:J}=(0,f.v9)(e=>e.infos_customer),{postdata:K}=(0,j.Z)(),[U]=(0,p.Z)(),Q=e=>{B(s=>s.filter(s=>s.user!==e))},ee=async e=>{try{let r=(0,Z.Z)(Object.entries({...e,start_date:e.start_date?e.start_date.toISOString():void 0,end_date:e.end_date?e.end_date.toISOString():void 0,picture_url:[t?.originFileObj],users:JSON.stringify(A)}).reduce((e,[s,t])=>(null!=t&&(e[s]=t),e),{})),n=await K(()=>y.Z.createProject(r));(200===n||201===n)&&(G((0,v.b)(s?{customer:s}:void 0)),U.resetFields(),q(!1))}catch(e){console.error("Error creating project:",e)}},es=(0,r.jsxs)("button",{style:{border:0,background:"none"},type:"button",children:[r.jsx(u.Z,{}),r.jsx("div",{style:{marginTop:8},children:"Upload"})]});return(0,r.jsxs)(r.Fragment,{children:[r.jsx(l.ZP,{hidden:!!e,className:"bg-blue-400 border-0 text-white font-semibold",icon:r.jsx(g.b0B,{}),onClick:()=>{q(!0)},ref:e,children:"Tạo dự \xe1n"}),r.jsx(a.Z,{title:"Điền form dự \xe1n",open:z,onCancel:()=>{q(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:(0,r.jsxs)(i.Z,{layout:"vertical",form:U,onFinish:ee,style:{display:"flex",flexWrap:"wrap",gap:"12px"},children:[r.jsx(i.Z.Item,{name:"name",label:"T\xean dự \xe1n",style:{minWidth:"320px",flex:"1 1 0%"},rules:[{required:!0,message:"Vui l\xf2ng nhập t\xean dự \xe1n"}],children:r.jsx(d.default,{placeholder:"T\xean dự \xe1n"})}),r.jsx(i.Z.Item,{name:"customer",label:"Kh\xe1ch h\xe0ng",style:{minWidth:"320px",flex:"1 1 0%"},rules:[{required:!0,message:"Vui l\xf2ng nhập t\xean kh\xe1ch h\xe0ng"}],children:r.jsx(c.Z,{placeholder:"Chọn kh\xe1ch h\xe0ng",showSearch:!0,filterOption:(e,s)=>(Array.isArray(s?.children)?s.children.join(""):s?.children??"").toLowerCase().includes(e.toLowerCase()),dropdownRender:e=>(0,r.jsxs)(r.Fragment,{children:[e,r.jsx(o.Z,{style:{margin:"8px 0"}}),r.jsx(l.ZP,{type:"link",onClick:()=>{E.current?.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:J?.map(e=>r.jsx(c.Z.Option,{value:e.info_id,children:e.name_company},e.info_id))})}),r.jsx(i.Z.Item,{name:"opportunity",label:"Cơ hội",style:{minWidth:"320px",flex:"1 1 0%"},rules:[],children:r.jsx(c.Z,{placeholder:"Chọn cơ hội",showSearch:!0,filterOption:(e,s)=>(Array.isArray(s?.children)?s.children.join(""):s?.children??"").toLowerCase().includes(e.toLowerCase()),children:X?.map(e=>r.jsx(c.Z.Option,{value:e.opportunity_id,children:e.company_name},e.opportunity_id))})}),r.jsx(i.Z.Item,{name:"type",label:"Loại dự \xe1n",style:{minWidth:"320px",flex:"1 1 0%"},rules:[{required:!0,message:"Vui l\xf2ng chọn loại dự \xe1n"}],children:r.jsx(c.Z,{placeholder:"Chọn loại",showSearch:!0,filterOption:(e,s)=>(Array.isArray(s?.children)?s.children.join(""):s?.children??"").toLowerCase().includes(e.toLowerCase()),dropdownRender:e=>(0,r.jsxs)(r.Fragment,{children:[e,r.jsx(o.Z,{style:{margin:"8px 0"}}),r.jsx(l.ZP,{type:"link",onClick:()=>{$.current?.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:D?.map(e=>r.jsx(c.Z.Option,{value:e.type_id,children:e.name_type},e.type_id))})}),r.jsx(i.Z.Item,{name:"status",label:"Trạng th\xe1i",rules:[{required:!0,message:"Vui l\xf2ng chọn trạng th\xe1i"}],style:{minWidth:"220px",flex:"1 1 0%"},children:(0,r.jsxs)(c.Z,{placeholder:"Chọn trạng th\xe1i",children:[r.jsx(c.Z.Option,{value:"waiting",children:"Đang chờ"}),r.jsx(c.Z.Option,{value:"start",children:"Bắt đầu"}),r.jsx(c.Z.Option,{value:"pause",children:"Tạm dừng"}),r.jsx(c.Z.Option,{value:"cancel",children:"Hủy"}),r.jsx(c.Z.Option,{value:"completed",children:"Ho\xe0n th\xe0nh"})]})}),r.jsx(i.Z.Item,{name:"price",label:"Gi\xe1 trị (vnđ)",style:{minWidth:"320px",flex:"1 1 0%"},children:r.jsx(h.Z,{placeholder:"Gi\xe1 trị",className:"w-full",formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e?.replace(/\$\s?|(,*)/g,"")})}),r.jsx(i.Z.Item,{name:"time_job",label:"Thời gian (giờ)",style:{minWidth:"220px",flex:"1 1 0%"},children:r.jsx(h.Z,{placeholder:"Thời gian c\xf4ng việc",className:"w-full"})}),r.jsx(i.Z.Item,{name:"user_support",label:"Nh\xe2n vi\xean hỗ trợ ch\xednh",style:{minWidth:"220px",flex:"1 1 0%"},children:r.jsx(c.Z,{placeholder:"Chọn nh\xe2n vi\xean",children:H?.map(e=>r.jsxs(c.Z.Option,{value:e.user_id,children:[e.first_name," ",e.last_name]},e.user_id))})}),r.jsx(i.Z.Item,{name:"start_date",label:"Ng\xe0y bắt đầu",style:{minWidth:"320px",flex:"1 1 0%"},children:r.jsx(m.default,{placeholder:"Chọn ng\xe0y bắt đầu",style:{width:"100%"}})}),r.jsx(i.Z.Item,{name:"end_date",label:"Ng\xe0y kết th\xfac",style:{minWidth:"320px",flex:"1 1 0%"},children:r.jsx(m.default,{placeholder:"Chọn ng\xe0y kết th\xfac",style:{width:"100%"}})}),r.jsx(i.Z.Item,{name:"description",label:"M\xf4 tả",style:{width:"100%"},children:r.jsx(d.default.TextArea,{placeholder:"M\xf4 tả dự \xe1n",autoSize:{minRows:3}})}),r.jsx(i.Z.Item,{name:"picture_url",label:"Ảnh đại diện",className:"!m-0",style:{minWidth:"320px",flex:"1 1 0%"},children:r.jsx(x.default,{maxCount:1,action:"",listType:"picture-card",onChange:({file:e})=>{F(e)},children:es})}),r.jsx(i.Z.Item,{className:"!m-0",style:{minWidth:"100%",flex:"1 1 0%"},children:(0,r.jsxs)(_.Zb,{className:"w-full",children:[r.jsx(_.Ol,{children:(0,r.jsxs)(_.ll,{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),"Ph\xe2n c\xf4ng dự \xe1n"]})}),(0,r.jsxs)(_.aY,{className:"space-y-4",children:[r.jsx(_.Zb,{className:"border-dashed border-2 border-gray-200",children:r.jsx(_.aY,{className:"p-4",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[r.jsx(C.Z,{className:"w-4 h-4"}),"Th\xeam th\xe0nh vi\xean"]}),0===Y.length?(0,r.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[r.jsx(k.Z,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),r.jsx("p",{children:"Tất cả người d\xf9ng đ\xe3 được ph\xe2n c\xf4ng"})]}):(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(O._,{children:"Chọn nh\xe2n vi\xean"}),r.jsx(c.Z,{placeholder:"Chọn nh\xe2n vi\xean",className:"h-14",value:P,onChange:R,children:Y?.map(e=>r.jsx(c.Z.Option,{value:e.user_id,children:r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"font-medium",children:e.first_name+" "+e.last_name}),r.jsx("span",{className:"text-xs text-gray-500",children:e.email})]})},e.user_id))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[r.jsx(O._,{children:"Chọn vai tr\xf2"}),r.jsx(c.Z,{placeholder:"Chọn vai tr\xf2",className:"h-14",value:V,onChange:L,children:M?.map(e=>r.jsx(c.Z.Option,{value:e.role_id??"",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(S.C,{variant:"outline",className:"text-xs",children:e.name_tag}),r.jsx("span",{children:e.name})]})},e.role_id))})]}),r.jsx("div",{className:"flex items-end",children:(0,r.jsxs)(W.Z2,{onClick:()=>{if(!P||!V){alert("Vui l\xf2ng chọn người d\xf9ng v\xe0 vai tr\xf2");return}if(P&&V){let e={user:P,role:V};B(s=>[...s,e]),R(""),L("")}},disabled:!P||!V,className:"w-full",children:[r.jsx(C.Z,{className:"w-4 h-4 mr-2"}),"Th\xeam"]})})]})]})})}),A.length>0&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[r.jsx(T.Z,{className:"w-4 h-4"}),"Th\xe0nh vi\xean đ\xe3 ph\xe2n c\xf4ng (",A.length,")"]}),r.jsx("div",{className:"space-y-2",children:A.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx(k.Z,{className:"w-4 h-4 text-blue-600"})}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:H?.find(s=>s.user_id===e.user)?.first_name+" "+H?.find(s=>s.user_id===e.user)?.last_name}),r.jsx("div",{className:"text-sm text-gray-500",children:H?.find(s=>s.user_id===e.user)?.email})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(S.C,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:M?.find(s=>s.role_id===e.role)?.name_tag}),r.jsx("span",{className:"text-sm text-gray-600",children:M?.find(s=>s.role_id===e.role)?.name}),r.jsx(W.Z2,{type:"button",variant:"ghost",size:"sm",onClick:()=>Q(e.user),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:r.jsx(I.Z,{className:"w-4 h-4"})})]})]},e.user))})]})]})]})}),r.jsx(i.Z.Item,{style:{width:"100%",display:"flex",justifyContent:"end"},children:r.jsx(l.ZP,{type:"primary",htmlType:"submit",children:"Tạo"})})]})}),r.jsx(b.Z,{refBtnGroup:$}),r.jsx(N.Z,{refBtnCustomer:E})]})}},2805:(e,s,t)=>{t.d(s,{Z:()=>v});var r=t(97247),n=t(28964),l=t(12927),a=t(1880),i=t(77951),d=t(61410),c=t(77709),o=t(99539),h=t(69160),m=t(38043),x=t(67427),u=t(98065),p=t(53803),f=t(23102),g=t(83473),j=t(50678),y=t(75268);let v=({refBtnGroup:e})=>{let[s,t]=(0,n.useState)(!1),[v,b]=(0,n.useState)([]),N=(0,f.I0)(),{datas:Z}=(0,f.v9)(e=>e.type_projects),w=async(e,s,t)=>{console.log(e);try{let r=await W(()=>g.Z.updateType(s,e));200===r&&(N((0,j.b)()),N((0,y.c)()),N((0,j.b)()),I(t))}catch(e){console.error("Error creating unit product:",e)}},[_,C]=(0,n.useState)(""),k=async()=>{200===await W(()=>g.Z.deleteType([_??""]))&&(N((0,y.c)()),C(""))},T=e=>{b([...v,e])},I=e=>{b(v.filter(s=>s!==e))},[O,S]=(0,n.useState)(!1),{postdata:W}=(0,o.Z)(),[F]=(0,h.Z)(),P=[{title:"M\xe3 loại",dataIndex:"type_id",key:"type_id",render:(e,s,t)=>(0,r.jsxs)("div",{className:"flex gap-1 items-center",children:["#",t+1,".",e]})},{title:"T\xean loại",dataIndex:"name_type",width:"50%",key:"name_type",render:(e,s,t)=>r.jsx(r.Fragment,{children:v.includes(t)?(0,r.jsxs)(l.Z,{onFinish:e=>{w(e,s.type_id,t)},style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[r.jsx(l.Z.Item,{name:"name_type",rules:[{required:!0,message:"Vui l\xf2ng nhập t\xean mới"}],style:{margin:"0"},children:r.jsx(a.default,{placeholder:"Nhập t\xean loại",defaultValue:e})}),(0,r.jsxs)(l.Z.Item,{style:{gap:"2px",display:"flex",justifyContent:"end",margin:"0"},children:[r.jsx(i.ZP,{className:"font-semibold border-transparent group",type:"link",htmlType:"submit",icon:r.jsx(p.l_A,{className:"group-hover:text-green-500"})}),r.jsx(i.ZP,{className:"font-semibold border-transparent group",type:"link",onClick:()=>{I(t)},icon:r.jsx(u.bjh,{className:"group-hover:text-red-500"})})]})]}):(0,r.jsxs)("strong",{className:"flex gap-2 items-center",children:[e,r.jsx(i.ZP,{type:"link",onClick:()=>{T(t)},icon:r.jsx(x.FNg,{})}),r.jsx(i.ZP,{className:"  text-xs text-red-500 font-semibold",type:"text",onClick:()=>C(s?.type_id),children:"X\xf3a"})]})})}],R=async e=>{try{let s=await W(()=>g.Z.createType(e));201===s&&(N((0,j.b)()),N((0,y.c)()),F.resetFields())}catch(e){console.error("Error creating product:",e)}};return(0,r.jsxs)(r.Fragment,{children:[r.jsx(i.ZP,{hidden:!!e,className:"bg-blue-400 border-0 text-white font-semibold",onClick:()=>{t(!0)},ref:e,children:"Loại dự \xe1n"}),r.jsx(d.Z,{title:"Loại dự \xe1n",open:s,onCancel:()=>{t(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[r.jsx(i.ZP,{className:"bg-orange-500 text-white font-semibold",icon:r.jsx(m.gyF,{}),onClick:()=>{F.resetFields(),S(!O)}}),r.jsx("div",{className:"bg-slate-200 px-1 py-2 rounded-md",hidden:!O,children:(0,r.jsxs)(l.Z,{form:F,onFinish:R,style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[r.jsx(l.Z.Item,{name:"name_type",rules:[{required:!0,message:"Vui l\xf2ng nhập t\xean loại"}],style:{flex:"1 1 0%",margin:"0"},children:r.jsx(a.default,{placeholder:"Nhập t\xean loại"})}),r.jsx(l.Z.Item,{style:{display:"flex",justifyContent:"end",margin:"0"},children:r.jsx(i.ZP,{className:"bg-green-500 text-white font-semibold",onClick:()=>{F.submit()},children:"Th\xeam"})})]})}),r.jsx("div",{className:"border-t-2 w-full overflow-x-auto",children:r.jsx("div",{className:"w-full",children:r.jsx(c.Z,{columns:P,scroll:{x:"max-content"},className:"custom-table",dataSource:Z,pagination:{pageSize:10,showTotal:(e,s)=>`${s[0]}-${s[1]} of ${e} items`},showSorterTooltip:{target:"sorter-icon"}})})})]})}),r.jsx(d.Z,{open:""!==_,title:"X\xf3a dữ liệu",onOk:k,onCancel:()=>{C("")},children:"Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng ?"})]})}},87597:(e,s,t)=>{t.d(s,{C:()=>i});var r=t(97247);t(28964);var n=t(87972),l=t(40677);let a=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i({className:e,variant:s,...t}){return r.jsx("div",{className:(0,l.cn)(a({variant:s}),e),...t})}},28852:(e,s,t)=>{t.d(s,{Z2:()=>o,zx:()=>c});var r=t(97247),n=t(28964),l=t(69008),a=t(87972),i=t(40677);let d=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef(({className:e,variant:s,size:t,asChild:n=!1,...a},c)=>{let o=n?l.g7:"button";return r.jsx(o,{className:(0,i.cn)(d({variant:s,size:t,className:e})),ref:c,...a})});c.displayName="Button";let o=n.forwardRef(({className:e,variant:s,size:t,asChild:n=!1,...a},c)=>{let o=n?l.g7:"button";return r.jsx(o,{className:(0,i.cn)(d({variant:s,size:t,className:e})),ref:c,...a})});o.displayName="Button"},55757:(e,s,t)=>{t.d(s,{Ol:()=>i,SZ:()=>c,Zb:()=>a,aY:()=>o,ll:()=>d});var r=t(97247),n=t(28964),l=t(40677);let a=n.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));a.displayName="Card";let i=n.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",e),...s}));i.displayName="CardHeader";let d=n.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));d.displayName="CardTitle";let c=n.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",e),...s}));c.displayName="CardDescription";let o=n.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("p-6 pt-0",e),...s}));o.displayName="CardContent",n.forwardRef(({className:e,...s},t)=>r.jsx("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter"},51740:(e,s,t)=>{t.d(s,{_:()=>c});var r=t(97247),n=t(28964),l=t(40768),a=t(87972),i=t(40677);let d=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=n.forwardRef(({className:e,...s},t)=>r.jsx(l.f,{ref:t,className:(0,i.cn)(d(),e),...s}));c.displayName=l.f.displayName},40677:(e,s,t)=>{t.d(s,{cn:()=>l});var r=t(61929),n=t(35770);function l(...e){return(0,n.m6)((0,r.W)(e))}}};