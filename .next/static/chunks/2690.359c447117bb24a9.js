(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2690],{72690:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var l=a(57437),i=a(15463),n=a(68430),r=a(40776),s=a(56612),o=a(71096),u=a.n(o),d=a(2265),c=a(68575);function p(){let e=(0,c.I0)(),{RangePicker:t}=s.default,[a,o]=(0,d.useState)(new Date().getFullYear()),[p,f]=(0,d.useState)(new Date().getFullYear()),[v,h]=(0,d.useState)([]),[g,m]=(0,d.useState)([]),{datas:S}=(0,c.v9)(e=>e.get_opportunities_dashboard),[y,x]=(0,d.useState)([]),b=async()=>{let e=await r.Z.getSourcesFullOpportunity(),t=await r.Z.getOpportunityDashReason();if(200===e.statusCode&&200===t.statusCode){var a,l,i,n;let r=e.data.sort((e,t)=>{var a,l,i,n;return(null!==(i=null==t?void 0:null===(a=t.opportunities)||void 0===a?void 0:a.length)&&void 0!==i?i:0)-(null!==(n=null==e?void 0:null===(l=e.opportunities)||void 0===l?void 0:l.length)&&void 0!==n?n:0)}).map(e=>{var t;return{name:e.name,y:null===(t=e.opportunities)||void 0===t?void 0:t.length}});m([{name:"Tạm dừng",y:null==t?void 0:null===(l=t.data)||void 0===l?void 0:null===(a=l.pause)||void 0===a?void 0:a.length},{name:"Đ\xe3 hủy",y:null==t?void 0:null===(n=t.data)||void 0===n?void 0:null===(i=n.cancel)||void 0===i?void 0:i.length}]),x(r)}},w=async()=>{S&&h(S.slice().sort((e,t)=>{var a,l;return(null!==(a=null==t?void 0:t.opportunities)&&void 0!==a?a:0)-(null!==(l=null==e?void 0:e.opportunities)&&void 0!==l?l:0)}).map(e=>({name:e.name,y:e.opportunities})))};return(0,d.useEffect)(()=>{w()},[S]),(0,d.useEffect)(()=>{b()},[]),(0,d.useEffect)(()=>{p&&a&&e((0,n.y)({start_year:a,end_year:p}))},[p,a]),(0,l.jsxs)("div",{className:"flex flex-wrap justify-between p-4 lg:flex-nowrap gap-8",children:[(0,l.jsxs)("div",{className:"p-4 flex-1 min-w-80",children:[(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,l.jsx)(t,{picker:"year",value:[u()(new Date(a,0,1).getTime()),u()(new Date(p,0,1).getTime())],onChange:(e,t)=>{o(Number(t[0])),f(Number(t[1]))}})}),(0,l.jsx)(i.Z,{dataSrc:v,titleSrc:'<p class="slim-dashboard-title">Loại cơ hội</p>',subTitleSrc:"",typeValueSuffix:" ",nameSeries:"Số cơ hội"})]}),(0,l.jsx)("div",{className:"p-4 flex-1 min-w-80",children:(0,l.jsx)(i.Z,{dataSrc:y,titleSrc:'<p class="slim-dashboard-title">Nguồn cơ hội</p>',subTitleSrc:""})}),(0,l.jsx)("div",{className:"p-4 flex-1 min-w-80",children:(0,l.jsx)(i.Z,{dataSrc:g,titleSrc:'<p class="slim-dashboard-title">Cơ hội k\xe9m</p>',subTitleSrc:"",typeValueSuffix:" ",nameSeries:"Số cơ hội"})})]})}},15463:function(e,t,a){"use strict";var l=a(57437),i=a(2265),n=a(82282),r=a.n(n),s=a(62330),o=a.n(s),u=a(96085),d=a.n(u),c=a(58824),p=a.n(c);a(133),o()(r()),p()(r()),t.Z=e=>{var t,a;let n=(0,i.useRef)(null),[s,o]=(0,i.useState)(e.dataSrc||[]),[u,c]=(0,i.useState)(e.titleSrc||""),[p,f]=(0,i.useState)(e.subTitleSrc||"");(0,i.useEffect)(()=>{o(e.dataSrc),f(e.subTitleSrc),c(e.titleSrc)},[e]);let v={chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{useHTML:!0,text:u,align:"left",verticalAlign:"top",y:20},subtitle:{useHTML:!0,text:p,align:"left",verticalAlign:"top",y:50,style:{fontSize:"12px",color:"rgb(102, 102, 102)"}},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},accessibility:{point:{valueSuffix:null!==(t=e.typeValueSuffix)&&void 0!==t?t:"%"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,format:"{point.name}: {point.y}"},showInLegend:!0}},series:[{name:null!==(a=e.nameSeries)&&void 0!==a?a:"Phần trăm",colorByPoint:!0,data:s}],exporting:{enabled:!1}};return(0,l.jsx)(l.Fragment,{children:s&&s.length>0?(0,l.jsx)("div",{className:"pieChart",children:(0,l.jsx)(d(),{highcharts:r(),options:v,ref:n})}):(0,l.jsx)(l.Fragment,{})})}},68430:function(e,t,a){"use strict";a.d(t,{y:function(){return n}});var l=a(20301),i=a(40776);let n=(0,l.hg)("opportunity/fetchDashboardOpportunities",async(e,t)=>{try{return await i.Z.getOpportunityFilterByType(e)}catch(e){return t.rejectWithValue("Failed to fetch opportunities")}}),r=(0,l.oM)({name:"opportunity_dashboard_all",initialState:{datas:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{200===t.payload.statusCode?(e.loading=!1,e.datas=t.payload.data):(e.loading=!1,e.error="Unexpected status code")}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload})}}).reducer;t.Z=r},133:function(){}}]);