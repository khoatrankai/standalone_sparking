"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4519],{64150:function(e,t,a){a.d(t,{Z:function(){return T}});var r=a(57437),l=a(46475),n=a(80841),i=a(24307),s=a(35947),c=a(91626),d=a(58970),o=a(42654),u=a(44967),h=a(16836),p=a(11632),y=a(23496),g=a(56612),w=a(87863),f=a(89970),m=a(29487),x=a(45747),v=a(7140),j=a(2265),Z=a(94295),k=a(32768),S=a(68575),C=a(21544),_=a(83458),W=a(9626),U=a(43882),b=a(99376);function T(e){var t,a;let{idStatus:T,idType:F,refBtnWork:R,type:P}=e,{Panel:A}=s.default,I=(0,j.useRef)(null),{projectID:N}=(0,b.useParams)(),L=(0,b.useSearchParams)();(0,j.useEffect)(()=>{if(L){let e=L.get("activity");e&&J.setFieldValue("activity",e)}},[L]);let B=(0,j.useRef)(),V=(0,j.useRef)(),E=(0,j.useRef)(),{datas:G}=(0,S.v9)(e=>e.get_type_work),{datas:D}=(0,S.v9)(e=>e.get_projects),{datas:K}=(0,S.v9)(e=>e.get_users),{datas:O}=(0,S.v9)(e=>e.get_activities),[q,M]=(0,j.useState)(!1),[Y,z]=(0,j.useState)([]),[H,$]=(0,j.useState)([]),[J]=(0,m.Z)(),{postdata:Q}=(0,l.Z)(),X=(0,S.I0)(),[ee,et]=(0,j.useState)(!1),[ea,er]=(0,j.useState)(""),el=async e=>{let t=await Q(()=>i.Z.createWork({...e,list_users:H}));(200===t||201===t)&&(P||X((0,n.LG)({project:N})),"schedule"===P&&X((0,U.C)(F)),et(!1))},en=async()=>{J.submit()};return(0,j.useEffect)(()=>{T&&F&&(J.setFieldsValue({status:T,type:F}),er(F))},[T,F]),(0,j.useEffect)(()=>{K&&z(K.map(e=>{var t;return{label:e.first_name+" "+e.last_name,value:e.user_id,group:null===(t=e.group_user)||void 0===t?void 0:t.name_group}}))},[K]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.ZP,{hidden:!!R,type:P?"link":"default",className:P?"text-[#EC8920]":"bg-blue-400 border-0 text-white font-semibold",icon:(0,r.jsx)(k.b0B,{}),onClick:()=>{et(!0)},ref:R,children:"Th\xeam c\xf4ng việc"}),(0,r.jsxs)(d.Z,{title:"Tạo c\xf4ng việc",open:ee,onCancel:()=>{et(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,r.jsx)(o.Z,{defaultActiveKey:"1",style:{width:"100%"},type:"line",children:(0,r.jsx)(v.Z,{tab:"Th\xf4ng tin c\xf4ng việc",children:(0,r.jsx)(u.Z,{layout:"vertical",form:J,onFinish:el,style:{display:"flex",flexWrap:"wrap",columnGap:"12px"},children:(0,r.jsxs)(s.default,{defaultActiveKey:["1"],className:"w-full",children:[(0,r.jsxs)(A,{header:"Th\xf4ng tin chung",className:"w-full",children:[(0,r.jsx)(u.Z.Item,{name:"name",label:"T\xean c\xf4ng việc",rules:[{required:!0,type:"string",message:"Vui l\xf2ng nhập t\xean c\xf4ng việc"}],style:{minWidth:"100%",flex:"1 1 0%"},children:(0,r.jsx)(h.default,{})}),(0,r.jsx)(u.Z.Item,{name:"project",label:"C\xf4ng tr\xecnh",rules:[{required:!0,message:"Vui l\xf2ng chọn c\xf4ng tr\xecnh!"}],style:{minWidth:"320px",flex:"1 1 0%"},children:(0,r.jsx)(p.Z,{placeholder:"Chọn c\xf4ng tr\xecnh",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,r.jsxs)(r.Fragment,{children:[e,(0,r.jsx)(y.Z,{style:{margin:"8px 0"}}),(0,r.jsx)(c.ZP,{type:"link",onClick:()=>{var e;null===(e=I.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==D?void 0:D.map(e=>(0,r.jsx)(x.W,{value:e.project_id,children:e.name},e.project_id))})}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsx)(u.Z.Item,{name:"time_start",label:"Bắt đầu",className:" mb-0",style:{minWidth:"250px",flex:"1 1 0%"},children:(0,r.jsx)(g.default,{placeholder:"Chọn ng\xe0y bắt đầu",style:{width:"100%"}})}),(0,r.jsx)(u.Z.Item,{className:" mb-0",label:"Kết th\xfac",name:"time_end",rules:[{required:!0}],style:{minWidth:"250px",flex:"1 1 0%"},children:(0,r.jsx)(g.default,{placeholder:"Chọn ng\xe0y kết th\xfac",style:{width:"100%"}})})]}),(0,r.jsxs)("div",{className:" mt-8",children:[(0,r.jsx)("p",{children:"Người thực hiện"}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(w.C.Group,{max:{count:5,style:{color:"#f56a00",backgroundColor:"#fde3cf"}},children:null==H?void 0:H.map(e=>{var t,a;let l=null==K?void 0:K.find(t=>t.user_id===e);return(0,r.jsx)(f.Z,{title:((null==l?void 0:l.first_name)||"")+((null==l?void 0:l.last_name)||""),placement:"top",children:(0,r.jsx)(w.C,{src:null==l?void 0:l.picture_url,alt:(null!==(t=null==l?void 0:l.first_name)&&void 0!==t?t:"")+(null!==(a=null==l?void 0:l.last_name)&&void 0!==a?a:""),style:{backgroundColor:"#87d068"}})})})}),q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{mode:"multiple",onBlur:()=>{M(!q)},allowClear:!0,maxTagCount:"responsive",style:{width:"220px"},value:H,placeholder:"Please select",onChange:e=>{$(e)},options:null==Y?void 0:Y.map(e=>({label:(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:e.label}),(0,r.jsx)("div",{style:{fontSize:"12px",color:"gray"},children:e.group})]})}),value:e.value}))}),(0,r.jsx)(Z.FMH,{className:"w-8 h-8 text-red-500 cursor-pointer",onClick:()=>{M(!q)}})]}):(0,r.jsx)(Z.S$f,{className:"w-8 h-8 text-[#ED8C1F] cursor-pointer",onClick:()=>{M(!q)}})]})]})]},"1"),(0,r.jsxs)(A,{header:"Th\xf4ng tin n\xe2ng cao",children:[(0,r.jsx)(u.Z.Item,{name:"type",label:"Loại c\xf4ng việc",rules:[{required:!0,message:"Vui l\xf2ng chọn loại c\xf4ng việc!"}],style:{width:"100%",flex:"1 1 0%"},children:(0,r.jsx)(p.Z,{placeholder:"Chọn loại",onChange:e=>{er(e)},showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,r.jsxs)(r.Fragment,{children:[e,(0,r.jsx)(y.Z,{style:{margin:"8px 0"}}),(0,r.jsx)(c.ZP,{type:"link",onClick:()=>{var e;null===(e=B.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==G?void 0:G.map(e=>(0,r.jsx)(x.W,{value:e.type_work_id,children:e.name},e.type_work_id))})}),(0,r.jsx)(u.Z.Item,{name:"status",label:"Trạng th\xe1i",style:{minWidth:"240px",flex:"1 1 0%"},children:(0,r.jsx)(p.Z,{placeholder:"Chọn trạng th\xe1i",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,r.jsxs)(r.Fragment,{children:[e,(0,r.jsx)(y.Z,{style:{margin:"8px 0"}}),(0,r.jsx)(c.ZP,{type:"link",onClick:()=>{var e;null===(e=V.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null===(a=G.find(e=>e.type_work_id===ea))||void 0===a?void 0:null===(t=a.status)||void 0===t?void 0:t.map(e=>(0,r.jsx)(x.W,{value:e.status_work_id,children:e.name},e.status_work_id))})}),(0,r.jsx)(u.Z.Item,{name:"activity",label:"Hoạt động",style:{minWidth:"240px",flex:"1 1 0%"},children:(0,r.jsx)(p.Z,{placeholder:"Chọn hoạt động",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,r.jsxs)(r.Fragment,{children:[e,(0,r.jsx)(y.Z,{style:{margin:"8px 0"}}),(0,r.jsx)(c.ZP,{type:"link",onClick:()=>{var e;null===(e=E.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==O?void 0:O.map(e=>(0,r.jsx)(x.W,{value:e.activity_id,children:e.name},e.activity_id))})}),(0,r.jsx)(u.Z.Item,{name:"description",label:"M\xf4 tả",style:{width:"100%"},children:(0,r.jsx)(h.default.TextArea,{placeholder:"Description",autoSize:{minRows:3}})})]},"2")]})})},1)}),(0,r.jsx)("div",{className:"flex justify-end w-full mt-4",children:(0,r.jsx)(c.ZP,{type:"primary",onClick:en,children:"Tạo"})})]}),(0,r.jsx)(C.Z,{refBtnType:B}),(0,r.jsx)(_.Z,{refBtnStatus:V}),(0,r.jsx)(W.Z,{refBtnActivity:E})]})}},61232:function(e,t,a){a.d(t,{vh:function(){return n}});var r=a(20301),l=a(24307);let n=(0,r.hg)("statusWork/fetchStatusWork",async(e,t)=>{try{return await l.Z.getAllStatusWorks()}catch(e){return t.rejectWithValue("Failed to fetch Status activities")}}),i=(0,r.hg)("statusWork/createStatusWork",async(e,t)=>{try{return await l.Z.createStatusWork(e)}catch(e){return t.rejectWithValue("Failed to create Status activity")}}),s=(0,r.hg)("statusWork/updateStatusWork",async(e,t)=>{let{Status_id:a,data:r}=e;try{return await l.Z.updateStatusWork(a,r)}catch(e){return t.rejectWithValue("Failed to update Status activity")}}),c=(0,r.oM)({name:"statusWork",initialState:{datas:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.datas=t.payload.data}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(i.fulfilled,(e,t)=>{e.datas.push(t.payload.data)}).addCase(s.fulfilled,(e,t)=>{let a=e.datas.findIndex(e=>e.status_work_id===t.payload.data.status_work_id);-1!==a&&(e.datas[a]=t.payload.data)})}}).reducer;t.ZP=c},96248:function(e,t,a){a.d(t,{D:function(){return n}});var r=a(20301),l=a(24307);let n=(0,r.hg)("typeWork/fetchTypeWork",async(e,t)=>{try{return await l.Z.getAllTypeWorks()}catch(e){return t.rejectWithValue("Failed to fetch type Work")}}),i=(0,r.hg)("typeWork/createTypeWork",async(e,t)=>{try{return await l.Z.createTypeWork(e)}catch(e){return t.rejectWithValue("Failed to create type Work")}}),s=(0,r.hg)("typeWork/updateTypeWork",async(e,t)=>{let{type_id:a,data:r}=e;try{return await l.Z.updateTypeWork(a,r)}catch(e){return t.rejectWithValue("Failed to update type Work")}}),c=(0,r.oM)({name:"typeWork",initialState:{datas:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.datas=t.payload.data}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(i.fulfilled,(e,t)=>{e.datas.push(t.payload.data)}).addCase(s.fulfilled,(e,t)=>{let a=e.datas.findIndex(e=>e.type_work_id===t.payload.data.type_work_id);-1!==a&&(e.datas[a]=t.payload.data)})}}).reducer;t.ZP=c},41259:function(e,t,a){a.d(t,{C:function(){return n}});var r=a(58143),l=a(20301);let n=(0,l.hg)("user/fetchUserInfo",async(e,t)=>{try{return await r.Z.getUsers()}catch(e){return t.rejectWithValue("Failed to fetch user info")}}),i=(0,l.oM)({name:"user_info",initialState:{datas:null,loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{200===t.payload.statusCode&&(e.loading=!1,e.datas=t.payload.data)}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload})}}).reducer;t.Z=i},58143:function(e,t,a){var r=a(90382),l=a(28223);t.Z={getUsers:async()=>{try{return(await l.Z.get("/user/all")).data}catch(e){throw(0,r.S)(e),e}},getProfile:async()=>{try{return(await l.Z.get("/user/profile",{withCredentials:!0})).data}catch(e){throw(0,r.S)(e),e}},getUserIDAdmin:async e=>{try{return(await l.Z.get("/user/admin/id/".concat(e))).data}catch(e){throw(0,r.S)(e),e}},getUserIDAdminByUser:async()=>{try{return(await l.Z.get("/user/user")).data}catch(e){throw(0,r.S)(e),e}},loginUser:async e=>(await l.Z.post("/auth/login",e,{withCredentials:!0})).data,sendSign:async e=>(await l.Z.post("/auth/send-req-sign",e,{withCredentials:!0})).data,logoutUser:async()=>(await l.Z.post("/auth/logout")).data,createUser:async e=>{try{return(await l.Y.post("/user/create",e)).data}catch(e){throw(0,r.S)(e),e}},deleteUser:async e=>{try{return(await l.Z.delete("/user",{data:e})).data}catch(e){throw(0,r.S)(e),e}},updateUser:async(e,t)=>{try{return(await l.Y.put("/user/update/".concat(e),t)).data}catch(e){throw(0,r.S)(e),e}},updateUserProfile:async e=>{try{return(await l.Y.put("/user/update-profile",e)).data}catch(e){throw(0,r.S)(e),e}},updatePasswordUser:async e=>{try{return(await l.Z.put("/user/update-password",e)).data}catch(e){throw(0,r.S)(e),e}},getCategoryRoleFull:async()=>{try{return(await l.Z.get("/user/category-role-full")).data}catch(e){throw(0,r.S)(e),e}},getRoleUserFullByID:async e=>{try{return(await l.Z.get("/user/get-full-role-user-id/".concat(e))).data}catch(e){throw(0,r.S)(e),e}},getRoleUserFullByUser:async()=>{try{return(await l.Z.get("/user/get-full-role-user")).data}catch(e){throw(0,r.S)(e),e}},getRoleUserFullByAccess:async()=>{try{return(await l.Z.get("/user/get-full-role-user-access/")).data}catch(e){throw(0,r.S)(e),e}},updateRoleUserFullByID:async(e,t)=>{try{return(await l.Z.post("/user/full-role-user-id/".concat(e),t)).data}catch(e){throw(0,r.S)(e),e}},updateGroupRole:async(e,t)=>{try{return(await l.Z.put("/user/group-role/".concat(e),t)).data}catch(e){throw(0,r.S)(e),e}},getRoleByGroup:async e=>{try{return(await l.Z.get("/user/group-role/".concat(e))).data}catch(e){throw(0,r.S)(e),e}},getGroupUser:async()=>{try{return(await l.Z.get("/user/get-group-user")).data}catch(e){throw(0,r.S)(e),e}},getNotifyUser:async(e,t)=>{try{return(await l.Z.get("/user/get-notify?page=".concat(e,"&limit=").concat(t))).data}catch(e){throw(0,r.S)(e),e}},updateNotifyUser:async e=>{try{if(e)return(await l.Z.put("/user/update-notify/".concat(e))).data;return(await l.Z.put("/user/update-all-notify")).data}catch(e){throw(0,r.S)(e),e}},getCountNotifyUser:async()=>{try{return(await l.Z.get("/user/get-count-notify")).data}catch(e){throw(0,r.S)(e),e}},createGroupUser:async e=>{try{return(await l.Z.post("/user/create-group-user",e)).data}catch(e){throw(0,r.S)(e),e}},updateGroupUser:async(e,t)=>{try{return(await l.Z.put("/user/update-group-user/".concat(e),t)).data}catch(e){throw(0,r.S)(e),e}},deleteGroupUser:async e=>{try{return(await l.Z.delete("/user/group-user",{data:e})).data}catch(e){throw(0,r.S)(e),e}},getFilterUser:async e=>{try{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,r]=e;null!=r&&t.append(a,r.toString())}),(await l.Z.get("/user/get-user-filter?".concat(t.toString()))).data}catch(e){throw(0,r.S)(e),e}},getTimeKeeping:async e=>{try{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,r]=e;null!=r&&t.append(a,r.toString())}),(await l.Z.get("/user/timekeeping?".concat(t.toString()))).data}catch(e){throw(0,r.S)(e),e}},getTimeKeepingPerson:async e=>{try{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,r]=e;null!=r&&t.append(a,r.toString())}),(await l.Z.get("/user/timekeeping-person?".concat(t.toString()))).data}catch(e){throw(0,r.S)(e),e}},createTimeKeeping:async()=>{try{return(await l.Z.post("/user/timekeeping")).data}catch(e){throw(0,r.S)(e),e}},checkTimeKeeping:async()=>{try{return(await l.Z.get("/user/check-timekeeping")).data}catch(e){throw(0,r.S)(e),e}}}}}]);