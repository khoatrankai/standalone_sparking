(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5964],{20067:function(){},72061:function(){},2449:function(e,t,a){"use strict";a.d(t,{Z:function(){return eR}});var l=a(57437),r=a(2265),n=a(91626),s=a(11632),c=a(58970),i=a(91250),o=a(56771),d=a(68575),h=a(4599),u=a(17166),m=a(46475),p=a(2950),x=a(70601),g=a(42654),y=a(44967),f=a(23496),j=a(16836),v=a(90136),w=a(56612),b=a(29487),N=a(45747),C=a(7140),Z=a(1329),_=a(71096),S=a.n(_);function k(e){let{ID:t}=e,a=(0,r.useRef)(),i=(0,r.useRef)(),o=(0,r.useRef)(),{datas:_}=(0,d.v9)(e=>e.get_type_contract),{datas:k}=(0,d.v9)(e=>e.infos_customer),{datas:T}=(0,d.v9)(e=>e.get_projects),[F]=(0,b.Z)(),{postdata:P}=(0,m.Z)(),I=(0,d.I0)(),[D,R]=(0,r.useState)(!1),W=async()=>{let e=await x.Z.getContract(t);200===e.statusCode&&(console.log(e.data),F.setFieldsValue(e.data))},V=async e=>{let a=await P(()=>x.Z.updateContract(t,e));(200===a||201===a)&&(I((0,p.Wq)(null)),R(!1))},A=async()=>{F.submit()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.ZP,{className:"  text-xs text-yellow-500 font-semibold",type:"text",onClick:()=>{R(!0),W()},children:"Chỉnh sửa"}),(0,l.jsxs)(c.Z,{title:"Cập nhật hợp đồng",open:D,onCancel:()=>{R(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,l.jsx)(g.Z,{defaultActiveKey:"1",style:{width:"100%"},type:"line",children:(0,l.jsx)(C.Z,{tab:"Th\xf4ng tin hợp đồng",children:(0,l.jsxs)(y.Z,{layout:"vertical",form:F,onFinish:V,style:{display:"flex",flexWrap:"wrap",columnGap:"12px"},children:[(0,l.jsx)(y.Z.Item,{name:"customer",label:"Kh\xe1ch h\xe0ng",rules:[{required:!0,message:"Vui l\xf2ng chọn kh\xe1ch h\xe0ng!"}],style:{width:"100%",flex:"1 1 0%"},children:(0,l.jsx)(s.Z,{placeholder:"Chọn kh\xe1ch h\xe0ng",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,l.jsxs)(l.Fragment,{children:[e,(0,l.jsx)(f.Z,{style:{margin:"8px 0"}}),(0,l.jsx)(n.ZP,{type:"link",onClick:()=>{var e;null===(e=a.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==k?void 0:k.map(e=>(0,l.jsx)(N.W,{value:e.info_id,children:e.name_company},e.info_id))})}),(0,l.jsx)(y.Z.Item,{name:"project",label:"Dự \xe1n",style:{width:"100%",flex:"1 1 0%"},children:(0,l.jsx)(s.Z,{placeholder:"Chọn dự \xe1n",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,l.jsxs)(l.Fragment,{children:[e,(0,l.jsx)(f.Z,{style:{margin:"8px 0"}}),(0,l.jsx)(n.ZP,{type:"link",onClick:()=>{var e;null===(e=i.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==T?void 0:T.map(e=>(0,l.jsx)(N.W,{value:e.project_id,children:e.name},e.project_id))})}),(0,l.jsx)(y.Z.Item,{name:"name_contract",label:"T\xean hợp đồng",rules:[{required:!0,type:"string",message:"Vui l\xf2ng nhập t\xean hợp đồng"}],style:{minWidth:"100%",flex:"1 1 0%"},children:(0,l.jsx)(j.default,{})}),(0,l.jsx)(y.Z.Item,{name:"code_contract",label:"M\xe3 hợp đồng",rules:[{required:!0,type:"string",message:"Vui l\xf2ng nhập m\xe3 hợp đồng"}],style:{minWidth:"100%",flex:"1 1 0%"},children:(0,l.jsx)(j.default,{})}),(0,l.jsx)(y.Z.Item,{name:"price",label:"Gi\xe1 trị hợp đồng(vnđ)",style:{minWidth:"240px",flex:"1 1 0%"},children:(0,l.jsx)(v.Z,{placeholder:"Price",className:"w-full",formatter:e=>"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>null==e?void 0:e.replace(/\$\s?|(,*)/g,"")})}),(0,l.jsx)(y.Z.Item,{name:"type_contract",label:"Loại hợp đồng",style:{minWidth:"240px",flex:"1 1 0%"},children:(0,l.jsx)(s.Z,{placeholder:"Chọn loại",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,l.jsxs)(l.Fragment,{children:[e,(0,l.jsx)(f.Z,{style:{margin:"8px 0"}}),(0,l.jsx)(n.ZP,{type:"link",onClick:()=>{var e;null===(e=o.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==_?void 0:_.map(e=>(0,l.jsx)(N.W,{value:e.type_id,children:e.name_type},e.type_id))})}),(0,l.jsx)(y.Z.Item,{name:"type",label:"Loại thanh to\xe1n",rules:[{required:!0}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,l.jsxs)(s.Z,{placeholder:"Select status",children:[(0,l.jsx)(N.W,{value:"default",children:"Cố định"}),(0,l.jsx)(N.W,{value:"time",children:"Chu k\xec"})]})}),(0,l.jsx)(y.Z.Item,{name:"date_start",label:"Ng\xe0y bắt đầu",initialValue:"",className:" mb-0",style:{minWidth:"320px",flex:"1 1 0%"},getValueFromEvent:e=>null==e?void 0:e.format("YYYY-MM-DD"),getValueProps:e=>({value:e?S()(e):""}),children:(0,l.jsx)(w.default,{placeholder:"Chọn ng\xe0y bắt đầu",style:{width:"100%"}})}),(0,l.jsx)(y.Z.Item,{name:"date_expired",label:"Ng\xe0y kết th\xfac",rules:[{required:!0}],initialValue:"",className:" mb-0",style:{minWidth:"320px",flex:"1 1 0%"},getValueFromEvent:e=>null==e?void 0:e.format("YYYY-MM-DD"),getValueProps:e=>({value:e?S()(e):""}),children:(0,l.jsx)(w.default,{placeholder:"Chọn ng\xe0y kết th\xfac",style:{width:"100%"}})}),(0,l.jsx)(y.Z.Item,{name:"description",label:"M\xf4 tả",style:{width:"100%"},children:(0,l.jsx)(j.default.TextArea,{placeholder:"Description",autoSize:{minRows:3}})})]})},1)}),(0,l.jsx)("div",{className:"flex justify-end w-full mt-4",children:(0,l.jsx)(n.ZP,{type:"primary",onClick:A,children:"Chỉnh sửa"})})]}),(0,l.jsx)(h.Z,{refBtnCustomer:a}),(0,l.jsx)(u.Z,{refBtnProject:i}),(0,l.jsx)(Z.Z,{refBtnType:o})]})}var T=a(22744),F=a(99376),P=a(96473),I=a(73879),D=a(6520),R=a(3632),W=a(66789),V=a(40567);let A=e=>{let t=e.toLowerCase();return t.includes("/video/")?"Video":t.includes("/image/")?"Image":t.includes("/raw/")?"Raw":"Unknown"};var L=a(79587);let B=(0,a(30166).default)(()=>Promise.all([a.e(489),a.e(2111),a.e(3903)]).then(a.bind(a,93903)),{loadableGenerated:{webpack:()=>[93903]},ssr:!1});function E(e){let{refBtnActivity:t,ID:a}=e,{postdata:s}=(0,m.Z)(),[i,o]=(0,r.useState)(""),[d,h]=(0,r.useState)([]),[u,p]=(0,r.useState)([]),[g,y]=(0,r.useState)([]),[f,j]=(0,r.useState)(!1),v=async()=>{let e=await x.Z.getDocumentContractById(a);200===e.statusCode&&(p(e.data.filter(e=>"Image"===A(e.url)).map(e=>({uid:e.document_id,name:e.document_id,status:"done",url:e.url}))),y(e.data.filter(e=>"Raw"===A(e.url)).map(e=>({uid:e.document_id,name:e.document_id+"."+(null==e?void 0:e.type),status:"done",url:e.url}))))},w=async e=>{if(e.url)try{let t=document.createElement("a");t.href=e.url,t.click()}catch(e){console.error("Lỗi khi tải file:",e)}else console.error("URL của file kh\xf4ng tồn tại")},b=async e=>{let{file:t}=e;if((null==t?void 0:t.url)&&(null==t?void 0:t.status)==="removed")200===await s(()=>x.Z.deleteDocumentContract(t.uid))&&v();else{let e={contract:a,url:[t.originFileObj]};if(e){let t=(0,L.Z)(e);201===await s(()=>x.Z.createDocumentContract(t))&&v()}}},N=async e=>{if(e.url)try{let t=e.name.split(".").pop(),a="";"pdf"===t?a="application/pdf":"docx"===t?a="application/vnd.openxmlformats-officedocument.wordprocessingml.document":"xlsx"===t?a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"png"===t||"jpeg"===t||"jpg"===t?a="image/"+t:"mp4"===t&&(a="video/mp4"),h([{uri:e.url,fileType:a}])}catch(e){console.error("Lỗi khi tải file:",e)}else console.error("URL của file kh\xf4ng tồn tại")},C=(0,l.jsxs)("button",{style:{border:0,background:"none"},type:"button",children:[(0,l.jsx)(P.Z,{}),(0,l.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.ZP,{hidden:!!t,type:"text",className:"text-xs text-blue-600",onClick:()=>{j(!0),v()},ref:t,children:"T\xe0i liệu"}),(0,l.jsxs)(c.Z,{title:"T\xe0i liệu",open:f,className:"flex flex-col gap-4",onCancel:()=>{j(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,l.jsxs)("div",{className:"mb-2  pb-2",children:[(0,l.jsx)("div",{className:"flex items-center text-xs font-medium text-[#EB8823] hover:opacity-85 cursor-pointer mb-2",children:(0,l.jsx)("p",{className:"pointer-events-none",children:"Ảnh t\xe0i liệu"})}),(0,l.jsx)("div",{className:"!m-0 max-h-32 overflow-y-auto",style:{minWidth:"320px",flex:"1 1 0%"},children:(0,l.jsx)(V.Z,{action:"",className:"!m-0",listType:"picture-card",fileList:u.reverse(),onPreview:e=>{var t;o(null!==(t=null==e?void 0:e.url)&&void 0!==t?t:"")},onChange:e=>{b(e)},multiple:!0,children:C})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"flex items-center text-xs font-medium text-[#EB8823] hover:opacity-85 cursor-pointer mb-2",children:(0,l.jsx)("p",{className:"pointer-events-none",children:"File t\xe0i liệu"})}),(0,l.jsx)("div",{className:"!m-0 max-w-full overflow-x-auto",style:{minWidth:"320px",flex:"1 1 0%"},children:(0,l.jsx)(V.Z,{action:"",listType:"text",fileList:g,onPreview:e=>{w(e)},itemRender:(e,t)=>(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"flex-1 sm:w-96 w-12",children:e}),(0,l.jsx)(n.ZP,{type:"link",icon:(0,l.jsx)(I.Z,{}),onClick:()=>w(t),className:"flex-none w-24 text-center",children:"Download"}),(0,l.jsx)(n.ZP,{type:"link",icon:(0,l.jsx)(D.Z,{}),onClick:()=>{N(t)},className:"flex-none w-24 text-center",children:"Preview"})]}),onChange:e=>{b(e)},multiple:!0,children:(0,l.jsx)(n.ZP,{icon:(0,l.jsx)(R.Z,{}),children:"Select File"})})})]})]}),(0,l.jsx)(W.Z,{hidden:!0,preview:{visible:""!==i,onVisibleChange:()=>o("")},alt:"",src:i}),(0,l.jsx)(c.Z,{className:"!h-fit !w-fit",open:d.length>0,footer:null,onCancel:()=>{h([])},children:(0,l.jsx)("div",{className:"!w-[90vw] !h-[80vh]",children:(0,l.jsx)(B,{docs:d})})})]})}var H=a(65624);function M(){let e=(0,d.I0)(),t=(0,H.Z)(["admin-top","contract","contract-edit"]),{customerID:a}=(0,F.useParams)(),[h,u]=(0,r.useState)(25),{datas:g}=(0,d.v9)(e=>e.get_contracts);(0,r.useEffect)(()=>{a&&e((0,p.Wq)({customer:a}))},[a]);let[y,f]=(0,r.useState)([]),j=[{title:"M\xe3 hợp đồng",className:"text-xs",dataIndex:"code_contract",render:(e,a)=>(0,l.jsxs)("div",{className:"flex flex-col gap-1 ",children:[(0,l.jsx)("strong",{}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(n.ZP,{type:"text",ghost:!0,className:"text-xs text-blue-600",children:"Xem"}),t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(k,{ID:a.contract_id}),(0,l.jsx)(E,{ID:a.contract_id})]})]})]}),sorter:(e,t)=>e.contract_id.localeCompare(t.contract_id)},{title:"T\xean hợp đồng",dataIndex:"name_contract",className:"text-xs",render:e=>e||"N/A",sorter:(e,t)=>(e.name_contract||"").localeCompare(t.name_contract||"")},{title:"Kh\xe1ch h\xe0ng",dataIndex:["customer","name_company"],className:"text-xs",render:e=>e||"N/A",sorter:(e,t)=>{var a,l;return((null===(a=e.customer)||void 0===a?void 0:a.name_company)||"").localeCompare((null===(l=t.customer)||void 0===l?void 0:l.name_company)||"")}},{title:"Loại hợp đồng",dataIndex:["type_contract","name_type"],className:"text-xs",render:e=>e||"N/A",sorter:(e,t)=>{var a,l;return((null===(a=e.type_contract)||void 0===a?void 0:a.name_type)||"").localeCompare((null===(l=t.type_contract)||void 0===l?void 0:l.name_type)||"")}},{title:"Gi\xe1 trị hợp đồng",dataIndex:"price",className:"text-xs",render:e=>e?"".concat(e.toLocaleString("vi-VN"),"đ"):"N/A",sorter:(e,t)=>(e.price||0)-(t.price||0)},{title:"Ng\xe0y bắt đầu",dataIndex:"date_start",className:"text-xs",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>new Date(e.date_start||0).getTime()-new Date(t.date_start||0).getTime()},{title:"Ng\xe0y kết th\xfac",dataIndex:"date_expired",className:"text-xs",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>new Date(e.date_expired||0).getTime()-new Date(t.date_expired||0).getTime()},{title:"Trạng th\xe1i",dataIndex:"status",className:"text-xs",render:e=>(0,l.jsx)("span",{style:{color:"active"===e?"green":"hide"===e?"gray":"red"},children:"delete"===e?"X\xf3a":"active"===e?"Hoạt động":"Ẩn"}),sorter:(e,t)=>(e.status||"").localeCompare(t.status||"")}],v=e=>{f(null==g?void 0:g.filter(t=>{var a,l;return String(t.created_at+" "+t.date_expired+" "+t.date_start+" "+(null===(a=t.project)||void 0===a?void 0:a.name)+" "+t.name_contract+" "+t.contract_id+" "+(null===(l=t.customer)||void 0===l?void 0:l.name_company)+" "+t.status).toLowerCase().includes(e.toLowerCase())}))},{postdata:w}=(0,m.Z)(),[b,N]=(0,r.useState)(!1),[C,Z]=(0,r.useState)([]),_=async()=>{200===await w(()=>x.Z.deleteContract(C))&&(e((0,p.Wq)(null)),Z([]),N(!1))},S=(0,F.useSearchParams)();return(0,r.useEffect)(()=>{let e=S.get("id");g&&e?v(e):f(g.map((e,t)=>({...e,key:t})))},[g,S]),(0,l.jsxs)("div",{className:"",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)(s.Z,{defaultValue:h,style:{width:83},onChange:e=>u(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),(0,l.jsx)(n.ZP,{hidden:!(C.length>0),children:"Xuất ra"}),(0,l.jsx)(n.ZP,{onClick:()=>{N(!0)},danger:!0,hidden:!(C.length>0),className:"text-xl",icon:(0,l.jsx)(T.FH3,{})}),(0,l.jsx)(c.Z,{open:b,title:"X\xf3a dữ liệu",onOk:_,onCancel:()=>{N(!1)},children:"Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng ?"})]}),(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)(o.Z,{onChange:e=>{v(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})})]}),(0,l.jsx)("div",{className:"w-full overflow-auto",children:(0,l.jsx)("div",{className:"min-w-fit",children:(0,l.jsx)(i.Z,{columns:j,rowSelection:{onChange:(e,t)=>{Z(t.map(e=>e.contract_id))}},dataSource:y,scroll:{x:"max-content"},pagination:{pageSize:h,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showSorterTooltip:{target:"sorter-icon"}})})})]})}var Y=a(3810),z=a(49089),q=a(63302),O=a(12381),G=a(79820),X=a(93448);let K=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:t,className:(0,X.cn)("w-full caption-bottom text-sm",a),...r})})});K.displayName="Table";let U=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("thead",{ref:t,className:(0,X.cn)("[&_tr]:border-b",a),...r})});U.displayName="TableHeader";let $=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("tbody",{ref:t,className:(0,X.cn)("[&_tr:last-child]:border-0",a),...r})});$.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("tfoot",{ref:t,className:(0,X.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let J=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("tr",{ref:t,className:(0,X.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});J.displayName="TableRow";let Q=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("th",{ref:t,className:(0,X.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});Q.displayName="TableHead";let ee=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("td",{ref:t,className:(0,X.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});ee.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("caption",{ref:t,className:(0,X.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption";var et=a(69174),ea=a(61649),el=a(92735),er=a(17689),en=a(31047),es=a(18930),ec=a(30401),ei=a(49322),eo=a(51817),ed=a(92934);let eh=(0,a(90535).j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eu=r.forwardRef((e,t)=>{let{className:a,variant:r,...n}=e;return(0,l.jsx)("div",{ref:t,role:"alert",className:(0,X.cn)(eh({variant:r}),a),...n})});eu.displayName="Alert";let em=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("h5",{ref:t,className:(0,X.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})});em.displayName="AlertTitle";let ep=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("div",{ref:t,className:(0,X.cn)("text-sm [&_p]:leading-relaxed",a),...r})});ep.displayName="AlertDescription";var ex=a(40279),eg=a(75060),ey=a(71027);let ef=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(ey.fC,{ref:t,className:(0,X.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...r,children:(0,l.jsx)(ey.z$,{className:(0,X.cn)("flex items-center justify-center text-current"),children:(0,l.jsx)(ec.Z,{className:"h-4 w-4"})})})});ef.displayName=ey.fC.displayName;var ej=a(2093),ev=a(97853),ew=a.n(ev),eb=a(12);async function eN(e,t){try{if(!e||0===e.length){alert("Kh\xf4ng c\xf3 dữ liệu để xuất!");return}let a=new(ew()).Workbook,l=a.addWorksheet("DanhSachHopDong");l.addRow([]),l.mergeCells("B2:J2"),l.getCell("B2").value="DANH S\xc1CH HỢP ĐỒNG",l.getCell("B2").font={size:22,bold:!0},l.getCell("B2").alignment={horizontal:"center",vertical:"middle"},l.addRow([]),l.mergeCells("B3:J3"),l.getCell("B3").value="(*Lưu \xfd: th\xeam đ\xfang gi\xe1 trị theo cột đ\xe3 được quy định sẵn trước khi d\xf9ng import)",l.getCell("B3").font={size:14},l.getCell("B3").alignment={horizontal:"center",vertical:"middle"},l.columns=[{key:"empty",width:5},{key:"name_contract",width:30},{key:"code_contract",width:20},{key:"project",width:20},{key:"customer",width:25},{key:"price",width:15},{key:"type_contract",width:20},{key:"date_start",width:18},{key:"date_expired",width:18},{key:"description",width:35}],l.addRow(["","T\xcaN HỢP ĐỒNG","M\xc3 HỢP ĐỒNG","DỰ \xc1N","KH\xc1CH H\xc0NG","GI\xc1 TRỊ","LOẠI HỢP ĐỒNG","NG\xc0Y BẮT ĐẦU","NG\xc0Y KẾT TH\xdaC","M\xd4 TẢ"]);let r=l.getRow(4);r.font={bold:!0,color:{argb:"FFFFFF"},size:12},r.alignment={horizontal:"center",vertical:"middle"};for(let e=2;e<=10;e++){let t=r.getCell(e);t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"1BA49D"}},t.border={top:{style:"thin"},left:{style:"thin"},right:{style:"thin"},bottom:{style:"thin"}}}let n=5;e.forEach(e=>{l.addRow({empty:"",name_contract:e.name_contract,code_contract:e.code_contract,project:e.project||"",customer:e.customer,price:e.price||0,type_contract:e.type_contract||"",date_start:e.date_start||"",date_expired:e.date_expired||"",description:e.description||""});let t=l.getRow(n);t.font={size:12};for(let e=2;e<=10;e++)t.getCell(e).border={top:{style:"thin"},left:{style:"thin"},right:{style:"thin"},bottom:{style:"thin"}};n++});let s=await a.xlsx.writeBuffer();(0,eb.saveAs)(new Blob([s],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"".concat(t||"Danh_Sach_Hop_Dong_".concat(new Date().toISOString().slice(0,10),".xlsx")))}catch(e){console.error(e)}}var eC=a(45168);function eZ(){let e=(0,d.I0)(),[t,a]=(0,r.useState)([]),{datas:n}=(0,d.v9)(e=>e.infos_customer),{datas:s}=(0,d.v9)(e=>e.get_projects),[i,o]=(0,r.useState)(null),[h,u]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[y,f]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),[w,b]=(0,r.useState)("date_expired"),[N,C]=(0,r.useState)(!1),[Z,_]=(0,r.useState)(!1),[S,k]=(0,r.useState)(!1),T=async()=>{await eN([{name_contract:"C\xf4ng ty ABC",code_contract:"HĐ-01",project:"Dự \xe1n ABC",customer:"Kh\xe1ch h\xe0ng ABC",price:0,type_contract:"Hợp đồng thương mại",date_start:"8/2/2025",date_expired:"9/2/2025",description:"M\xf4 tả ABC"}],"Template mẫu hợp đồng.xlsx")},F=e=>{let t="string"==typeof e?Number.parseFloat(e):e;return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t||0)},P=async()=>{let e=h?new Date(h).getTime().toString():void 0,t=m?new Date(m).getTime().toString():void 0,a=await x.Z.getContractsFilterFull({time_start:e,time_end:t});if((null==a?void 0:a.statusCode)===200){let e=null==a?void 0:a.data;if(0===e.length){o({type:"error",message:"Khong co hop dong nao trong khoang thoi gian da chon!"});return}o({type:"success",message:"Xuat thanh cong ".concat(e.length," hop dong theo bo loc thoi gian!")}),eN(e.map(e=>{var t,a,l;return{...e,project:null===(t=s.find(t=>t.project_id===e.project))||void 0===t?void 0:t.name,customer:null===(a=n.find(t=>t.info_id===e.customer))||void 0===a?void 0:a.name_company,type_contract:null==e?void 0:null===(l=e.type_contract)||void 0===l?void 0:l.name_type}}),"Danh s\xe1ch ".concat(e.length," hợp đồng"))}},I=e=>{a(t=>t.map((t,a)=>a===e?{...t,selected:!t.selected}:t))},D=async()=>{if(0===t.filter(e=>e.selected&&!e.applied).length){o({type:"error",message:"Vui long chon it nhat mot hop dong de apply!"});return}let l=await x.Z.importContracts(t);(null==l?void 0:l.statusCode)===200&&(v(!1),C(!0),k(!1),a([]),e((0,p.Wq)(null)))},R=t.filter(e=>e.selected&&!e.applied).length,W=t.filter(e=>!e.applied).length,V=t.filter(e=>e.applied).length;return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(G.Zb,{children:[(0,l.jsxs)(G.Ol,{children:[(0,l.jsxs)(G.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(ea.Z,{className:"h-5 w-5 text-emerald-600"}),"Import / Export Excel"]}),(0,l.jsx)(G.SZ,{children:"Tải template mẫu, import danh s\xe1ch hợp đồng hoặc xuất dữ liệu ra file Excel"})]}),(0,l.jsx)(G.aY,{children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,l.jsxs)(O.zx,{onClick:T,variant:"outline",className:"gap-2 bg-transparent",children:[(0,l.jsx)(el.Z,{className:"h-4 w-4"}),"Tải template mẫu"]}),(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{var t;let l=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!l)return;let r=new FileReader;r.onload=e=>{try{var t,l,r,n,s,c,i,d,h,u,m,p;let x=null===(t=e.target)||void 0===t?void 0:t.result,g=ej.ij(x,{type:"array"}),y=g.SheetNames[0],f=g.Sheets[y],j=ej.P6.decode_range(null!==(l=f["!ref"])&&void 0!==l?l:""),v=[];for(let e=4;e<=j.e.r;e++){let t=t=>f[ej.P6.encode_cell({r:e,c:t})];if(!t(1)&&!t(2)&&!t(3)&&!t(4))continue;let a=(null===(r=t(1))||void 0===r?void 0:r.v)?String(t(1).v).trim().toLowerCase().replace(/\s+/g," "):"",l=(null===(n=t(2))||void 0===n?void 0:n.v)?String(t(2).v).trim():"",o=(null===(s=t(3))||void 0===s?void 0:s.v)?String(t(3).v).trim():"",x=(null===(c=t(4))||void 0===c?void 0:c.v)?String(t(4).v).trim():"",g=(null===(i=t(5))||void 0===i?void 0:i.v)?Number(t(5).v):0,y=(null===(d=t(6))||void 0===d?void 0:d.v)?String(t(6).v).trim():"",j=(null===(h=t(7))||void 0===h?void 0:h.w)?t(7).w:"",w=(null===(u=t(8))||void 0===u?void 0:u.w)?t(8).w:"",b=null!==(p=null===(m=t(9))||void 0===m?void 0:m.v)&&void 0!==p?p:"";v.push({name_contract:a,code_contract:l,project:o,customer:x,price:g,type_contract:y,date_start:j,date_expired:w,description:b,selected:!0,applied:!1})}let w=v.filter(e=>e.name_contract&&e.code_contract&&e.customer&&e.date_expired);if(0===w.length){o({type:"error",message:"Kh\xf4ng t\xecm thấy dữ liệu hợp lệ trong file!"});return}a(e=>[...e,...w]),o({type:"success",message:"Import th\xe0nh c\xf4ng ".concat(w.length," hợp đồng!")}),_(!0)}catch(e){console.error(e),o({type:"error",message:"Lỗi đọc file Excel — vui l\xf2ng kiểm tra lại!"})}},r.readAsArrayBuffer(l),e.target.value=""},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",id:"excel-import"}),(0,l.jsxs)(O.zx,{variant:"default",className:"gap-2 bg-emerald-600 hover:bg-emerald-700",children:[(0,l.jsx)(er.Z,{className:"h-4 w-4"}),"Import từ Excel"]})]}),(0,l.jsxs)(O.zx,{onClick:()=>{eN(t)},variant:"outline",className:"gap-2 border-blue-500 text-blue-600 hover:bg-blue-50 bg-transparent",children:[(0,l.jsx)(ea.Z,{className:"h-4 w-4"}),"Xuất Excel"]}),(0,l.jsxs)(O.zx,{variant:"outline",onClick:()=>{f(!0)},className:"gap-2 border-orange-500 text-orange-600 hover:bg-orange-50 bg-transparent",children:[(0,l.jsx)(en.Z,{className:"h-4 w-4"}),"Xuất theo thời gian"]}),t.length>0&&(0,l.jsxs)(O.zx,{onClick:()=>{a([]),o(null)},variant:"destructive",className:"gap-2 bg-red-500",children:[(0,l.jsx)(es.Z,{className:"h-4 w-4"}),"Xo\xe1 tất cả"]})]})})]}),i&&(0,l.jsxs)(eu,{variant:"success"===i.type?"default":"destructive",children:["success"===i.type?(0,l.jsx)(ec.Z,{className:"h-4 w-4"}):(0,l.jsx)(ei.Z,{className:"h-4 w-4"}),(0,l.jsx)(em,{children:"success"===i.type?"Th\xe0nh c\xf4ng":"Lỗi"}),(0,l.jsx)(ep,{children:i.message})]}),(0,l.jsxs)(G.Zb,{children:[(0,l.jsx)(G.Ol,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)(G.ll,{className:"flex items-center gap-2",children:["Danh s\xe1ch hợp đồng",t.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(et.C,{variant:"secondary",children:[t.length," hợp đồng"]}),V>0&&(0,l.jsxs)(et.C,{variant:"default",className:"bg-emerald-600",children:[V," đ\xe3 apply"]}),W>0&&(0,l.jsxs)(et.C,{variant:"outline",className:"border-amber-500 text-amber-600",children:[W," chờ duyệt"]})]})]}),(0,l.jsx)(G.SZ,{children:"Xem trước dữ liệu đ\xe3 import. Chọn c\xe1c hợp đồng cần ph\xea duyệt v\xe0 bấm Apply để lưu v\xe0o hệ thống."})]}),W>0&&(0,l.jsxs)(O.zx,{className:"gap-2 bg-blue-600 hover:bg-blue-700",onClick:()=>{v(!0)},disabled:0===R||N,children:[N?(0,l.jsx)(eo.Z,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(ed.Z,{className:"h-4 w-4"}),"Apply (",R,")"]})]})}),(0,l.jsx)(G.aY,{children:0===t.length?(0,l.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,l.jsx)(ea.Z,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,l.jsx)("p",{children:"Chưa c\xf3 dữ liệu. H\xe3y tải template mẫu v\xe0 import file Excel."})]}):(0,l.jsx)("div",{className:"overflow-x-auto rounded-lg border",children:(0,l.jsxs)(K,{children:[(0,l.jsx)(U,{children:(0,l.jsxs)(J,{className:"bg-muted/50",children:[(0,l.jsx)(Q,{className:"w-12",children:(0,l.jsx)(ef,{checked:Z,onCheckedChange:()=>{let e=!Z;_(e),a(t=>t.map(t=>t.applied?t:{...t,selected:e}))},disabled:0===W})}),(0,l.jsx)(Q,{className:"font-semibold",children:"STT"}),(0,l.jsx)(Q,{className:"font-semibold",children:"T\xean hợp đồng"}),(0,l.jsx)(Q,{className:"font-semibold",children:"M\xe3 HD"}),(0,l.jsx)(Q,{className:"font-semibold",children:"Dự \xe1n"}),(0,l.jsx)(Q,{className:"font-semibold",children:"Kh\xe1ch h\xe0ng"}),(0,l.jsx)(Q,{className:"font-semibold text-right",children:"Gi\xe1 trị"}),(0,l.jsx)(Q,{className:"font-semibold",children:"Loại HD"}),(0,l.jsx)(Q,{className:"font-semibold",children:"Ng\xe0y bắt đầu"}),(0,l.jsx)(Q,{className:"font-semibold",children:"Ng\xe0y kết th\xfac"}),(0,l.jsx)(Q,{className:"font-semibold",children:"Trạng th\xe1i"})]})}),(0,l.jsx)($,{children:t.map((e,t)=>(0,l.jsxs)(J,{className:e.applied?"bg-emerald-50":e.selected?"bg-blue-50":"",children:[(0,l.jsx)(ee,{children:(0,l.jsx)(ef,{checked:e.selected||!1,onCheckedChange:()=>I(t),disabled:e.applied})}),(0,l.jsx)(ee,{className:"font-medium",children:t+1}),(0,l.jsx)(ee,{className:"max-w-[200px] truncate",children:e.name_contract}),(0,l.jsx)(ee,{children:(0,l.jsx)(et.C,{variant:"outline",children:e.code_contract})}),(0,l.jsx)(ee,{children:e.project||"-"}),(0,l.jsx)(ee,{children:e.customer}),(0,l.jsx)(ee,{className:"text-right font-medium text-emerald-600",children:F(e.price)}),(0,l.jsx)(ee,{children:e.type_contract||"-"}),(0,l.jsx)(ee,{children:e.date_start||"-"}),(0,l.jsx)(ee,{children:e.date_expired}),(0,l.jsx)(ee,{children:e.applied?(0,l.jsxs)(et.C,{className:"bg-emerald-600",children:[(0,l.jsx)(ec.Z,{className:"h-3 w-3 mr-1"}),"Đ\xe3 apply"]}):(0,l.jsx)(et.C,{variant:"outline",className:"border-amber-500 text-amber-600",children:"Chờ duyệt"})})]},t))})]})})})]}),(0,l.jsxs)(c.Z,{title:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,l.jsx)(eC.xAl,{}),"Xuất hợp đồng theo thời gian"]}),open:y,onCancel:()=>{f(!1)},footer:[(0,l.jsx)(O.zx,{onClick:()=>{f(!1)},children:"Hủy"},"cancel"),(0,l.jsx)(O.zx,{onClick:()=>{P(),f(!1)},style:{backgroundColor:"#ea580c",borderColor:"#ea580c"},children:"Xuất Excel"},"export")],children:[(0,l.jsx)("p",{style:{marginTop:8,color:"#666"},children:"Chọn khoảng thời gian để lọc v\xe0 xuất c\xe1c hợp đồng."}),(0,l.jsxs)("div",{className:"space-y-4 py-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(eg._,{htmlFor:"date-from",children:"Từ ng\xe0y"}),(0,l.jsx)(ex.I,{id:"date-from",type:"date",value:h,onChange:e=>u(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(eg._,{htmlFor:"date-to",children:"Đến ng\xe0y"}),(0,l.jsx)(ex.I,{id:"date-to",type:"date",value:m,onChange:e=>g(e.target.value)})]})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:"Để trống nếu kh\xf4ng muốn giới hạn ng\xe0y bắt đầu hoặc kết th\xfac"})]})]}),(0,l.jsxs)(c.Z,{open:j,onCancel:()=>{v(!1)},footer:[(0,l.jsx)(O.zx,{onClick:()=>{v(!1)},children:"Hủy"},"cancel"),(0,l.jsxs)(O.zx,{onClick:D,style:{backgroundColor:"#2563eb",borderColor:"#2563eb"},children:[N?(0,l.jsx)(eo.Z,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(ed.Z,{className:"h-4 w-4"}),"X\xe1c nhận Apply(",R,")"]},"apply")],title:"X\xe1c nhận Apply hợp đồng",children:[(0,l.jsxs)("p",{children:["Bạn c\xf3 chắc chắn muốn apply ",R," hợp đồng đ\xe3 chọn v\xe0o hệ thống database?"]}),(0,l.jsxs)("div",{style:{background:"#f5f5f5",padding:16,marginTop:16,borderRadius:8},children:[(0,l.jsx)("p",{style:{fontWeight:500},children:"Th\xf4ng tin apply:"}),(0,l.jsxs)("ul",{style:{marginTop:8,paddingLeft:16,color:"#555"},children:[(0,l.jsxs)("li",{children:["• Số hợp đồng sẽ apply:"," ",(0,l.jsx)("span",{style:{fontWeight:600,color:"#000"},children:R})]}),(0,l.jsx)("li",{children:"• C\xe1c hợp đồng đ\xe3 apply trước đ\xf3 sẽ kh\xf4ng bị ảnh hưởng"}),(0,l.jsx)("li",{children:"• Dữ liệu sẽ được lưu v\xe0o hệ thống database"})]})]})]})]})}var e_=a(67776);function eS(e){let{refBtnImport:t}=e,[a,s]=(0,r.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.ZP,{hidden:!!t,className:"bg-blue-400 border-0 text-white font-semibold",icon:(0,l.jsx)(e_.Fb$,{}),onClick:()=>{s(!0)},ref:t}),(0,l.jsx)(c.Z,{title:"Quản l\xfd hợp đồng",open:a,onCancel:()=>{s(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:(0,l.jsx)(eZ,{})})]})}function ek(){let{datas:e}=(0,d.v9)(e=>e.get_contract_about),{customerID:t}=(0,F.useParams)();return(0,l.jsxs)("div",{className:"flex items-start gap-4 w-full flex-col",children:[(0,l.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[(0,l.jsx)(q.Z,{}),(0,l.jsx)(Z.Z,{}),(0,l.jsx)(eS,{}),(0,l.jsx)(n.ZP,{icon:(0,l.jsx)(z.yQE,{}),hidden:!!t})]}),(0,l.jsxs)("div",{className:"w-full",hidden:!!t,children:[(0,l.jsx)("h2",{className:"font-semibold text-[#1BA399]",children:"Tổng quan hợp đồng"}),(0,l.jsxs)("div",{className:"flex justify-around gap-2 flex-wrap",children:[(0,l.jsxs)(Y.Z,{className:"lex flex-col pl-4 pt-8 rounded-lg gap-2 min-w-fit flex-1 h-32 border-0 shadow-lg shadow-black/20 bg-[#EB8823]",children:[(0,l.jsx)("p",{className:"font-bold text-3xl text-white",children:null==e?void 0:e.contractTotal.toLocaleString("vi-VN")}),(0,l.jsx)("p",{className:"text-xs text-wrap text-slate-50/80 min-w-36",children:"Tổng số hợp đồng"})]}),(0,l.jsxs)(Y.Z,{className:"lex flex-col pl-4 pt-8 rounded-lg gap-2 min-w-fit flex-1 h-32 bg-[#EB8823] border-0 shadow-lg  shadow-black/20",children:[(0,l.jsx)("p",{className:"font-bold text-3xl text-white",children:null==e?void 0:e.contractActive.toLocaleString("vi-VN")}),(0,l.jsx)("p",{className:"text-xs text-wrap text-slate-50/80 min-w-36",children:"Đang hoạt động"})]}),(0,l.jsxs)(Y.Z,{className:"lex flex-col pl-4 pt-8 rounded-lg gap-2 min-w-fit flex-1 h-32 bg-[#EB8823] border-0 shadow-lg  shadow-black/20",children:[(0,l.jsx)("p",{className:"font-bold text-3xl text-white",children:null==e?void 0:e.contractReadyExpired.toLocaleString("vi-VN")}),(0,l.jsx)("p",{className:"text-xs text-wrap text-slate-50/80 min-w-36",children:"Sắp hết hạn"})]}),(0,l.jsxs)(Y.Z,{className:"lex flex-col pl-4 pt-8 rounded-lg gap-2 min-w-fit flex-1 h-32 bg-[#EB8823] border-0 shadow-lg  shadow-black/20",children:[(0,l.jsx)("p",{className:"font-bold text-3xl text-white",children:null==e?void 0:e.contractExpired.toLocaleString("vi-VN")}),(0,l.jsx)("p",{className:"text-xs text-wrap text-slate-50/80 min-w-36",children:"Hết hạn"})]})]})]})]})}var eT=a(53408);function eF(){let[e,t]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(async()=>{let e=await x.Z.getTypeFullContracts();200===e.statusCode&&t(e.data.map(e=>{var t,a,l;return{type:null!==(a=e.name_type)&&void 0!==a?a:"",value:null!==(l=null===(t=e.contracts)||void 0===t?void 0:t.length)&&void 0!==l?l:0}}))})()},[]),(0,l.jsxs)("div",{className:"sm:px-4 py-4 flex flex-col gap-4 max-w-full",children:[(0,l.jsx)("p",{className:"p-4 text-xl font-semibold",children:"Hợp đồng theo loại"}),(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)(()=>(0,l.jsx)(eT.Z,{data:e,xField:"type",yField:"value",style:{fill:()=>"#2989FF"},xAxis:{label:{style:{fill:"#FF0000",rotate:Math.PI/4}}},legend:!1}),{})})]})}var eP=a(16556);function eI(){let[e,t]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(async()=>{let e=await x.Z.getTypeFullContracts();200===e.statusCode&&t(e.data.map(e=>{var t,a,l;return{type:null!==(a=e.name_type)&&void 0!==a?a:"",value:null!==(l=null===(t=e.contracts)||void 0===t?void 0:t.reduce((e,t)=>{var a;return e+(null!==(a=t.price)&&void 0!==a?a:0)},0))&&void 0!==l?l:0}}))})()},[]),(0,l.jsxs)("div",{className:"p-4 flex flex-col gap-4 max-w-full",children:[(0,l.jsx)("p",{className:"p-4 text-xl font-semibold",children:"Hợp đồng theo loại"}),(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)(()=>(0,l.jsx)(eP.Z,{data:e,xField:"type",yField:"value",style:{fill:()=>"#2989FF"},xAxis:{label:{style:{fill:"#FF0000",rotate:Math.PI/4}}},legend:!1}),{})})]})}function eD(){return(0,l.jsxs)("div",{className:"flex w-full flex-wrap shadow-[0_8px_30px_rgb(0,0,0,0.12)]",children:[(0,l.jsx)("div",{className:"flex-1 min-w-80",children:(0,l.jsx)(eF,{})}),(0,l.jsx)("div",{className:"flex-1 min-w-80",children:(0,l.jsx)(eI,{})})]})}function eR(){let{customerID:e}=(0,F.useParams)(),t=(0,H.Z)(["admin-top","contract","contract-edit"]);return(0,l.jsxs)("div",{className:"flex flex-col gap-4 rounded-md p-4 shadow-[0_8px_30px_rgb(0,0,0,0.12)] bg-white",children:[t&&(0,l.jsx)("div",{className:"rounded-md",children:(0,l.jsx)(ek,{})}),!e&&(0,l.jsx)("div",{className:"flex",hidden:!!e,children:(0,l.jsx)(eD,{})}),(0,l.jsx)("div",{className:"rounded-md",children:(0,l.jsx)(M,{})})]})}},63302:function(e,t,a){"use strict";a.d(t,{Z:function(){return k}});var l=a(57437),r=a(4599),n=a(17166),s=a(46475),c=a(2950),i=a(70601),o=a(91626),d=a(58970),h=a(42654),u=a(44967),m=a(11632),p=a(23496),x=a(16836),g=a(90136),y=a(56612),f=a(29487),j=a(45747),v=a(7140),w=a(2265),b=a(32768),N=a(68575),C=a(1329),Z=a(71096),_=a.n(Z),S=a(99376);function k(e){let{refBtnContract:t}=e,{customerID:a}=(0,S.useParams)(),Z=(0,S.useSearchParams)(),k=(0,w.useRef)(),T=(0,w.useRef)(),F=(0,w.useRef)(),{datas:P}=(0,N.v9)(e=>e.get_type_contract),{datas:I}=(0,N.v9)(e=>e.infos_customer),{datas:D}=(0,N.v9)(e=>e.get_projects);(0,w.useEffect)(()=>{a&&R.setFieldValue("customer",a)},[a]),(0,w.useEffect)(()=>{if(Z){let e=Z.get("customer"),t=Z.get("project");e&&R.setFieldValue("customer",e),t&&R.setFieldValue("project",t)}},[Z]);let[R]=(0,f.Z)(),{postdata:W}=(0,s.Z)(),V=(0,N.I0)(),[A,L]=(0,w.useState)(!1),B=async e=>{let t=await W(()=>i.Z.createContract(e));(200===t||201===t)&&(V((0,c.Wq)(a?{customer:a}:null)),L(!1))},E=async()=>{R.submit()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.ZP,{hidden:!!t,className:"bg-blue-400 border-0 text-white font-semibold",icon:(0,l.jsx)(b.b0B,{}),onClick:()=>{L(!0)},ref:t,children:"Th\xeam hợp đồng"}),(0,l.jsxs)(d.Z,{title:"Tạo hợp đồng",open:A,onCancel:()=>{L(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,l.jsx)(h.Z,{defaultActiveKey:"1",style:{width:"100%"},type:"line",children:(0,l.jsx)(v.Z,{tab:"Th\xf4ng tin hợp đồng",children:(0,l.jsxs)(u.Z,{layout:"vertical",form:R,onFinish:B,style:{display:"flex",flexWrap:"wrap",columnGap:"12px"},children:[(0,l.jsx)(u.Z.Item,{name:"customer",label:"Kh\xe1ch h\xe0ng",rules:[{required:!0,message:"Vui l\xf2ng chọn kh\xe1ch h\xe0ng!"}],style:{width:"100%",flex:"1 1 0%"},children:(0,l.jsx)(m.Z,{placeholder:"Chọn kh\xe1ch h\xe0ng",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,l.jsxs)(l.Fragment,{children:[e,(0,l.jsx)(p.Z,{style:{margin:"8px 0"}}),(0,l.jsx)(o.ZP,{type:"link",onClick:()=>{var e;null===(e=k.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==I?void 0:I.map(e=>(0,l.jsx)(j.W,{value:e.info_id,children:e.name_company},e.info_id))})}),(0,l.jsx)(u.Z.Item,{name:"project",label:"Dự \xe1n",style:{width:"100%",flex:"1 1 0%"},children:(0,l.jsx)(m.Z,{placeholder:"Chọn dự \xe1n",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,l.jsxs)(l.Fragment,{children:[e,(0,l.jsx)(p.Z,{style:{margin:"8px 0"}}),(0,l.jsx)(o.ZP,{type:"link",onClick:()=>{var e;null===(e=T.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==D?void 0:D.map(e=>(0,l.jsx)(j.W,{value:e.project_id,children:e.name},e.project_id))})}),(0,l.jsx)(u.Z.Item,{name:"name_contract",label:"T\xean hợp đồng",rules:[{required:!0,type:"string",message:"Vui l\xf2ng nhập t\xean hợp đồng"}],style:{minWidth:"100%",flex:"1 1 0%"},children:(0,l.jsx)(x.default,{})}),(0,l.jsx)(u.Z.Item,{name:"code_contract",label:"M\xe3 hợp đồng",rules:[{required:!0,type:"string",message:"Vui l\xf2ng nhập m\xe3 hợp đồng"}],style:{minWidth:"100%",flex:"1 1 0%"},children:(0,l.jsx)(x.default,{})}),(0,l.jsx)(u.Z.Item,{name:"price",label:"Gi\xe1 trị hợp đồng(vnđ)",style:{minWidth:"240px",flex:"1 1 0%"},children:(0,l.jsx)(g.Z,{placeholder:"Price",className:"w-full",formatter:e=>"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>null==e?void 0:e.replace(/\$\s?|(,*)/g,"")})}),(0,l.jsx)(u.Z.Item,{name:"type_contract",label:"Loại hợp đồng",style:{minWidth:"240px",flex:"1 1 0%"},children:(0,l.jsx)(m.Z,{placeholder:"Chọn loại",showSearch:!0,filterOption:(e,t)=>{var a;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(a=null==t?void 0:t.children)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,l.jsxs)(l.Fragment,{children:[e,(0,l.jsx)(p.Z,{style:{margin:"8px 0"}}),(0,l.jsx)(o.ZP,{type:"link",onClick:()=>{var e;null===(e=F.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==P?void 0:P.map(e=>(0,l.jsx)(j.W,{value:e.type_id,children:e.name_type},e.type_id))})}),(0,l.jsx)(u.Z.Item,{name:"type",label:"Loại thanh to\xe1n",rules:[{required:!0}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,l.jsxs)(m.Z,{placeholder:"Select status",children:[(0,l.jsx)(j.W,{value:"default",children:"Cố định"}),(0,l.jsx)(j.W,{value:"time",children:"Chu k\xec"})]})}),(0,l.jsx)(u.Z.Item,{name:"date_start",label:"Ng\xe0y bắt đầu",initialValue:"",className:" mb-0",style:{minWidth:"320px",flex:"1 1 0%"},getValueFromEvent:e=>null==e?void 0:e.format("YYYY-MM-DD"),getValueProps:e=>({value:e?_()(e):""}),children:(0,l.jsx)(y.default,{placeholder:"Chọn ng\xe0y bắt đầu",style:{width:"100%"}})}),(0,l.jsx)(u.Z.Item,{name:"date_expired",label:"Ng\xe0y kết th\xfac",rules:[{required:!0}],initialValue:"",className:" mb-0",style:{minWidth:"320px",flex:"1 1 0%"},getValueFromEvent:e=>null==e?void 0:e.format("YYYY-MM-DD"),getValueProps:e=>({value:e?_()(e):""}),children:(0,l.jsx)(y.default,{placeholder:"Chọn ng\xe0y kết th\xfac",style:{width:"100%"}})}),(0,l.jsx)(u.Z.Item,{name:"description",label:"M\xf4 tả",style:{width:"100%"},children:(0,l.jsx)(x.default.TextArea,{placeholder:"Description",autoSize:{minRows:3}})})]})},1)}),(0,l.jsx)("div",{className:"flex justify-end w-full mt-4",children:(0,l.jsx)(o.ZP,{type:"primary",onClick:E,children:"Tạo"})})]}),(0,l.jsx)(r.Z,{refBtnCustomer:k}),(0,l.jsx)(n.Z,{refBtnProject:T}),(0,l.jsx)(C.Z,{refBtnType:F})]})}},1329:function(e,t,a){"use strict";var l=a(57437),r=a(2265),n=a(91626),s=a(58970),c=a(44967),i=a(16836),o=a(91250),d=a(46475),h=a(29487),u=a(94295),m=a(67776),p=a(68575),x=a(70601),g=a(29387),y=a(2950);t.Z=e=>{let{refBtnType:t}=e,[a,f]=(0,r.useState)(!1),[j,v]=(0,r.useState)(-1),w=(0,p.I0)(),{datas:b}=(0,p.v9)(e=>e.get_type_contract),N=e=>{v(e),k.setFieldsValue(null==b?void 0:b[e])},[C,Z]=(0,r.useState)(!1),{postdata:_}=(0,d.Z)(),[S]=(0,h.Z)(),[k]=(0,h.Z)(),[T,F]=(0,r.useState)(""),P=async()=>{200===await _(()=>x.Z.deleteTypeContract([null!=T?T:""]))&&(w((0,g.eV)()),F(""))},I=async e=>{try{let t=await _(()=>x.Z.createTypeContract(e));201===t&&(w((0,g.eV)()),S.resetFields(),Z(!1))}catch(e){console.error("Error creating product:",e)}},D=async e=>{try{let t=await _(()=>{var t;return x.Z.updateTypeContract(null!==(t=null==b?void 0:b[null!=j?j:0].type_id)&&void 0!==t?t:"",e)});200===t&&(w((0,g.eV)()),w((0,y.Wq)(null)),v(-1))}catch(e){console.error("Error creating product:",e)}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.ZP,{hidden:!!t,className:"bg-blue-400 border-0 text-white font-semibold",onClick:()=>{f(!0)},ref:t,children:"Loại hợp đồng"}),(0,l.jsx)(s.Z,{title:(0,l.jsxs)("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[(0,l.jsx)("span",{children:"Loại hợp đồng"}),(0,l.jsx)(n.ZP,{className:"text-white font-semibold bg-orange-500",icon:(0,l.jsx)(u.gyF,{}),type:"default",onClick:()=>{S.resetFields(),Z(!C)}})]}),open:a,onCancel:()=>{f(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsx)("div",{className:"bg-slate-200 px-1 py-2 rounded-md",hidden:!C,children:(0,l.jsxs)(c.Z,{form:S,onFinish:I,style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,l.jsx)(c.Z.Item,{name:"name_type",rules:[{required:!0,message:"Vui l\xf2ng nhập t\xean loại"}],style:{flex:"1 1 0%",margin:"0"},children:(0,l.jsx)(i.default,{placeholder:"Nhập t\xean loại"})}),(0,l.jsx)(c.Z.Item,{style:{display:"flex",justifyContent:"end",margin:"0"},children:(0,l.jsx)(n.ZP,{className:"bg-green-500 text-white font-semibold",onClick:()=>{S.submit()},children:"Th\xeam"})})]})}),(0,l.jsx)("div",{className:"bg-slate-200 px-1 py-2 rounded-md",hidden:!(j>-1),children:(0,l.jsxs)(c.Z,{form:k,onFinish:D,style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,l.jsx)(c.Z.Item,{name:"name_type",rules:[{required:!0,message:"Vui l\xf2ng nhập t\xean loại"}],style:{flex:"1 1 0%",margin:"0"},children:(0,l.jsx)(i.default,{placeholder:"Nhập t\xean loại"})}),(0,l.jsxs)(c.Z.Item,{style:{display:"flex",gap:"2px",justifyContent:"end",margin:"0"},children:[(0,l.jsx)(n.ZP,{className:"bg-yellow-500 text-white font-semibold",htmlType:"submit",children:"Cập nhật"}),(0,l.jsx)(n.ZP,{className:"bg-red-500 text-white font-semibold",onClick:()=>{v(-1)},children:"Huỷ"})]})]})}),(0,l.jsx)("div",{className:"border-t-2 w-full overflow-x-auto",children:(0,l.jsx)("div",{className:"w-full",children:(0,l.jsx)(o.Z,{columns:[{title:"M\xe3 loại",dataIndex:"type_id",key:"type_id",render:(e,t,a)=>(0,l.jsxs)("div",{className:"flex gap-1 items-center",children:["#",a+1,".",e]})},{title:"T\xean loại",dataIndex:"name_type",width:"50%",key:"name_type",render:(e,t,a)=>(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("strong",{className:"flex gap-2 items-center",children:[e,(0,l.jsx)(n.ZP,{type:"link",onClick:()=>{N(a)},icon:(0,l.jsx)(m.FNg,{})}),(0,l.jsx)(n.ZP,{className:"  text-xs text-red-500 font-semibold",type:"text",onClick:()=>{var e;return F(null!==(e=null==t?void 0:t.type_id)&&void 0!==e?e:"")},children:"X\xf3a"})]})})}],scroll:{x:"max-content"},className:"custom-table",dataSource:b,pagination:{pageSize:10,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showSorterTooltip:{target:"sorter-icon"}})})})]})}),(0,l.jsx)(s.Z,{open:""!==T,title:"X\xf3a dữ liệu",onOk:P,onCancel:()=>{F("")},children:"Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng ?"})]})}},40279:function(e,t,a){"use strict";a.d(t,{I:function(){return s}});var l=a(57437),r=a(2265),n=a(93448);let s=r.forwardRef((e,t)=>{let{className:a,type:r,...s}=e;return(0,l.jsx)("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...s})});s.displayName="Input"},2950:function(e,t,a){"use strict";a.d(t,{Wq:function(){return n}});var l=a(20301),r=a(70601);let n=(0,l.hg)("contract/fetchContracts",async(e,t)=>{try{if(e)return await r.Z.getYearContracts(e);return await r.Z.getContracts()}catch(e){return t.rejectWithValue("Failed to fetch contracts")}}),s=(0,l.hg)("contract/createContract",async(e,t)=>{try{return await r.Z.createContract(e)}catch(e){return t.rejectWithValue("Failed to create contract")}}),c=(0,l.hg)("contract/updateContract",async(e,t)=>{let{id:a,data:l}=e;try{return await r.Z.updateContract(a,l)}catch(e){return t.rejectWithValue("Failed to update contract")}}),i=(0,l.oM)({name:"contract",initialState:{datas:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.datas=t.payload.data}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(s.fulfilled,(e,t)=>{e.datas.push(t.payload.data)}).addCase(c.fulfilled,(e,t)=>{let a=e.datas.findIndex(e=>e.contract_id===t.payload.data.contract_id);-1!==a&&(e.datas[a]=t.payload.data)})}}).reducer;t.ZP=i},29387:function(e,t,a){"use strict";a.d(t,{eV:function(){return n}});var l=a(20301),r=a(70601);let n=(0,l.hg)("typeContract/fetchTypeContracts",async(e,t)=>{try{return await r.Z.getTypeContracts()}catch(e){return t.rejectWithValue("Failed to fetch type contracts")}}),s=(0,l.hg)("typeContract/createTypeContract",async(e,t)=>{try{return await r.Z.createTypeContract(e)}catch(e){return t.rejectWithValue("Failed to create type contract")}}),c=(0,l.hg)("typeContract/updateTypeContract",async(e,t)=>{let{id:a,data:l}=e;try{return await r.Z.updateTypeContract(a,l)}catch(e){return t.rejectWithValue("Failed to update type contract")}}),i=(0,l.oM)({name:"typeContract",initialState:{datas:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(n.pending,e=>{e.loading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.loading=!1,e.datas=t.payload.data}).addCase(n.rejected,(e,t)=>{e.loading=!1,e.error=t.payload}).addCase(s.fulfilled,(e,t)=>{e.datas.push(t.payload.data)}).addCase(c.fulfilled,(e,t)=>{let a=e.datas.findIndex(e=>e.type_id===t.payload.data.type_id);-1!==a&&(e.datas[a]=t.payload.data)})}}).reducer;t.ZP=i},70601:function(e,t,a){"use strict";var l=a(28223),r=a(90382);t.Z={getContracts:async()=>{try{return(await l.Z.get("/contract/all")).data}catch(e){throw(0,r.S)(e),e}},getContractAbout:async()=>{try{return(await l.Z.get("/contract/about")).data}catch(e){throw(0,r.S)(e),e}},getYearContracts:async e=>{try{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,l]=e;null!=l&&t.append(a,l.toString())}),(await l.Z.get("/contract/all/filter?".concat(t.toString()))).data}catch(e){throw(0,r.S)(e),e}},getContract:async e=>{try{return(await l.Z.get("/contract/id/".concat(e))).data}catch(e){throw(0,r.S)(e),e}},createContract:async e=>{try{return(await l.Z.post("/contract/create",e)).data}catch(e){throw(0,r.S)(e),e}},deleteContract:async e=>{try{return(await l.Z.delete("/contract",{data:e})).data}catch(e){throw(0,r.S)(e),e}},deleteTypeContract:async e=>{try{return(await l.Z.delete("/contract/type-contract",{data:e})).data}catch(e){throw(0,r.S)(e),e}},updateContract:async(e,t)=>{try{return(await l.Z.put("/contract/update/".concat(e),t)).data}catch(e){throw(0,r.S)(e),e}},getTypeContracts:async()=>{try{return(await l.Z.get("/contract/type-contract")).data}catch(e){throw(0,r.S)(e),e}},getTypeFullContracts:async()=>{try{return(await l.Z.get("/contract/full-type-contract")).data}catch(e){throw(0,r.S)(e),e}},getFullContractDashboard:async()=>{try{return(await l.Z.get("/contract/dashboard")).data}catch(e){throw(0,r.S)(e),e}},getContractDashboardByProject:async e=>{try{return(await l.Z.get("/contract/dashboard-by-project/".concat(e))).data}catch(e){throw(0,r.S)(e),e}},getDebtSupplier:async()=>{try{return(await l.Z.get("/contract/debt-supplier")).data}catch(e){throw(0,r.S)(e),e}},getPaymentContractDashboard:async()=>{try{return(await l.Z.get("/contract/payment-contract-dashboard")).data}catch(e){throw(0,r.S)(e),e}},getPaymentExpiredCustomer:async()=>{try{return(await l.Z.get("/contract/payment-expired-customer")).data}catch(e){throw(0,r.S)(e),e}},getPaymentReadyCustomer:async()=>{try{return(await l.Z.get("/contract/payment-ready-customer")).data}catch(e){throw(0,r.S)(e),e}},getPaymentReadySupplier:async()=>{try{return(await l.Z.get("/contract/payment-ready-supplier")).data}catch(e){throw(0,r.S)(e),e}},getRevenueTotal:async()=>{try{return(await l.Z.get("/contract/revenue-total-contract")).data}catch(e){throw(0,r.S)(e),e}},getYearCurrentContracts:async()=>{try{return(await l.Z.get("/contract/current-year")).data}catch(e){throw(0,r.S)(e),e}},getFullContractByTypeID:async e=>{try{return(await l.Z.get("/contract/contract-by-type-id/".concat(e))).data}catch(e){throw(0,r.S)(e),e}},createTypeContract:async e=>{try{return(await l.Z.post("/contract/type-contract",e)).data}catch(e){throw(0,r.S)(e),e}},updateTypeContract:async(e,t)=>{try{return(await l.Z.put("/contract/type-contract/".concat(e),t)).data}catch(e){throw(0,r.S)(e),e}},createPayment:async e=>{try{return(await l.Z.post("/contract/payment",e)).data}catch(e){throw(0,r.S)(e),e}},deletePayment:async e=>{try{return(await l.Z.delete("/contract/payment",{data:e})).data}catch(e){throw(0,r.S)(e),e}},updatePayment:async(e,t)=>{try{return(await l.Z.put("/contract/payment/".concat(e),t)).data}catch(e){throw(0,r.S)(e),e}},getPaymentByProject:async e=>{try{return(await l.Z.get("/contract/payment-by-project/".concat(e))).data}catch(e){throw(0,r.S)(e),e}},getAllPayments:async e=>{try{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,l]=e;null!=l&&t.append(a,l.toString())}),(await l.Z.get("/contract/payment?".concat(t.toString()))).data}catch(e){throw(0,r.S)(e),e}},createTypeMethod:async e=>{try{return(await l.Z.post("/contract/type-method",e)).data}catch(e){throw(0,r.S)(e),e}},updateTypeMethod:async(e,t)=>{try{return(await l.Z.put("/contract/type-method/".concat(e),t)).data}catch(e){throw(0,r.S)(e),e}},getAllTypeMethods:async()=>{try{return(await l.Z.get("/contract/type-method")).data}catch(e){throw(0,r.S)(e),e}},getDocumentContractById:async e=>{try{return(await l.Z.get("/contract/document/all/".concat(e))).data}catch(e){throw(0,r.S)(e),e}},createDocumentContract:async e=>{try{return(await l.Y.post("/contract/document/create",e)).data}catch(e){throw(0,r.S)(e),e}},deleteDocumentContract:async e=>{try{return(await l.Z.delete("/contract/document/delete?id=".concat(e))).data}catch(e){throw(0,r.S)(e),e}},getContractsFilterbyProject:async e=>{try{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,l]=e;null!=l&&t.append(a,l.toString())}),(await l.Z.get("/contract/get-contract-filter-by-project?".concat(t.toString()))).data}catch(e){throw(0,r.S)(e),e}},getContractsFilterFull:async e=>{try{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,l]=e;null!=l&&t.append(a,l.toString())}),(await l.Z.get("/contract/get-contracts-filter-full?".concat(t.toString()))).data}catch(e){throw(0,r.S)(e),e}},importContracts:async e=>{try{return(await l.Z.post("/contract/import",e)).data}catch(e){throw(0,r.S)(e),e}}}}}]);