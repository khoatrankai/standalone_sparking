"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7496],{14687:function(e,t,l){l.d(t,{Z:function(){return U}});var i=l(57437),n=l(2265),a=l(11632),s=l(91626),r=l(58970),d=l(91250),o=l(56771),c=l(68575),u=l(67545),x=l(46475),m=l(24307),h=l(11265),v=l(22744),p=l(99376),f=l(96473),j=l(42654),y=l(87863),g=l(89970),w=l(44967),_=l(16836),Z=l(23496),C=l(56612),N=l(3810),b=l(20347),k=l(29487),S=l(45747),A=l(7140),I=l(20184),T=l(85299),L=l(20001),P=l(94295),E=l(79587),W=l(27929),D=l(63302),B=l(60792),F=l(45407),R=l(83458),V=l(21544),M=l(71096),O=l.n(M),Y=l(15162),H=l(16114);function q(e){var t,l;let{ID:d,idType:o,type:u,refBtn:v,setID:p,fetchData:M}=e,q=(0,n.useRef)(),z=(0,n.useRef)(),G=(0,n.useRef)(),K=(0,n.useRef)(),X=(0,n.useRef)(),$=(0,n.useRef)(),[Q,U]=(0,n.useState)(""),{datas:J}=(0,c.v9)(e=>e.get_type_activities),{datas:ee}=(0,c.v9)(e=>e.get_users),{datas:et}=(0,c.v9)(e=>e.get_type_work),[el,ei]=(0,n.useState)([]),[en]=(0,k.Z)(),[ea]=(0,k.Z)(),{postdata:es}=(0,x.Z)(),er=(0,c.I0)(),[ed,eo]=(0,n.useState)([]),[ec,eu]=(0,n.useState)(!1),[ex,em]=(0,n.useState)(!1),[eh,ev]=(0,n.useState)([]),[ep,ef]=(0,n.useState)(!1),[ej,ey]=(0,n.useState)([]),[eg,ew]=(0,n.useState)(""),[e_,eZ]=(0,n.useState)(""),[eC,eN]=(0,n.useState)([]),[eb,ek]=(0,n.useState)(-1),eS=async()=>{let e=await m.Z.getActivityById(d);if(200===e.statusCode){var t,l,i;let n=e.data;en.setFieldsValue(n),eo(null!==(l=null===(t=n.picture_urls)||void 0===t?void 0:t.map(e=>({uid:e.picture_id,name:e.type,status:"done",url:e.url})))&&void 0!==l?l:[]),ew(e.data.type),ev(null!==(i=null==n?void 0:n.works)&&void 0!==i?i:[])}},eA=async e=>{201===await es(()=>m.Z.createWork({...e,activity:d,list_users:ej}))&&(ef(!ep),ey([]),ea.resetFields(),eS(),er((0,h.ij)({})),M&&M())};(0,n.useEffect)(()=>{if(eg){var e,t;eN(null!==(t=null===(e=J.find(e=>e.type_activity_id===eg))||void 0===e?void 0:e.status)&&void 0!==t?t:[])}},[eg]),(0,n.useEffect)(()=>{eC.length>0&&ek(eC.findIndex(e=>e.status_activity_id===en.getFieldValue("status")))},[en,eC]),(0,n.useEffect)(()=>{ee&&ei(ee.map(e=>({label:e.first_name+" "+e.last_name,value:e.user_id})))},[ee]);let eI=async e=>{200===await es(()=>m.Z.updateStatus(d,{status:e}))&&(eS(),er((0,h.ij)({})),ek(eC.findIndex(t=>t.status_activity_id===e)))},eT=async(e,t)=>{let{file:l}=e;if((null==l?void 0:l.url)&&(null==l?void 0:l.status)==="removed")200===await es(()=>m.Z.deletePictureActivity(l.uid))&&(eS(),"schedule"===u&&er((0,W.N)(o)));else{let e={activity:d,url:[l.originFileObj],type:t?"start":"end"};if(e){let t=(0,E.Z)(e);201===await es(()=>m.Z.createPictureActivity(t))&&(eS(),"schedule"===u&&er((0,W.N)(o)))}}};(0,n.useEffect)(()=>{if(""!==Q){var e;null===(e=$.current)||void 0===e||e.click()}},[Q]);let eL=(0,i.jsxs)("button",{style:{border:0,background:"none"},type:"button",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.ZP,{hidden:!!u,className:"  text-xs text-yellow-500 font-semibold",type:"text",ref:v,onClick:()=>{eu(!0),eS()},children:"Chỉnh sửa c\xf4ng việc"}),(0,i.jsx)(r.Z,{title:"Cập nhật tiến độ c\xf4ng việc",open:ec,onCancel:()=>{eu(!1),p&&p("")},footer:null,width:"100%",style:{maxWidth:"800px"},children:(0,i.jsx)(j.Z,{defaultActiveKey:"1",style:{width:"100%"},type:"line",children:(0,i.jsxs)(A.Z,{tab:"Trạng th\xe1i c\xf4ng việc",children:[(0,i.jsx)("div",{hidden:!!u,children:(0,i.jsx)(I.Z,{alternativeLabel:!0,activeStep:eb,children:eC.map((e,t)=>(0,i.jsx)(T.Z,{children:(0,i.jsx)(L.Z,{sx:{"& .MuiStepLabel-label":{color:t===eb?"#00A9AE":"gray !important"},"& .MuiStepIcon-root":{color:t===eb?"#00A9AE !important":"gray !important"},"& .Mui-active":{color:"#00A9AE !important"},"& .Mui-completed":{color:"#00A9AE !important"}},className:t>eb?"!cursor-pointer":"pointer-events-none",onClick:()=>{eI(e.status_activity_id)},children:(0,i.jsx)("p",{className:"text-sm cursor-pointer",children:e.name})})},e.status_activity_id))})}),(0,i.jsxs)("div",{className:"border-y-[1px] py-4 my-2 flex flex-col gap-2",children:[(0,i.jsxs)("div",{className:"flex items-center text-xs font-medium text-[#EB8823] hover:opacity-85 cursor-pointer",onClick:()=>{ef(!ep)},children:[(0,i.jsx)(P.S$f,{}),(0,i.jsx)("p",{className:"pointer-events-none",children:"Th\xeam c\xf4ng việc"})]}),(0,i.jsxs)("div",{className:"hover:border-[#00A9AE] border-black/10 border-[1px]  px-1 py-2 rounded-md",hidden:!ep,children:[(0,i.jsxs)("div",{className:"flex mb-2 items-center gap-1",children:[(0,i.jsx)(y.C.Group,{max:{count:5,style:{color:"#f56a00",backgroundColor:"#fde3cf"}},children:null==ej?void 0:ej.map(e=>{var t,l,n,a;let s=null==ee?void 0:ee.find(t=>t.user_id===e);return(0,i.jsx)(g.Z,{title:null!==(l=null!==(t=null==s?void 0:s.first_name)&&void 0!==t?t:""+(null==s?void 0:s.last_name))&&void 0!==l?l:"",placement:"top",children:(0,i.jsx)(y.C,{src:null==s?void 0:s.picture_url,alt:null!==(a=null!==(n=null==s?void 0:s.first_name)&&void 0!==n?n:""+(null==s?void 0:s.last_name))&&void 0!==a?a:"",style:{backgroundColor:"#87d068"}})})})}),ex?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.Z,{mode:"multiple",onBlur:()=>{em(!ex)},allowClear:!0,maxTagCount:"responsive",style:{width:"220px"},value:ej,placeholder:"Please select",onChange:e=>{ey(e)},options:el}),(0,i.jsx)(P.FMH,{className:"w-8 h-8 text-red-500 cursor-pointer",onClick:()=>{em(!ex)}})]}):(0,i.jsx)(P.S$f,{className:"w-8 h-8 text-[#ED8C1F] cursor-pointer",onClick:()=>{em(!ex)}})]}),(0,i.jsxs)(w.Z,{form:ea,onFinish:eA,style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,i.jsx)(w.Z.Item,{name:"name",rules:[{required:!0,message:"Please enter the Work Name"}],className:"flex-1 mb-0 min-w-full",children:(0,i.jsx)(_.default,{type:"none",placeholder:"T\xean c\xf4ng việc"})}),(0,i.jsx)(w.Z.Item,{name:"type",rules:[{required:!0,message:"Please enter the Work Name"}],className:"flex-1 mb-0 min-w-80",children:(0,i.jsx)(a.Z,{placeholder:"Chọn loại",onChange:e=>{eZ(e)},showSearch:!0,filterOption:(e,t)=>{var l;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(l=null==t?void 0:t.children)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,i.jsxs)(i.Fragment,{children:[e,(0,i.jsx)(Z.Z,{style:{margin:"8px 0"}}),(0,i.jsx)(s.ZP,{type:"link",onClick:()=>{var e;null===(e=K.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==et?void 0:et.map(e=>(0,i.jsx)(S.W,{value:e.type_work_id,children:e.name},e.type_work_id))})}),(0,i.jsx)(w.Z.Item,{name:"status",rules:[{required:!0,message:"Please enter the Work Name"}],className:"flex-1 mb-0 min-w-80",children:(0,i.jsx)(a.Z,{placeholder:"Trạng th\xe1i",showSearch:!0,filterOption:(e,t)=>{var l;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(l=null==t?void 0:t.children)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,i.jsxs)(i.Fragment,{children:[e,(0,i.jsx)(Z.Z,{style:{margin:"8px 0"}}),(0,i.jsx)(s.ZP,{type:"link",onClick:()=>{var e;null===(e=X.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null===(l=et.find(e=>e.type_work_id===e_))||void 0===l?void 0:null===(t=l.status)||void 0===t?void 0:t.map(e=>(0,i.jsx)(S.W,{value:e.status_work_id,children:e.name},e.status_work_id))})}),(0,i.jsx)(w.Z.Item,{name:"time_start",initialValue:"",className:" mb-0",style:{minWidth:"320px",flex:"1 1 0%"},getValueFromEvent:e=>null==e?void 0:e.format("YYYY-MM-DD"),getValueProps:e=>({value:e?O()(e):""}),children:(0,i.jsx)(C.default,{placeholder:"Chọn ng\xe0y bắt đầu",style:{width:"100%"}})}),(0,i.jsx)(w.Z.Item,{className:" mb-0",name:"time_end",initialValue:"",style:{minWidth:"320px",flex:"1 1 0%"},getValueFromEvent:e=>null==e?void 0:e.format("YYYY-MM-DD"),getValueProps:e=>({value:e?O()(e):""}),children:(0,i.jsx)(C.default,{placeholder:"Chọn ng\xe0y kết th\xfac",style:{width:"100%"}})}),(0,i.jsx)(w.Z.Item,{name:"description",style:{width:"100%"},className:" mb-0",children:(0,i.jsx)(_.default.TextArea,{placeholder:"Description",autoSize:{minRows:3}})}),(0,i.jsx)(w.Z.Item,{style:{width:"100%",display:"flex",justifyContent:"end",margin:"0"},children:(0,i.jsx)(s.ZP,{className:" text-white font-semibold",style:{background:"#00A9AE"},htmlType:"submit",children:"Th\xeam"})})]})]}),(0,i.jsx)("div",{className:"flex flex-col gap-2 max-h-80 overflow-y-auto",children:eh.map(e=>{var t,l,n,a,s;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"flex flex-wrap gap-2 justify-between shadow-md bg-gray-400/5 p-4 rounded-sm cursor-pointer",onClick:()=>{U(e.work_id)},children:[(0,i.jsxs)("div",{className:"flex flex-col justify-between gap-1",children:[(0,i.jsx)("p",{className:"text-[#00A9AE] font-semibold text-lg",children:e.name}),(0,i.jsx)("p",{className:"text-black/60 text-xs",children:(null===(t=null!==(s=e.description)&&void 0!==s?s:"")||void 0===t?void 0:t.length)>50?"".concat(null===(l=e.description)||void 0===l?void 0:l.slice(0,50),"..."):e.description}),(0,i.jsxs)("div",{className:"flex text-xs font-medium gap-2",children:[(0,i.jsx)("p",{children:new Date(e.time_start).toLocaleDateString("vi-VN")}),(0,i.jsx)("span",{children:"-"}),(0,i.jsx)("p",{children:new Date(e.time_end).toLocaleDateString("vi-VN")})]})]}),(0,i.jsxs)("div",{className:"flex flex-col justify-between items-end",children:[(0,i.jsx)(N.Z,{color:"green",children:null==e?void 0:null===(n=e.status)||void 0===n?void 0:n.name}),(0,i.jsx)("div",{className:"max-h-6",children:(0,i.jsx)(y.C.Group,{max:{count:2,style:{color:"#f56a00",backgroundColor:"#fde3cf"}},children:null==e?void 0:null===(a=e.list_user)||void 0===a?void 0:a.map(e=>{var t,l,n,a;let s=null==ee?void 0:ee.find(t=>t.user_id===e.user);return console.log(s),(0,i.jsx)(g.Z,{title:null!==(l=null!==(t=null==s?void 0:s.first_name)&&void 0!==t?t:""+(null==s?void 0:s.last_name))&&void 0!==l?l:"",placement:"top",children:(0,i.jsx)(y.C,{src:null==s?void 0:s.picture_url,alt:null!==(a=null!==(n=null==s?void 0:s.first_name)&&void 0!==n?n:""+(null==s?void 0:s.last_name))&&void 0!==a?a:"",style:{backgroundColor:"#87d068"}})})})})})]})]})})})})]}),(0,i.jsxs)("div",{className:"mb-2  pb-2",children:[(0,i.jsx)("div",{className:"flex items-center text-xs font-medium text-[#EB8823] hover:opacity-85 cursor-pointer mb-2",children:(0,i.jsx)("p",{className:"pointer-events-none",children:"Ảnh đầu c\xf4ng việc"})}),(0,i.jsx)(w.Z.Item,{className:"!m-0",style:{minWidth:"320px",flex:"1 1 0%"},children:(0,i.jsx)(b.default,{action:"",listType:"picture-card",fileList:ed.filter(e=>"start"===e.name),onPreview:e=>{er((0,H.BZ)(e.url))},onChange:e=>{eT(e,!0)},multiple:!0,children:eL})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"flex items-center text-xs font-medium text-[#EB8823] hover:opacity-85 cursor-pointer mb-2",children:(0,i.jsx)("p",{className:"pointer-events-none",children:"Ảnh sau c\xf4ng việc"})}),(0,i.jsx)(w.Z.Item,{className:"!m-0",style:{minWidth:"320px",flex:"1 1 0%"},children:(0,i.jsx)(b.default,{action:"",listType:"picture-card",fileList:ed.filter(e=>"end"===e.name),onPreview:e=>{er((0,H.BZ)(e.url))},onChange:e=>{eT(e,!1)},multiple:!0,children:eL})})]})]},1)})}),(0,i.jsx)(D.Z,{refBtnContract:z}),(0,i.jsx)(B.Z,{refBtnType:q}),(0,i.jsx)(F.Z,{refBtnStatus:G}),(0,i.jsx)(R.Z,{refBtnStatus:X}),(0,i.jsx)(V.Z,{refBtnType:K}),(0,i.jsx)(Y.Z,{ID:Q,refBtn:$,setID:U})]})}var z=l(65624);function G(){let[e,t]=(0,n.useState)(25),l=(0,z.Z)(["admin-top","activity","activity-edit"]),{projectID:f}=(0,p.useParams)(),{datas:j}=(0,c.v9)(e=>e.get_activities),[y,g]=(0,n.useState)([]);(0,n.useEffect)(()=>{f&&C((0,h.ij)({project:f}))},[f]);let w=[{title:"Hợp đồng#",className:"text-xs",dataIndex:"activity_id",render:(e,t,n)=>(0,i.jsxs)("div",{className:"flex flex-col gap-1 ",children:[(0,i.jsxs)("strong",{children:["#",n+1,"."]}),(0,i.jsx)("div",{className:"flex gap-2",children:l&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.Z,{ID:e}),(0,i.jsx)(q,{ID:e})]})})]}),sorter:(e,t)=>e.activity_id.localeCompare(t.activity_id)},{title:"T\xean hoạt động",dataIndex:"name",className:"text-xs",render:e=>e||"N/A",sorter:(e,t)=>(e.name||"").localeCompare(t.name||"")},{title:"Hợp đồng",dataIndex:["contract","name_contract"],className:"text-xs",render:e=>e?"".concat(e.toLocaleString("vi-VN"),"đ"):"N/A",sorter:(e,t)=>{var l,i;return((null===(l=e.contract)||void 0===l?void 0:l.name_contract)||"").localeCompare((null===(i=t.contract)||void 0===i?void 0:i.name_contract)||"")}},{title:"Loại hoạt động",dataIndex:["type","name"],className:"text-xs",render:e=>e||"N/A",sorter:(e,t)=>{var l,i;return((null===(l=e.type)||void 0===l?void 0:l.name)||"").localeCompare((null===(i=t.type)||void 0===i?void 0:i.name)||"")}},{title:"T\xecnh trạng",dataIndex:["status","name"],className:"text-xs",render:e=>e||"N/A",sorter:(e,t)=>{var l,i;return((null===(l=e.status)||void 0===l?void 0:l.name)||"").localeCompare((null===(i=t.status)||void 0===i?void 0:i.name)||"")}},{title:"Ng\xe0y tạo",dataIndex:"created_at",className:"text-xs",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>new Date(e.created_at||0).getTime()-new Date(t.created_at||0).getTime()}],_=e=>{g(null==j?void 0:j.filter(t=>{var l;return String(t.created_at+" "+t.name+" "+(null===(l=t.contract)||void 0===l?void 0:l.name_contract)+" "+t.created_at+" "+t.status+" "+t.activity_id).toLowerCase().includes(e.toLowerCase())}))},{postdata:Z}=(0,x.Z)(),C=(0,c.I0)(),[N,b]=(0,n.useState)(!1),[k,S]=(0,n.useState)([]),A=async()=>{200===await Z(()=>m.Z.deleteActivities(k))&&(C((0,h.ij)({})),S([]),b(!1))},I=(0,p.useSearchParams)();return(0,n.useEffect)(()=>{let e=I.get("id");j&&e?_(e):g(j.map((e,t)=>({...e,key:t})))},[j,I]),(0,i.jsxs)("div",{className:"",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)(a.Z,{defaultValue:e,style:{width:83},onChange:e=>t(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),(0,i.jsx)(s.ZP,{hidden:!(k.length>0),children:"Xuất ra"}),(0,i.jsx)(s.ZP,{onClick:()=>{b(!0)},danger:!0,hidden:!(k.length>0),className:"text-xl",icon:(0,i.jsx)(v.FH3,{})}),(0,i.jsx)(r.Z,{open:N,title:"X\xf3a dữ liệu",onOk:A,onCancel:()=>{b(!1)},children:"Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng ?"})]}),(0,i.jsx)("div",{className:"flex items-center",children:(0,i.jsx)(o.Z,{onChange:e=>{_(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})})]}),(0,i.jsx)("div",{className:"w-full overflow-auto",children:(0,i.jsx)("div",{className:"min-w-fit",children:(0,i.jsx)(d.Z,{columns:w,rowSelection:{onChange:(e,t)=>{S(t.map(e=>e.activity_id))}},dataSource:y,scroll:{x:"max-content"},pagination:{pageSize:e,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showSorterTooltip:{target:"sorter-icon"}})})})]})}var K=l(9626),X=l(27648),$=l(61273);function Q(){var e,t;let{RangePicker:l}=C.default,[r,d]=(0,n.useState)({}),{projectID:o}=(0,p.useParams)(),{datas:u}=(0,c.v9)(e=>e.get_type_activities),{datas:x}=(0,c.v9)(e=>e.get_contracts),m=(0,c.I0)();return(0,n.useEffect)(()=>{r&&m((0,h.ij)({...r,project:o}))},[r]),(0,i.jsxs)("div",{className:"flex items-start gap-4 w-full flex-col",children:[(0,i.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[(0,i.jsx)(K.Z,{}),(0,i.jsx)("div",{className:"sm:block hidden",children:(0,i.jsx)(B.Z,{})}),(0,i.jsx)("div",{className:"sm:block hidden",children:(0,i.jsx)(F.Z,{})}),!o&&(0,i.jsx)(X.default,{href:"/activity/scheduler",children:(0,i.jsx)(s.ZP,{icon:(0,i.jsx)($.zwD,{})})})]}),!o&&(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm font-semibold text-[#1BA399]",children:"Được lọc theo:"}),(0,i.jsxs)("div",{className:"flex flex-wrap w-full items-center justify-end gap-2   pb-4 ",children:[(0,i.jsx)(a.Z,{placeholder:"Hợp đồng",style:{minWidth:120,flex:"1 1 0%"},onChange:e=>{d({...r,contract:e})},showSearch:!0,allowClear:!0,filterOption:(e,t)=>{var l;return(null!==(l=null==t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},options:x.map(e=>({value:e.contract_id,label:e.name_contract}))}),(0,i.jsx)(a.Z,{placeholder:"Loại hoạt động",style:{minWidth:120,flex:"1 1 0%"},onChange:e=>{d({...r,type:e})},showSearch:!0,allowClear:!0,filterOption:(e,t)=>{var l;return(null!==(l=null==t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},options:u.map(e=>({value:e.type_activity_id,label:e.name}))}),r.type&&(0,i.jsx)(a.Z,{placeholder:"T\xecnh trạng",onChange:e=>{d({...r,status:e})},showSearch:!0,allowClear:!0,filterOption:(e,t)=>{var l;return(null!==(l=null==t?void 0:t.label)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},style:{minWidth:120,flex:"1 1 0%"},options:null===(t=u.find(e=>e.type_activity_id===r.type))||void 0===t?void 0:null===(e=t.status)||void 0===e?void 0:e.map(e=>({value:e.status_activity_id,label:e.name}))}),(0,i.jsx)(l,{style:{minWidth:120,flex:"1 1 0%"},onChange:(e,t)=>{d({...r,date_start:t[0],date_end:t[1]})}})]})]})]})}function U(){let e=(0,z.Z)(["admin-top","activity","activity-edit"]);return(0,i.jsxs)("div",{className:"flex flex-col gap-4 rounded-md p-4 shadow-[0_8px_30px_rgb(0,0,0,0.12)] bg-white",children:[e&&(0,i.jsx)("div",{className:" p-2 ",children:(0,i.jsx)(Q,{})}),(0,i.jsx)("div",{className:" p-2",children:(0,i.jsx)(G,{})})]})}},67545:function(e,t,l){l.d(t,{Z:function(){return k}});var i=l(57437),n=l(46475),a=l(11265),s=l(24307),r=l(91626),d=l(58970),o=l(42654),c=l(44967),u=l(11632),x=l(23496),m=l(16836),h=l(29487),v=l(45747),p=l(7140),f=l(2265),j=l(68575),y=l(27929),g=l(63302),w=l(60792),_=l(45407),Z=l(83458),C=l(21544),N=l(99376),b=l(15162);function k(e){let{ID:t,idType:l,type:k,refBtn:S,setID:A}=e,I=(0,f.useRef)(),T=(0,f.useRef)(),L=(0,f.useRef)(),P=(0,f.useRef)(),E=(0,f.useRef)(),W=(0,f.useRef)(),[D,B]=(0,f.useState)(""),{datas:F}=(0,j.v9)(e=>e.get_type_activities),{datas:R}=(0,j.v9)(e=>e.get_contracts),{projectID:V}=(0,N.useParams)(),[M]=(0,h.Z)(),{postdata:O}=(0,n.Z)(),Y=(0,j.I0)(),[H,q]=(0,f.useState)(!1),[z,G]=(0,f.useState)(""),[K,X]=(0,f.useState)([]),$=async()=>{let e=await s.Z.getActivityById(t);if(200===e.statusCode){let t=e.data;M.setFieldsValue(t),G(e.data.type)}};(0,f.useEffect)(()=>{if(z){var e,t;X(null!==(t=null===(e=F.find(e=>e.type_activity_id===z))||void 0===e?void 0:e.status)&&void 0!==t?t:[])}},[z]);let Q=async e=>{console.log(t);let i=await O(()=>s.Z.updateActivity(t,e));(200===i||201===i)&&($(),k||Y((0,a.ij)({project:V})),"schedule"===k&&Y((0,y.N)(l)),"gantt"===k&&A&&(Y((0,a.ij)({})),A("")))},U=async()=>{M.submit()};return(0,f.useEffect)(()=>{if(""!==D){var e;null===(e=W.current)||void 0===e||e.click()}},[D]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.ZP,{hidden:!!k,className:"  text-xs text-yellow-500 font-semibold",type:"text",ref:S,onClick:()=>{q(!0),$()},children:"Chỉnh sửa"}),(0,i.jsx)(d.Z,{title:"Cập nhật hoạt động",open:H,onCancel:()=>{q(!1),A&&A("")},footer:null,width:"100%",style:{maxWidth:"800px"},children:(0,i.jsx)(o.Z,{defaultActiveKey:"1",style:{width:"100%"},type:"line",children:(0,i.jsxs)(p.Z,{tab:"Th\xf4ng tin hoạt động",children:[(0,i.jsxs)(c.Z,{layout:"vertical",form:M,onFinish:Q,style:{display:"flex",flexWrap:"wrap",columnGap:"12px"},children:[(0,i.jsx)(c.Z.Item,{name:"type",label:"Loại hoạt động",rules:[{required:!0,message:"Vui l\xf2ng chọn loại hoạt động!"}],style:{width:"100%",flex:"1 1 0%"},children:(0,i.jsx)(u.Z,{disabled:!0,placeholder:"Chọn loại",onChange:e=>{G(e)},showSearch:!0,filterOption:(e,t)=>{var l;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(l=null==t?void 0:t.children)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,i.jsxs)(i.Fragment,{children:[e,(0,i.jsx)(x.Z,{style:{margin:"8px 0"}}),(0,i.jsx)(r.ZP,{type:"link",onClick:()=>{var e;null===(e=I.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==F?void 0:F.map(e=>(0,i.jsx)(v.W,{value:e.type_activity_id,children:e.name},e.type_activity_id))})}),(0,i.jsx)(c.Z.Item,{name:"name",label:"T\xean hoạt động",rules:[{required:!0,type:"string",message:"Vui l\xf2ng nhập t\xean hoạt động"}],style:{minWidth:"100%",flex:"1 1 0%"},children:(0,i.jsx)(m.default,{})}),(0,i.jsx)(c.Z.Item,{name:"status",label:"Trạng th\xe1i",style:{minWidth:"240px",flex:"1 1 0%"},children:(0,i.jsx)(u.Z,{disabled:!0,placeholder:"Chọn loại",showSearch:!0,filterOption:(e,t)=>{var l;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(l=null==t?void 0:t.children)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,i.jsxs)(i.Fragment,{children:[e,(0,i.jsx)(x.Z,{style:{margin:"8px 0"}}),(0,i.jsx)(r.ZP,{type:"link",onClick:()=>{var e;null===(e=L.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==K?void 0:K.map(e=>(0,i.jsx)(v.W,{value:e.status_activity_id,children:e.name},e.status_activity_id))})}),(0,i.jsx)(c.Z.Item,{name:"contract",label:"Hợp động",style:{minWidth:"240px",flex:"1 1 0%"},children:(0,i.jsx)(u.Z,{placeholder:"Chọn hợp động",showSearch:!0,filterOption:(e,t)=>{var l;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(l=null==t?void 0:t.children)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,i.jsxs)(i.Fragment,{children:[e,(0,i.jsx)(x.Z,{style:{margin:"8px 0"}}),(0,i.jsx)(r.ZP,{type:"link",onClick:()=>{var e;null===(e=T.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==R?void 0:R.map(e=>(0,i.jsx)(v.W,{value:e.contract_id,children:e.name_contract},e.contract_id))})}),(0,i.jsx)(c.Z.Item,{name:"description",label:"M\xf4 tả",style:{width:"100%"},children:(0,i.jsx)(m.default.TextArea,{placeholder:"Description",autoSize:{minRows:3}})})]}),(0,i.jsx)("div",{className:"flex justify-end w-full mt-4",children:(0,i.jsx)(r.ZP,{type:"primary",onClick:U,children:"Cập nhật"})})]},1)})}),(0,i.jsx)(g.Z,{refBtnContract:T}),(0,i.jsx)(w.Z,{refBtnType:I}),(0,i.jsx)(_.Z,{refBtnStatus:L}),(0,i.jsx)(Z.Z,{refBtnStatus:E}),(0,i.jsx)(C.Z,{refBtnType:P}),(0,i.jsx)(b.Z,{ID:D,refBtn:W,setID:B})]})}},78687:function(e,t,l){l.d(t,{Z:function(){return s}});var i=l(57437),n=l(71047),a=l(91626);function s(){return(0,i.jsx)(n.ZP,{status:"403",title:"403",subTitle:"Sorry, you are not authorized to access this page.",extra:(0,i.jsx)(a.ZP,{type:"primary",children:"Quay lại"})})}l(2265)}}]);