"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7652],{53408:function(e,t,n){var a=n(2265),l=n(54011),r=function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},o=(0,a.forwardRef)(function(e,t){return a.createElement(l.P,r({},e,{chartType:"Column",ref:t}))});t.Z=o},87652:function(e,t,n){n.r(t),n.d(t,{default:function(){return v}});var a=n(57437),l=n(2265),r=n(53408),o=n(56612),u=n(55846),i=n(77398),c=n.n(i),d=n(71096),s=n.n(d),g=n(40776);let{RangePicker:f}=o.default;function v(){let[e,t]=(0,l.useState)([]),[n,o]=(0,l.useState)("month"),[i,d]=(0,l.useState)(new Date("2024-12-01").getTime()),[v,y]=(0,l.useState)(new Date("2024-12-31").getTime());return(0,l.useEffect)(()=>{(async()=>{if(n||v||i){let e=await g.Z.getFilterOpportunity({time_first:i,time_end:v});if(200===e.statusCode){let a=e.data;if("day"===n){let e=a.reduce((e,t)=>{let n=new Date(t.created_at),a="".concat(n.getFullYear(),"-").concat(n.getMonth()+1,"-").concat(10>n.getDate()?"0"+n.getDate():n.getDate());return(null==e?void 0:e[a])||(e[a]=0),e[a]=e[a]+1,e},{});console.log(e),t((function(e,t){let n=new Date(e),a=new Date(t),l=[];for(;n<=a;)l.push(new Date(n).toISOString().split("T")[0]),n.setDate(n.getDate()+1);return l})(null!=i?i:0,null!=v?v:0).map(t=>{let n=Object.keys(e).find(e=>{if(new Date(e).getTime()===new Date(t).getTime())return e});return{type:"Ng\xe0y "+t,value:n?e[n]:0}}))}if("week"===n){let e=a.reduce((e,t)=>{let n=c()(t.created_at),a="".concat(n.isoWeek(),"-").concat(n.year());return(null==e?void 0:e[a])||(e[a]=0),e[a]=e[a]+1,e},{});t((function(e,t){let n=new Date(e),a=new Date(t),l=[];for(;n.getTime()<=a.getTime();){let e=new Date(n);n.setDate(n.getDate()+6),l.push("".concat(c()(e).clone().isoWeek(),"-").concat(c()(e).clone().isoWeekYear())),n.setDate(n.getDate()+1)}return l})(null!=i?i:0,null!=v?v:0).map(t=>{let n=Object.keys(e).find(e=>{if(t===e)return e});return{type:"Tuần "+t,value:n?e[n]:0}}))}if("month"===n){let e=a.reduce((e,t)=>{let n=c()(t.created_at),a="".concat(n.year(),"-").concat(n.month()+1);return(null==e?void 0:e[a])||(e[a]=0),e[a]=e[a]+1,e},{}),n=function(e,t){let n=new Date(e),a=new Date(t),l=[];for(;n<=a;){let e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0");l.push("".concat(e,"-").concat(t)),n.setMonth(n.getMonth()+1)}return l}(null!=i?i:0,null!=v?v:0);t(n.map(t=>{let n=Object.keys(e).find(e=>{if(new Date(t).getTime()===new Date(e).getTime())return e}),a=new Date(t);return{type:"Th\xe1ng "+(a.getMonth()+1)+"-"+a.getFullYear(),value:n?e[n]:0}})),console.log(n,e)}if("year"===n){let e=a.reduce((e,t)=>{let n=c()(t.created_at);return(null==e?void 0:e[n.year()])||(e[n.year()]=0),e[n.year()]=e[n.year()]+1,e},{});t((function(e,t){let n=new Date(e).getFullYear(),a=new Date(t).getFullYear(),l=[];for(let e=n;e<=a;e++)l.push(e.toString());return l})(null!=i?i:0,null!=v?v:0).map(t=>{let n=Object.keys(e).find(e=>{if(t.toString()===e.toString())return e});return{type:"Năm "+t,value:n?e[n]:0}}))}}}})()},[n,i,v]),(0,a.jsxs)("div",{className:"p-4 flex flex-col gap-4 max-w-full border-b-[1px]",children:[(0,a.jsxs)("div",{className:"p-4 flex justify-between flex-wrap gap-2",children:[(0,a.jsx)("div",{children:(0,a.jsxs)(u.ZP.Group,{value:n,buttonStyle:"solid",onChange:e=>{o(e.target.value)},children:[(0,a.jsx)(u.ZP.Button,{value:"day",children:"Ng\xe0y"}),(0,a.jsx)(u.ZP.Button,{value:"week",children:"Tuần"}),(0,a.jsx)(u.ZP.Button,{value:"month",children:"Th\xe1ng"}),(0,a.jsx)(u.ZP.Button,{value:"year",children:"Năm"})]})}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,a.jsx)(f,{picker:"day"===n?"date":n,value:[s()(i),s()(v)],onChange:(e,t)=>{var a,l,r,o,u,i,s,g,f;if("year"===n&&(d(new Date(t[0]).getTime()),y(new Date("".concat(t[1],"-12-31")).getTime())),"month"===n&&(d(new Date("".concat(t[0],"-01")).getTime()),y(new Date("".concat(c()(new Date("".concat(null==e?void 0:null===(a=e[1])||void 0===a?void 0:a.year(),"-").concat((null!==(r=null==e?void 0:null===(l=e[1])||void 0===l?void 0:l.month())&&void 0!==r?r:0)+2,"-01"))).clone().subtract(1,"days"))).getTime())),"day"===n&&(d(new Date(t[0]).getTime()),y(new Date(t[1]).getTime())),"week"===n){let n=c()().year(null!==(g=null==e?void 0:null===(o=e[0])||void 0===o?void 0:o.year())&&void 0!==g?g:0).isoWeek(Number(t[0].replace("".concat(null==e?void 0:null===(u=e[0])||void 0===u?void 0:u.year(),"-"),"").replace(/\D/g,""))).startOf("isoWeek").clone().format("YYYY-MM-DD"),a=c()().year(null!==(f=null==e?void 0:null===(i=e[1])||void 0===i?void 0:i.year())&&void 0!==f?f:0).isoWeek(Number(t[1].replace("".concat(null==e?void 0:null===(s=e[1])||void 0===s?void 0:s.year(),"-"),"").replace(/\D/g,""))).startOf("isoWeek").clone().add(5,"days").format("YYYY-MM-DD");d(n?new Date(n).getTime():0),y(a?new Date(a).getTime():0)}}})})]}),(0,a.jsx)("p",{className:"p-4 text-xl font-semibold",children:"Thống k\xea kh\xe1ch h\xe0ng"}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(()=>{let t=e.length>0?e:[{type:"day"===n?"Ng\xe0y":"week"===n?"Tuần":"month"===n?"Th\xe1ng":"Năm",value:0}];return(0,a.jsx)(r.Z,{data:t,xField:"type",yField:"value",style:{fill:()=>"#2989FF"},legend:!1})},{})})]})}}}]);