(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5143],{57017:function(e,t,r){Promise.resolve().then(r.bind(r,8614))},96473:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(1119),l=r(2265),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},i=r(10703),s=l.forwardRef(function(e,t){return l.createElement(i.Z,(0,n.Z)({},e,{ref:t,icon:a}))})},99376:function(e,t,r){"use strict";var n=r(35475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},8614:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T}});var n=r(57437),l=r(2265),a=r(91626),i=r(27648),s=r(49089),o=r(46475),c=r(58970),d=r(44967),u=r(16836),h=r(90136),m=r(11632),p=r(23496),x=r(45747),f=r(32768),v=r(29487),j=r(22744),y=r(68575),g=r(34014),b=r(78049),w=r(17166);function Z(e){let{refBtnContractors:t}=e,r=(0,y.I0)(),i=(0,l.useRef)(),s=(0,l.useRef)(),{postdata:Z}=(0,o.Z)(),[C]=(0,v.Z)(),[P,O]=(0,l.useState)(!1),{datas:N}=(0,y.v9)(e=>e.get_projects),S=async e=>{let t=await Z(()=>b.Z.createContractor(e));(200===t||201===t)&&(C.resetFields(),O(!1),r((0,g.J)()))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.ZP,{hidden:!!t,className:"bg-blue-400 border-0 text-white font-semibold",icon:(0,n.jsx)(f.b0B,{}),onClick:()=>{O(!0)},ref:t,children:"Th\xeam nh\xe0 thầu"}),(0,n.jsxs)(c.Z,{title:"Tạo nh\xe0 thầu",open:P,onCancel:()=>{O(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,n.jsx)(a.ZP,{onClick:()=>{var e;null===(e=i.current)||void 0===e||e.click()},icon:(0,n.jsx)(j.vfz,{}),children:"Qu\xe9t cccd"}),(0,n.jsxs)(d.Z,{layout:"vertical",onFinish:S,form:C,style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 h-fit w-fit rounded-lg p-1",children:[(0,n.jsx)(d.Z.Item,{name:"name",className:"!m-0",label:"T\xean nh\xe0 thầu",rules:[{required:!0,message:"Vui l\xf2ng nhập t\xean!"}],style:{minWidth:"320px",flex:"1 1 0%"},children:(0,n.jsx)(u.default,{})}),(0,n.jsx)(d.Z.Item,{name:"phone",label:"Số điện thoại",children:(0,n.jsx)(u.default,{placeholder:"Số điện thoại",maxLength:20})}),(0,n.jsx)(d.Z.Item,{name:"email",label:"Email",rules:[{type:"email"}],children:(0,n.jsx)(u.default,{placeholder:"Email (nếu c\xf3)"})}),(0,n.jsx)(d.Z.Item,{name:"address",label:"Địa chỉ",children:(0,n.jsx)(u.default,{placeholder:"Địa chỉ"})}),(0,n.jsx)(d.Z.Item,{name:"tax_code",label:"M\xe3 số thuế",children:(0,n.jsx)(u.default,{placeholder:"M\xe3 số thuế"})}),(0,n.jsx)(d.Z.Item,{name:"rating",label:"Đ\xe1nh gi\xe1",rules:[{type:"number",min:0,max:5,message:"Từ 0 đến 5 sao"}],children:(0,n.jsx)(h.Z,{placeholder:"0 - 5",min:0,max:5,step:.1,className:"w-full"})}),(0,n.jsx)(d.Z.Item,{name:"project",label:"Dự \xe1n",rules:[{required:!1,message:"Vui l\xf2ng nhập nh\xf3m dự \xe1n!"}],style:{minWidth:"320px",flex:"1 1 0%"},children:(0,n.jsx)(m.Z,{placeholder:"Chọn dự \xe1n",showSearch:!0,filterOption:(e,t)=>{var r;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(r=null==t?void 0:t.children)&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,n.jsxs)(n.Fragment,{children:[e,(0,n.jsx)(p.Z,{style:{margin:"8px 0"}}),(0,n.jsx)(a.ZP,{type:"link",onClick:()=>{var e;null===(e=s.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==N?void 0:N.map(e=>(0,n.jsx)(x.W,{value:e.project_id,children:e.name},e.project_id))})}),(0,n.jsx)(d.Z.Item,{name:"notes",label:"Ghi ch\xfa",style:{width:"100%"},children:(0,n.jsx)(u.default.TextArea,{placeholder:"Note",autoSize:{minRows:3}})})]}),(0,n.jsx)(d.Z.Item,{style:{width:"100%",display:"flex",justifyContent:"end"},children:(0,n.jsx)(a.ZP,{type:"primary",htmlType:"submit",children:"Tạo"})})]})]}),(0,n.jsx)(w.Z,{refBtnProject:s})]})}function C(){return(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"flex gap-2 items-center flex-wrap",children:[(0,n.jsx)(Z,{}),(0,n.jsx)(i.default,{href:"/Asset/dashboard",children:(0,n.jsx)(a.ZP,{icon:(0,n.jsx)(s.yQE,{})})})]}),(0,n.jsx)("div",{})]})}var P=r(91250),O=r(56771),N=r(99376);function S(e){let{contractor_id:t}=e,r=(0,y.I0)(),i=(0,l.useRef)(),s=(0,l.useRef)(),{postdata:f}=(0,o.Z)(),[Z]=(0,v.Z)(),[C,P]=(0,l.useState)(!1),{datas:O}=(0,y.v9)(e=>e.get_projects),N=async()=>{let e=await b.Z.getContractorByID(t);if(200===e.statusCode){var r,n;Z.setFieldsValue({...e.data,customer:null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(r=n.customer)||void 0===r?void 0:r.info_id})}},S=async e=>{let n=await f(()=>b.Z.updateContractor(t,e));(200===n||201===n)&&(Z.resetFields(),P(!1),r((0,g.J)()))};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.ZP,{className:"  text-xs text-yellow-500 font-semibold",type:"text",onClick:()=>{P(!0),N()},children:"Chỉnh sửa"}),(0,n.jsxs)(c.Z,{title:"Cập nhật nh\xe0 thầu",open:C,onCancel:()=>{P(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,n.jsx)(a.ZP,{onClick:()=>{var e;null===(e=i.current)||void 0===e||e.click()},icon:(0,n.jsx)(j.vfz,{}),children:"Qu\xe9t cccd"}),(0,n.jsxs)(d.Z,{layout:"vertical",onFinish:S,form:Z,style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 h-fit w-fit rounded-lg p-1",children:[(0,n.jsx)(d.Z.Item,{name:"name",className:"!m-0",label:"T\xean nh\xe0 thầu",rules:[{required:!0,message:"Vui l\xf2ng nhập t\xean!"}],style:{minWidth:"320px",flex:"1 1 0%"},children:(0,n.jsx)(u.default,{})}),(0,n.jsx)(d.Z.Item,{name:"phone",label:"Số điện thoại",children:(0,n.jsx)(u.default,{placeholder:"Số điện thoại",maxLength:20})}),(0,n.jsx)(d.Z.Item,{name:"email",label:"Email",rules:[{type:"email"}],children:(0,n.jsx)(u.default,{placeholder:"Email (nếu c\xf3)"})}),(0,n.jsx)(d.Z.Item,{name:"address",label:"Địa chỉ",children:(0,n.jsx)(u.default,{placeholder:"Địa chỉ"})}),(0,n.jsx)(d.Z.Item,{name:"tax_code",label:"M\xe3 số thuế",children:(0,n.jsx)(u.default,{placeholder:"M\xe3 số thuế"})}),(0,n.jsx)(d.Z.Item,{name:"rating",label:"Đ\xe1nh gi\xe1",rules:[{type:"number",min:0,max:5,message:"Từ 0 đến 5 sao"}],children:(0,n.jsx)(h.Z,{placeholder:"0 - 5",min:0,max:5,step:.1,className:"w-full"})}),(0,n.jsx)(d.Z.Item,{name:"customer",label:"Kh\xe1ch h\xe0ng",rules:[{required:!0,message:"Vui l\xf2ng nhập nh\xf3m kh\xe1ch h\xe0ng!"}],style:{minWidth:"320px",flex:"1 1 0%"},children:(0,n.jsx)(m.Z,{placeholder:"Chọn kh\xe1ch h\xe0ng",showSearch:!0,filterOption:(e,t)=>{var r;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(r=null==t?void 0:t.children)&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())},dropdownRender:e=>(0,n.jsxs)(n.Fragment,{children:[e,(0,n.jsx)(p.Z,{style:{margin:"8px 0"}}),(0,n.jsx)(a.ZP,{type:"link",onClick:()=>{var e;null===(e=s.current)||void 0===e||e.click()},children:"+ Th\xeam t\xf9y chọn mới"})]}),children:null==O?void 0:O.map(e=>(0,n.jsx)(x.W,{value:e.project_id,children:e.name},e.project_id))})}),(0,n.jsx)(d.Z.Item,{name:"notes",label:"Ghi ch\xfa",style:{width:"100%"},children:(0,n.jsx)(u.default.TextArea,{placeholder:"Note",autoSize:{minRows:3}})})]}),(0,n.jsx)(d.Z.Item,{style:{width:"100%",display:"flex",justifyContent:"end"},children:(0,n.jsx)(a.ZP,{type:"primary",htmlType:"submit",children:"Cập nhật"})})]})]}),(0,n.jsx)(w.Z,{refBtnProject:s})]})}function k(){let[e,t]=(0,l.useState)(25),r=(0,y.I0)(),[i,s]=(0,l.useState)([]),{datas:o}=(0,y.v9)(e=>e.get_contractors),d=[{title:"#",dataIndex:"id",render:(e,t)=>(0,n.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,n.jsxs)("strong",{children:[e.slice(0,10),"..."]}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(S,{contractor_id:t.id})})})]})},{title:"T\xean nh\xe0 thầu",dataIndex:"name",sorter:(e,t)=>e.name.localeCompare(t.name)},{title:"Số điện thoại",dataIndex:"phone",sorter:(e,t)=>{var r,n;return(null!==(r=e.phone)&&void 0!==r?r:"").localeCompare(null!==(n=t.phone)&&void 0!==n?n:"")}},{title:"Thuộc kh\xe1ch h\xe0ng",dataIndex:["customer","name_company"],sorter:(e,t)=>{var r,n,l,a;return(null!==(l=null==e?void 0:null===(r=e.customer)||void 0===r?void 0:r.name_company)&&void 0!==l?l:"").localeCompare(null!==(a=null==t?void 0:null===(n=t.customer)||void 0===n?void 0:n.name_company)&&void 0!==a?a:"")}},{title:"Email",dataIndex:"email",sorter:(e,t)=>{var r,n;return(null!==(r=e.email)&&void 0!==r?r:"").localeCompare(null!==(n=t.email)&&void 0!==n?n:"")}},{title:"M\xe3 thuế",dataIndex:"tax_code",sorter:(e,t)=>{var r,n;return(null!==(r=e.tax_code)&&void 0!==r?r:"").localeCompare(null!==(n=t.tax_code)&&void 0!==n?n:"")}},{title:"Chất lượng",dataIndex:"rating",sorter:(e,t)=>{var r,n;return(null!==(r=e.rating)&&void 0!==r?r:0)-(null!==(n=t.rating)&&void 0!==n?n:0)}}],u=e=>{var t;s(null!==(t=null==o?void 0:o.filter(t=>String(t.id+" "+t.created_at+" "+t.name+" "+t.email+" "+t.phone+" "+t.tax_code+" "+t.address+" ").toLowerCase().includes(e.toLowerCase())))&&void 0!==t?t:[])},[h,p]=(0,l.useState)(!1),[x,f]=(0,l.useState)([]),v=async()=>{},b=(0,N.useSearchParams)();return(0,l.useEffect)(()=>{var e;s(null!==(e=o.map((e,t)=>({...e,key:t})))&&void 0!==e?e:[])},[o,b]),(0,l.useEffect)(()=>{r((0,g.J)())},[]),(0,n.jsxs)("div",{className:"",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(m.Z,{defaultValue:e,style:{width:83},onChange:e=>t(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),(0,n.jsx)(a.ZP,{hidden:!(x.length>0),children:"Xuất ra"}),(0,n.jsx)(a.ZP,{onClick:()=>{p(!0)},danger:!0,hidden:!(x.length>0),className:"text-xl",icon:(0,n.jsx)(j.FH3,{})})]}),(0,n.jsx)("div",{className:"flex gap-2 items-center",children:(0,n.jsx)(O.Z,{onChange:e=>{u(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})})]}),(0,n.jsx)("div",{className:"w-full overflow-auto",children:(0,n.jsx)("div",{className:"min-w-fit",children:(0,n.jsx)(P.Z,{columns:d,rowSelection:{onChange:(e,t)=>{f(t.map(e=>e.id))}},dataSource:i,scroll:{x:"max-content"},pagination:{pageSize:e,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showSorterTooltip:{target:"sorter-icon"}})})}),(0,n.jsx)(c.Z,{open:h,title:"X\xf3a dữ liệu",onOk:v,onCancel:()=>{p(!1)},children:"Bạn c\xf3 chắc chắn muốn x\xf3a kh\xf4ng ?"})]})}function I(){return(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"flex flex-col gap-4 rounded-md p-4 shadow-[0_8px_30px_rgb(0,0,0,0.12)] bg-white",children:[(0,n.jsx)("div",{className:"rounded-md",children:(0,n.jsx)(C,{})}),(0,n.jsx)("div",{className:"rounded-md",children:(0,n.jsx)(k,{})})]})})}r(78687);var _=r(64985);function T(){let e=(0,y.I0)();return(0,l.useEffect)(()=>{e((0,_.K)())},[]),(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)(I,{})})}},78687:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(57437),l=r(71047),a=r(91626);function i(){return(0,n.jsx)(l.ZP,{status:"403",title:"403",subTitle:"Sorry, you are not authorized to access this page.",extra:(0,n.jsx)(a.ZP,{type:"primary",children:"Quay lại"})})}r(2265)},34014:function(e,t,r){"use strict";r.d(t,{J:function(){return a}});var n=r(78049),l=r(20301);let a=(0,l.hg)("project/fetchContractors",async(e,t)=>{try{return await n.Z.getContractors()}catch(e){return t.rejectWithValue("Failed to fetch product types")}}),i=(0,l.oM)({name:"contractor_project",initialState:{datas:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(a.pending,e=>{e.loading=!0,e.error=null}).addCase(a.fulfilled,(e,t)=>{200===t.payload.statusCode&&(e.loading=!1,e.datas=t.payload.data)}).addCase(a.rejected,(e,t)=>{e.loading=!1,e.error=t.payload})}}).reducer;t.Z=i},28223:function(e,t,r){"use strict";r.d(t,{Y:function(){return a}});var n=r(83464);let l=n.Z.create({baseURL:"https://api.sparking.cloud",timeout:2e4,headers:{"Content-Type":"application/json"},withCredentials:!0}),a=n.Z.create({baseURL:"https://api.sparking.cloud",timeout:2e4,headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});t.Z=l},90382:function(e,t,r){"use strict";r.d(t,{S:function(){return l}});var n=r(7261);let l=e=>{var t,r,l;let a=(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"An unexpected error occurred",i=null===(l=e.response)||void 0===l?void 0:l.status;n.Am.dismiss(),403===i?n.Am.error("Bạn kh\xf4ng c\xf3 quyền"):n.Am.error(a)}},46231:function(e,t,r){"use strict";r.d(t,{w_:function(){return d}});var n=r(2265),l={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},a=n.createContext&&n.createContext(l),i=["attr","size","title"];function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){var n,l;n=t,l=r[t],(n=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(n))in e?Object.defineProperty(e,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[n]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>n.createElement(u,s({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>n.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var r,{attr:l,size:a,title:o}=e,d=function(e,t){if(null==e)return{};var r,n,l=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(l[r]=e[r])}return l}(e,i),u=a||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),n.createElement("svg",s({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,l,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),o&&n.createElement("title",null,o),e.children)};return void 0!==a?n.createElement(a.Consumer,null,e=>t(e)):t(l)}}},function(e){e.O(0,[5652,6051,7699,5706,5452,1994,6950,5319,5651,6006,1047,8143,7526,7464,7821,3464,9481,314,9970,5270,1412,3281,7651,6399,5422,1250,8970,4967,3569,6498,3984,136,6612,480,7580,8026,7648,4599,6966,2971,2117,1744],function(){return e(e.s=57017)}),_N_E=e.O()}]);