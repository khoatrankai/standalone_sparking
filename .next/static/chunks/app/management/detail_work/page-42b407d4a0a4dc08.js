(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4981],{14673:function(e,l,t){Promise.resolve().then(t.bind(t,64821))},64821:function(e,l,t){"use strict";t.r(l),t.d(l,{default:function(){return ei}});var s=t(57437),n=t(14301),a=t(91626),i=t(42654),r=t(2265),c=t(45168),d=t(59958),o=t(87863),x=t(89970),u=t(24307),m=t(35631),h=t(99376),f=t(82582),v=t(69539),p=t(16836),j=t(68575),g=t(46475);let{TextArea:y}=p.default;function N(){let{datas:e}=(0,j.v9)(e=>e.get_profile),{postdata:l}=(0,g.Z)(),[t,n]=(0,r.useState)(""),[i,c]=(0,r.useState)(!1),[d,p]=(0,r.useState)([]),N=(0,h.useSearchParams)(),w=async()=>{var e;let l=await u.Z.getComments(null!==(e=N.get("id"))&&void 0!==e?e:"");200===l.statusCode&&p(l.data)};(0,r.useEffect)(()=>{w()},[N]);let Z=async()=>{c(!0);let e=await l(()=>{var e;return u.Z.createComment({description:t,work:null!==(e=N.get("id"))&&void 0!==e?e:""})});e&&(c(!1),201===e&&w())};return(0,s.jsxs)("div",{className:"flex flex-col px-4",children:[(0,s.jsx)(f.Z,{avatar:(0,s.jsx)(o.C,{src:null==e?void 0:e.picture_url,alt:"".concat(null==e?void 0:e.first_name," ").concat(null==e?void 0:e.last_name)}),content:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.l0.Item,{children:(0,s.jsx)(y,{onChange:e=>{n(e.target.value)},value:t,rows:4})}),(0,s.jsx)(v.l0.Item,{children:(0,s.jsx)(a.ZP,{htmlType:"submit",loading:i,onClick:Z,type:"primary",children:"Gửi"})})]})}),(0,s.jsx)(m.Z,{pagination:{position:"bottom",align:"center"},header:"".concat(d.length," b\xecnh luận"),dataSource:d,renderItem:e=>{var l,t,n,a,i,r,c;return(0,s.jsx)("li",{children:(0,s.jsx)(f.Z,{author:(0,s.jsxs)("a",{children:[null===(l=e.user_create)||void 0===l?void 0:l.first_name," ",null===(t=e.user_create)||void 0===t?void 0:t.last_name]}),avatar:(0,s.jsx)(o.C,{src:null===(n=e.user_create)||void 0===n?void 0:n.picture_url,alt:"".concat(null===(a=e.user_create)||void 0===a?void 0:a.first_name," ").concat(null===(i=e.user_create)||void 0===i?void 0:i.last_name)}),content:(0,s.jsx)("p",{children:e.description}),datetime:(0,s.jsx)(x.Z,{title:new Date(null!==(r=null==e?void 0:e.created_at)&&void 0!==r?r:"").toLocaleString("vi-VN",{timeZone:"UTC",hour12:!1}),children:(0,s.jsx)("span",{children:new Date(null!==(c=null==e?void 0:e.created_at)&&void 0!==c?c:"").toLocaleString("vi-VN",{timeZone:"UTC",hour12:!1})})})})})}})]})}function w(e){var l,t,n,a,i,r,c,u,m,h,f;let{dataSource:v}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"p-4 bg-gray-100",children:"Th\xf4ng tin chung"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-x-16 gap-y-6 p-4",children:[(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between",children:[(0,s.jsx)("p",{className:"font-base text-gray-400",children:"T\xean c\xf4ng việc"}),(0,s.jsx)("p",{className:"font-medium",children:null==v?void 0:v.name})]}),(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between",children:[(0,s.jsx)("p",{className:"font-base text-gray-400",children:"Trạng th\xe1i"}),(0,s.jsx)("p",{className:"font-medium",children:null==v?void 0:null===(l=v.status)||void 0===l?void 0:l.name})]}),(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between",children:[(0,s.jsx)("p",{className:"font-base text-gray-400",children:"Tiến độ"}),(0,s.jsx)("div",{className:"w-56",children:(null==v?void 0:null===(t=v.tasks)||void 0===t?void 0:t.length)&&v.tasks.length>0?(0,s.jsx)(d.Z,{percent:(null!==(m=null===(n=v.tasks)||void 0===n?void 0:n.filter(e=>"success"===e.status).length)&&void 0!==m?m:0)/(null!==(h=null===(a=v.tasks)||void 0===a?void 0:a.length)&&void 0!==h?h:1)*100}):(0,s.jsx)(d.Z,{percent:100})})]}),(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between",children:[(0,s.jsx)("p",{className:"font-base text-gray-400",children:"Thời gian dự kiến"}),(0,s.jsx)("p",{className:"font-medium",children:new Date(null!==(f=null==v?void 0:v.time_end)&&void 0!==f?f:"").toLocaleDateString("vi-vn")})]}),(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between",children:[(0,s.jsx)("p",{className:"font-base text-gray-400",children:"Người giao việc"}),(0,s.jsxs)("p",{className:"font-medium",children:[null==v?void 0:null===(i=v.user_create)||void 0===i?void 0:i.first_name," ",null==v?void 0:null===(r=v.user_create)||void 0===r?void 0:r.last_name]})]}),(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between",children:[(0,s.jsx)("p",{className:"font-base text-gray-400 min-w-fit",children:"Người thực hiện"}),(0,s.jsx)("div",{className:"flex gap-1 w-full items-center font-medium justify-end",children:(0,s.jsx)(o.C.Group,{max:{count:5,style:{color:"#f56a00",backgroundColor:"#fde3cf"}},children:null==v?void 0:null===(c=v.list_user)||void 0===c?void 0:c.map((e,l)=>{var t,n,a,i;return(0,s.jsx)(x.Z,{title:null!==(n=null!==(t=null==e?void 0:e.first_name)&&void 0!==t?t:""+(null==e?void 0:e.last_name))&&void 0!==n?n:"",placement:"top",children:(0,s.jsx)(o.C,{src:null==e?void 0:e.picture_url,alt:null!==(i=null!==(a=null==e?void 0:e.first_name)&&void 0!==a?a:""+(null==e?void 0:e.last_name))&&void 0!==i?i:"",style:{backgroundColor:"#87d068"}})},l)})})})]}),(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between",children:[(0,s.jsx)("p",{className:"font-base text-gray-400",children:"Ưu ti\xean"}),(0,s.jsx)("p",{className:"font-medium",children:(null==v?void 0:v.urgent)?"L\xe0m gấp":"B\xecnh thường"})]}),(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between",children:[(0,s.jsx)("p",{className:"font-base text-gray-400",children:"Loại c\xf4ng việc"}),(0,s.jsx)("p",{className:"font-medium",children:null==v?void 0:null===(u=v.type)||void 0===u?void 0:u.name})]}),(0,s.jsxs)("div",{className:"flex max-w-md flex-1 min-w-96 justify-between flex-col",children:[(0,s.jsx)("p",{className:"font-base text-gray-400",children:"M\xf4 tả"}),(0,s.jsx)("p",{className:"font-medium break-words text-wrap",children:null==v?void 0:v.description})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"p-4",children:"Thảo luận"}),(0,s.jsx)("div",{children:(0,s.jsx)(N,{})})]})]})})}var Z=t(16114),b=t(79587),k=t(20347),_=t(91250),C=t(94295),S=t(58970),P=t(44967),T=t(29487),F=t(7140),B=t(46783),I=t(32768);let{Dragger:D}=k.default;function W(e){let{refBtnFolder:l,id:t,resetData:n}=e,[c,d]=(0,r.useState)([]),[o]=(0,T.Z)(),{postdata:x}=(0,g.Z)(),[m,h]=(0,r.useState)(!1),f=async e=>{let l=c.map(e=>e.originFileObj),s={...e,url:l,files:c.map(e=>({name:e.name})),work:t},a=(0,b.Z)(s);try{let e=await x(()=>u.Z.createFolder(a));201===e&&(o.resetFields(),h(!1),n())}catch(e){console.error("Error creating product:",e)}},v=async()=>{o.submit()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.ZP,{hidden:!!l,icon:(0,s.jsx)(I.b0B,{}),onClick:()=>{h(!0)},ref:l,children:"Th\xeam folder"}),(0,s.jsxs)(S.Z,{title:"Tạo folder",open:m,onCancel:()=>{h(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,s.jsx)(i.Z,{defaultActiveKey:"1",style:{width:"100%"},type:"line",children:(0,s.jsx)(F.Z,{tab:"Th\xf4ng tin folder",children:(0,s.jsxs)(P.Z,{layout:"vertical",form:o,onFinish:f,style:{display:"flex",flexWrap:"wrap",columnGap:"12px"},children:[(0,s.jsx)(P.Z.Item,{name:"name",label:"T\xean folder",rules:[{required:!0,type:"string",message:"Vui l\xf2ng nhập t\xean folder"}],style:{minWidth:"100%",flex:"1 1 0%"},children:(0,s.jsx)(p.default,{})}),(0,s.jsx)(P.Z.Item,{name:"description",label:"M\xf4 tả",style:{width:"100%"},children:(0,s.jsx)(p.default.TextArea,{placeholder:"M\xf4 tả",autoSize:{minRows:3}})}),(0,s.jsx)(P.Z.Item,{name:"files",label:"Th\xeam file",style:{minWidth:"100%",flex:"1 1 0%"},children:(0,s.jsxs)(D,{name:"file",multiple:!0,onChange(e){let{status:l}=e.file;"uploading"!==l&&d(e.fileList)},onDrop(){},children:[(0,s.jsx)("p",{className:"ant-upload-drag-icon",children:(0,s.jsx)(B.Z,{})}),(0,s.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),(0,s.jsx)("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload. Strictly prohibited from uploading company data or other banned files."})]})})]})},1)}),(0,s.jsx)("div",{className:"flex justify-end w-full mt-4",children:(0,s.jsx)(a.ZP,{type:"primary",onClick:v,children:"Tạo"})})]})]})}let{Dragger:q}=k.default;function E(e){let{refBtnFile:l,id:t,resetData:n}=e,[c,d]=(0,r.useState)([]),[o]=(0,T.Z)(),{postdata:x}=(0,g.Z)(),[m,h]=(0,r.useState)(!1),f=async()=>{let e={url:c.map(e=>e.originFileObj),files:c.map(e=>({name:e.name})),folder:t},l=(0,b.Z)(e);try{let e=await x(()=>u.Z.createFile(l));201===e&&(o.resetFields(),h(!1),n())}catch(e){console.error("Error creating product:",e)}},v=async()=>{o.submit()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.ZP,{hidden:!!l,icon:(0,s.jsx)(I.b0B,{}),onClick:()=>{h(!0)},ref:l,children:"Th\xeam file"}),(0,s.jsxs)(S.Z,{title:"Th\xeam file",open:m,onCancel:()=>{h(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,s.jsx)(i.Z,{defaultActiveKey:"1",style:{width:"100%"},type:"line",children:(0,s.jsx)(F.Z,{tab:"Th\xf4ng tin file",children:(0,s.jsx)(P.Z,{layout:"vertical",form:o,onFinish:f,style:{display:"flex",flexWrap:"wrap",columnGap:"12px"},children:(0,s.jsx)(P.Z.Item,{name:"files",label:"Th\xeam file",style:{minWidth:"100%",flex:"1 1 0%"},children:(0,s.jsxs)(q,{name:"file",multiple:!0,onChange(e){let{status:l}=e.file;"uploading"!==l&&d(e.fileList)},onDrop(){},children:[(0,s.jsx)("p",{className:"ant-upload-drag-icon",children:(0,s.jsx)(B.Z,{})}),(0,s.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),(0,s.jsx)("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload. Strictly prohibited from uploading company data or other banned files."})]})})})},1)}),(0,s.jsx)("div",{className:"flex justify-end w-full mt-4",children:(0,s.jsx)(a.ZP,{type:"primary",onClick:v,children:"Th\xeam"})})]})]})}function L(){var e;let l=(0,h.useSearchParams)(),t=(0,r.useRef)(),n=(0,r.useRef)(),[i,c]=(0,r.useState)([]),[d,o]=(0,r.useState)(""),[x,m]=(0,r.useState)([]),{postdata:f}=(0,g.Z)(),v=(e,l)=>{let t=document.createElement("a");t.href=e,t.setAttribute("download",l),document.body.appendChild(t),t.click(),t.remove()},p=(0,j.I0)(),y=async(e,t)=>{let{file:s}=e;if((null==s?void 0:s.url)&&(null==s?void 0:s.status)==="removed")200===await f(()=>u.Z.deletePictureWork(s.uid))&&N();else{let e={activity:l.get("id"),url:[s.originFileObj],type:t?"start":"end"};if(e){let l=(0,b.Z)(e);201===await f(()=>u.Z.createPictureWork(l))&&N()}}},N=async()=>{let e=l.get("id"),t=await u.Z.getWorkById(null!=e?e:"");if(200===t.statusCode){var s,n,a;let e=t.data;m(null!==(n=e.folders)&&void 0!==n?n:[]),c(null!==(a=null===(s=e.picture_urls)||void 0===s?void 0:s.map(e=>({uid:e.picture_id,name:e.type,status:"done",url:e.url})))&&void 0!==a?a:[])}};return(0,r.useEffect)(()=>{l.get("id")&&N()},[l]),(0,s.jsxs)("div",{className:"my-2 flex flex-col gap-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center text-xs font-medium text-[#EB8823] hover:opacity-85 cursor-pointer mb-2",children:(0,s.jsx)("p",{className:"pointer-events-none",children:"Ảnh c\xf4ng việc"})}),(0,s.jsx)("div",{className:"!m-0",style:{minWidth:"320px",flex:"1 1 0%"},children:(0,s.jsx)(k.default,{action:"",listType:"picture-card",fileList:i,onPreview:e=>{p((0,Z.BZ)(e.url))},onChange:e=>{y(e,!1)},multiple:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex items-center text-xs font-medium text-[#EB8823] hover:opacity-85 mb-2",children:(0,s.jsxs)("p",{className:"flex items-center",children:["Folder",(0,s.jsx)(a.ZP,{type:"link",onClick:()=>{var e;null===(e=t.current)||void 0===e||e.click()},children:(0,s.jsx)(C.S$f,{className:"text-2xl"})})]})}),(0,s.jsx)("div",{children:(0,s.jsx)(_.Z,{columns:[{title:"M\xe3 folder",dataIndex:"folder_id",className:"text-xs"},{title:"T\xean folder",dataIndex:"name",className:"text-xs",render:e=>e?"".concat(e):"N/A"},{title:"M\xf4 tả",dataIndex:"description",className:"text-xs",render:e=>e?"".concat(e):"N/A"},{title:"Danh s\xe1ch file",dataIndex:"description",className:"text-xs",render:(e,l)=>{var t;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[null===(t=l.files)||void 0===t?void 0:t.map(e=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(a.ZP,{type:"link",onClick:()=>{v(e.url,e.name)},children:e.name},e.file_id)})),(0,s.jsx)(a.ZP,{className:"w-fit",onClick:()=>{var e;o(l.folder_id),null===(e=n.current)||void 0===e||e.click()},type:"primary",children:"Th\xeam File"})]})})}}],dataSource:x,scroll:{x:"max-content"},pagination:{showTotal:(e,l)=>"".concat(l[0],"-").concat(l[1]," of ").concat(e," items")},showSorterTooltip:{target:"sorter-icon"}})})]}),(0,s.jsx)(W,{resetData:N,id:null!==(e=l.get("id"))&&void 0!==e?e:"",refBtnFolder:t}),(0,s.jsx)(E,{resetData:N,id:null!=d?d:"",refBtnFile:n})]})}var A=t(90561),R=t(49089),M=t(22744),V=t(18913),G=t(11632);function U(e){var l;let{refBtn:t}=e,[n,i]=(0,r.useState)(),[c,d]=(0,r.useState)([]),{postdata:m}=(0,g.Z)(),[f,v]=(0,r.useState)(!1),[p,y]=(0,r.useState)([]),N=(0,h.useSearchParams)(),{datas:w}=(0,j.v9)(e=>e.get_users),[Z,b]=(0,r.useState)(!1),k=async()=>{var e,l,t;let s=await u.Z.getWorkById(null!==(e=N.get("id"))&&void 0!==e?e:"");200===s.statusCode&&(i(s.data),y(null!==(t=null===(l=s.list_user)||void 0===l?void 0:l.map(e=>e.user_id))&&void 0!==t?t:[]))};(0,r.useEffect)(()=>{w&&d(w.map(e=>{var l;return{label:e.first_name+" "+e.last_name,value:e.user_id,group:null===(l=e.group_user)||void 0===l?void 0:l.name_group}}))},[w]);let _=async()=>{let e=await m(()=>{var e;return u.Z.updateWork(null!==(e=N.get("id"))&&void 0!==e?e:"",{list_users:p})});(200===e||201===e)&&(k(),v(!1))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.ZP,{ref:t,hidden:!!t,onClick:()=>{b(!0),k()}}),(0,s.jsx)(S.Z,{title:"Danh s\xe1ch thực hiện",open:Z,onCancel:()=>{b(!1)},footer:null,width:"100%",style:{maxWidth:"600px"},children:(0,s.jsxs)("div",{className:"flex flex-col",children:[null==n?void 0:null===(l=n.list_user)||void 0===l?void 0:l.map(e=>{var l,t;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex gap-2 cursor-pointer hover:bg-gray-100 p-2 rounded-sm items-center",children:[(0,s.jsx)(o.C,{src:e.picture_url}),(0,s.jsxs)("div",{className:"flex text-xs flex-col h-full justify-between",children:[(0,s.jsxs)("p",{className:"font-medium",children:[e.first_name," ",e.last_name]}),(0,s.jsx)("p",{className:"text-gray-400",children:null==w?void 0:null===(t=w.find(e=>e.user_id==e.user_id))||void 0===t?void 0:null===(l=t.group_user)||void 0===l?void 0:l.name_group})]})]})})}),f?(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(o.C.Group,{max:{count:5,style:{color:"#f56a00",backgroundColor:"#fde3cf"}},children:null==p?void 0:p.map((e,l)=>{var t,n,a,i;let r=null==w?void 0:w.find(l=>l.user_id===e);return(0,s.jsx)(x.Z,{title:null!==(n=null!==(t=null==r?void 0:r.first_name)&&void 0!==t?t:""+(null==r?void 0:r.last_name))&&void 0!==n?n:"",placement:"top",children:(0,s.jsx)(o.C,{src:null==r?void 0:r.picture_url,alt:null!==(i=null!==(a=null==r?void 0:r.first_name)&&void 0!==a?a:""+(null==r?void 0:r.last_name))&&void 0!==i?i:"",style:{backgroundColor:"#87d068"}})},l)})}),f?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(G.Z,{mode:"multiple",allowClear:!0,maxTagCount:"responsive",style:{width:"220px"},value:p,placeholder:"Please select",onChange:e=>{y(e)},options:null==c?void 0:c.map(e=>({label:(0,s.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:e.label}),(0,s.jsx)("div",{style:{fontSize:"12px",color:"gray"},children:e.group})]})}),value:e.value}))}),(0,s.jsx)(R.FJM,{className:"w-6 h-6 text-green-500 cursor-pointer",onClick:e=>{_(),e.stopPropagation(),e.preventDefault()}})]}):(0,s.jsx)(C.S$f,{className:"w-8 h-8 text-[#ED8C1F] cursor-pointer",onClick:()=>{v(!f)}})]}):(0,s.jsx)(a.ZP,{icon:(0,s.jsx)(C.zUF,{className:"text-2xl"}),className:"flex gap-2 cursor-pointer hover:bg-gray-100 p-2 rounded-sm items-center",onClick:()=>{v(!0)},children:(0,s.jsx)("p",{children:"Thay đổi"})})]})})]})}var O=t(88723);function z(e){var l,t,i,d,o,x,m,f,p;let{refBtn:j}=e,y=(0,r.useRef)(),{postdata:N}=(0,g.Z)(),w=(0,h.useSearchParams)(),[Z,b]=(0,r.useState)(!1),[k,_]=(0,r.useState)(),P=async()=>{var e;let l=await u.Z.getWorkById(null!==(e=w.get("id"))&&void 0!==e?e:"");200===l.statusCode&&_(l.data)};(0,r.useEffect)(()=>{w.get("id")&&P()},[w]);let T=e=>(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"p-2 flex flex-col w-full",children:[(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(M.f$3,{}),(0,s.jsxs)("p",{className:"break-words text-wrap",children:[new Date(e.time_start).toLocaleString("vi-VN",{timeZone:"UTC",hour12:!1})," - ",new Date(e.time_end).toLocaleString("vi-VN",{timeZone:"UTC",hour12:!1})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(c.kk4,{}),(0,s.jsx)("p",{className:"break-words text-wrap",children:e.description})]})]})}),F=async(e,l)=>{let t=await N(()=>u.Z.updateTask(e,{status:l}));(200===t||201===t)&&P()};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.ZP,{ref:j,hidden:!0,onClick:()=>{b(!0)}}),(0,s.jsx)(S.Z,{title:"Danh s\xe1ch task",open:Z,footer:null,onCancel:()=>{b(!1)},width:"600px",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(R.AEx,{}),(0,s.jsx)("p",{children:"Task"}),(0,s.jsx)(a.ZP,{className:"text-2xl",icon:(0,s.jsx)(C.S$f,{}),type:"link",onClick:()=>{var e;null===(e=y.current)||void 0===e||e.click()}})]}),(0,s.jsx)(v.Ex,{percent:(null!==(x=null==k?void 0:null===(l=k.tasks)||void 0===l?void 0:l.filter(e=>"waitting"===e.status).length)&&void 0!==x?x:0)/(null!==(m=null==k?void 0:null===(t=k.tasks)||void 0===t?void 0:t.length)&&void 0!==m?m:1)*100,success:{percent:(null!==(f=null==k?void 0:null===(i=k.tasks)||void 0===i?void 0:i.filter(e=>"success"===e.status).length)&&void 0!==f?f:0)/(null!==(p=null==k?void 0:null===(d=k.tasks)||void 0===d?void 0:d.length)&&void 0!==p?p:1)*100}}),(0,s.jsx)("div",{className:"flex flex-col gap-2 p-2",children:null==k?void 0:null===(o=k.tasks)||void 0===o?void 0:o.map(e=>"waitting"===e.status?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(n.Z,{title:e.name.toUpperCase(),content:T(e),trigger:"hover",children:(0,s.jsxs)("p",{className:"py-2 border-b-[1px] flex justify-between items-center",children:[e.name,(0,s.jsxs)("span",{className:"flex",children:[(0,s.jsx)(a.ZP,{icon:(0,s.jsx)(R.FJM,{className:"text-green-400 text-2xl"}),type:"link",onClick:()=>{F(e.task_id,"success")}})," ",(0,s.jsx)(a.ZP,{icon:(0,s.jsx)(C.FMH,{className:"text-red-400  text-3xl"}),type:"link",onClick:()=>{F(e.task_id,"fail")}})," "]})]})})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(n.Z,{title:e.name,content:T(e),trigger:"hover",children:(0,s.jsx)("p",{className:"py-2 border-b-[1px] text-green-400",children:e.name})})}))}),(0,s.jsx)(O.Z,{refBtnTask:y,id:w.get("id"),resetData:P})]})})]})}var K=t(64150),H=t(55846),J=t(56612),$=t(45747),Q=t(84641);function X(e){var l,t,n;let{refBtn:i,handleOnclick:c}=e,{postdata:o}=(0,g.Z)(),x=(0,h.useSearchParams)(),[m,f]=(0,r.useState)(!1),v=[{quality:"good",name:"Tốt"},{quality:"excellent",name:"Xuất sắc"},{quality:"satisfactory",name:"Đạt y\xeau cầu"},{quality:"fail",name:"Thất bại"},{quality:"needs_improvement",name:"Chưa đạt y\xeau cầu"}],j=[{status:"fail",name:"Thất bại"},{status:"waitting",name:"Đang thực hiện"},{status:"success",name:"Ho\xe0n th\xe0nh"}],[y,N]=(0,r.useState)({progress:5,status:"waitting"}),w=async()=>{201===await o(()=>u.Z.createReview({...y,work:x.get("id")}))&&(f(!1),c())};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.ZP,{hidden:!!i,className:"  text-xs text-yellow-500 font-semibold",type:"text",ref:i,onClick:()=>{f(!0)}}),(0,s.jsxs)(Q.Z,{title:"Mẫu đ\xe1nh gi\xe1",open:m,onCancel:()=>{f(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:"flex flex-col w-fit",children:[(0,s.jsx)("p",{className:"font-semibold p-2 border-[1px] min-h-14 flex items-center",children:"Ti\xeau ch\xed đ\xe1nh gi\xe1"}),(0,s.jsx)("p",{className:"p-2 border-[1px] min-h-14 flex items-center",children:"Tiến độ c\xf4ng việc"}),(0,s.jsx)("p",{className:"p-2 border-[1px] min-h-14 flex items-center",children:"Chất lượng c\xf4ng việc"}),(0,s.jsx)("p",{className:"p-2 border-[1px] min-h-14 flex items-center",children:"Thời gian ho\xe0n th\xe0nh"}),(0,s.jsx)("p",{className:"p-2 border-[1px] min-h-14 flex items-center",children:"Trạng th\xe1i"}),(0,s.jsx)("p",{className:"p-2 border-[1px] min-h-14 flex items-center",children:"\xdd kiến"})]}),(0,s.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,s.jsx)("p",{className:"font-semibold p-2 border-[1px] min-h-14 flex items-center",children:"Người thực hiện b\xe1o c\xe1o"}),(0,s.jsx)("div",{className:"p-2 border-[1px] min-h-14 flex items-center",children:(0,s.jsx)(d.Z,{percent:y.progress})}),(0,s.jsx)("p",{className:"p-2 border-[1px] min-h-14 flex items-center",children:null===(l=v.find(e=>y.quality===e.quality))||void 0===l?void 0:l.name}),(0,s.jsx)("p",{className:"p-2 border-[1px] min-h-14 flex items-center",children:null===(t=y.time_end)||void 0===t?void 0:t.toLocaleDateString("vi-VN")}),(0,s.jsx)("p",{className:"p-2 border-[1px] min-h-14 flex items-center",children:null===(n=j.find(e=>y.status===e.status))||void 0===n?void 0:n.name})]}),(0,s.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,s.jsx)("p",{className:"font-semibold p-2 border-[1px] min-h-14 flex items-center",children:"Người quản l\xfd đ\xe1nh gi\xe1"}),(0,s.jsx)("div",{className:"p-2 border-[1px]  min-h-14 flex items-center",children:(0,s.jsxs)(H.ZP.Group,{defaultValue:"5",size:"small",onChange:e=>{"100"===e.target.value&&N(e=>({...e,status:"success"})),"100"!==e.target.value&&N(e=>({...e,status:"waitting"})),N(l=>({...l,progress:Number(e.target.value)}))},children:[(0,s.jsx)(H.ZP.Button,{value:"5",children:"5"}),(0,s.jsx)(H.ZP.Button,{value:"10",children:"10"}),(0,s.jsx)(H.ZP.Button,{value:"20",children:"20"}),(0,s.jsx)(H.ZP.Button,{value:"30",children:"30"}),(0,s.jsx)(H.ZP.Button,{value:"50",children:"50"}),(0,s.jsx)(H.ZP.Button,{value:"70",children:"70"}),(0,s.jsx)(H.ZP.Button,{value:"80",children:"80"}),(0,s.jsx)(H.ZP.Button,{value:"90",children:"90"}),(0,s.jsx)(H.ZP.Button,{value:"100",children:"100"})]})}),(0,s.jsx)("div",{className:"p-2 border-[1px] min-h-14 flex items-center",children:(0,s.jsx)(G.Z,{placeholder:"Chọn",className:"w-full",onChange:e=>{N(l=>({...l,quality:e}))},children:v.map(e=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)($.W,{value:e.quality,children:e.name},e.quality)}))})}),(0,s.jsx)("div",{className:"p-2 border-[1px] min-h-14 flex items-center",children:(0,s.jsx)(J.default,{className:"w-full",onChange:e=>{N(l=>({...l,time_end:e?new Date(e.toString()):void 0}))}})}),(0,s.jsx)("div",{className:"p-2 border-[1px] min-h-14 flex items-center",children:(0,s.jsx)(G.Z,{placeholder:"Chọn",className:"w-full",value:y.status,onChange:e=>{N(l=>({...l,status:e}))},children:j.map(e=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)($.W,{value:e.status,children:e.name},e.status)}))})})]})]}),(0,s.jsx)("div",{className:"p-2 border-[1px] h-full flex items-center",children:(0,s.jsx)(p.default,{placeholder:"\xdd kiến đ\xe1nh gi\xe1",onChange:e=>{N(l=>({...l,description:e.target.value}))}})})]})]}),(0,s.jsxs)("div",{className:"flex w-full justify-start mt-4 gap-2",children:[(0,s.jsx)(a.ZP,{type:"primary",onClick:()=>{w()},children:"Đ\xe1nh gi\xe1"}),(0,s.jsx)(a.ZP,{children:"Hủy bỏ"})]})]})]})}var Y=t(3810);function ee(e){let{refBtn:l,dataSource:t}=e,[n,i]=(0,r.useState)(!1),c=[{quality:"good",star:4},{quality:"excellent",star:5},{quality:"satisfactory",star:3},{quality:"needs_improvement",star:2},{quality:"fail",star:1}],d=[{title:"Người đ\xe1nh gi\xe1",className:"text-xs",dataIndex:"user",render:(e,l)=>{var t,n,a,i,r;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(o.C,{src:null==l?void 0:null===(t=l.user_create)||void 0===t?void 0:t.picture_url,alt:null!==(r=null!==(i=null==l?void 0:null===(n=l.user_create)||void 0===n?void 0:n.first_name)&&void 0!==i?i:""+(null==l?void 0:null===(a=l.user_create)||void 0===a?void 0:a.last_name))&&void 0!==r?r:"",style:{backgroundColor:"#87d068"}})})}},{title:"Thời gian",dataIndex:"name",className:"text-xs",render:(e,l)=>{var t;return new Date(null!==(t=null==l?void 0:l.created_at)&&void 0!==t?t:"").toLocaleString("vi-VN",{timeZone:"UTC",hour12:!1})||"N/A"}},{title:"Đ\xe1nh gi\xe1 tiến độ",dataIndex:"progress",className:"text-xs",render:e=>e?"".concat(e,"%"):"N/A"},{title:"Kết quả đ\xe1nh gi\xe1",dataIndex:["quality"],className:"text-xs",render:e=>{var l,t;let n=c.find(l=>l.quality===e);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[Array.from({length:null!==(l=null==n?void 0:n.star)&&void 0!==l?l:0}).map(()=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(R.QJe,{className:"text-yellow-500"})})),Array.from({length:5-(null!==(t=null==n?void 0:n.star)&&void 0!==t?t:0)}).map(()=>(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(R.QJe,{})})),(0,s.jsx)("p",{className:"font-semibold capitalize",children:e})]})})}},{title:"\xdd kiến đ\xe1nh gi\xe1",dataIndex:"description",className:"text-xs",render:e=>e||"N/A"},{title:"Trạng th\xe1i",dataIndex:"status",className:"text-xs",render:e=>{let l="",t="";switch(e){case"success":l="green",t="Ho\xe0n th\xe0nh";break;case"fail":l="red",t="Thất bại";break;case"waitting":l="gold",t="Đang thực hiện";break;default:l="default",t="Kh\xf4ng x\xe1c định"}return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(Y.Z,{color:l,children:t})})}},{title:"Kết th\xfac thực tế",dataIndex:"time_end",className:"text-xs",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A"}];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.ZP,{hidden:!!l,className:"  text-xs text-yellow-500 font-semibold",type:"text",ref:l,onClick:()=>{i(!0)}}),(0,s.jsx)(Q.Z,{title:"Lịch sử đ\xe1nh gi\xe1",open:n,onCancel:()=>{i(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:(0,s.jsx)(_.Z,{columns:d,dataSource:t,scroll:{x:"max-content"},pagination:{showTotal:(e,l)=>"".concat(l[0],"-").concat(l[1]," of ").concat(e," items")},showSorterTooltip:{target:"sorter-icon"}})})]})}let el={display:"flex",flexDirection:"column",gap:8};function et(e){var l,t,n;let{work:a,fetchData:i}=e,{postdata:c}=(0,g.Z)(),d=(0,h.useSearchParams)(),{datas:o}=(0,j.v9)(e=>e.get_type_work),x=async e=>{200===await c(()=>{var l;return u.Z.updateWork(null!==(l=null==a?void 0:a.work_id)&&void 0!==l?l:"",{status:e.target.value})})&&i()};return(0,r.useEffect)(()=>{d.get("id")&&i()},[d]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(H.ZP.Group,{style:el,onChange:x,value:null==a?void 0:null===(l=a.status)||void 0===l?void 0:l.status_work_id,options:null===(n=o.find(e=>{var l;return e.type_work_id===(null==a?void 0:null===(l=a.type)||void 0===l?void 0:l.type_work_id)}))||void 0===n?void 0:null===(t=n.status)||void 0===t?void 0:t.map(e=>({label:e.name,value:e.status_work_id}))})})}function es(){let[e,l]=(0,r.useState)([]),[t,d]=(0,r.useState)(),[o,x]=(0,r.useState)(!1),m=(0,h.useSearchParams)(),f=(0,r.useRef)(),v=(0,r.useRef)(),p=(0,r.useRef)(),j=(0,r.useRef)(),g=(0,r.useRef)(),y=async()=>{var e,t,s;let n=await u.Z.getReviews(null!==(e=m.get("id"))&&void 0!==e?e:""),a=await u.Z.getWorkById(null!==(t=m.get("id"))&&void 0!==t?t:""),i=await u.Z.checkReview(null!==(s=m.get("id"))&&void 0!==s?s:"");200===n.statusCode&&l(n.data),200===i.statusCode&&x(i.data),200===a.statusCode&&d(a.data)};(0,r.useEffect)(()=>{y()},[]);let N=()=>{y()},Z=[{label:(0,s.jsx)("p",{className:"text-xs font-medium",children:"Chi tiết"}),key:"detail",children:(0,s.jsx)(w,{dataSource:t})},{label:(0,s.jsx)("p",{className:"text-xs font-medium",children:"Đ\xednh k\xe8m"}),key:"attach",children:(0,s.jsx)(L,{})}];return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex px-4 flex-col",children:(0,s.jsx)(i.Z,{className:"w-full custom-tabs 1text-xs !font-medium",items:Z,tabBarExtraContent:(0,s.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,s.jsx)(n.Z,{content:(0,s.jsx)(et,{fetchData:y,work:t}),children:(0,s.jsxs)(a.ZP,{className:"flex flex-col items-center justify-center h-16",type:"text",children:[(0,s.jsx)(c.hwI,{className:"text-xl"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"Trạng th\xe1i"})]})}),(0,s.jsxs)(a.ZP,{className:"flex flex-col items-center justify-center h-16",type:"text",onClick:()=>{var e;null===(e=f.current)||void 0===e||e.click()},children:[(0,s.jsx)(A.i9Z,{className:"text-xl"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"Thực hiện"})]}),(0,s.jsxs)(a.ZP,{className:"flex flex-col items-center justify-center h-16",type:"text",onClick:()=>{var e;null===(e=g.current)||void 0===e||e.click()},children:[(0,s.jsx)(R.W95,{className:"text-xl"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"Đầu việc"})]}),o?(0,s.jsx)(s.Fragment,{children:e.length>0?(0,s.jsxs)(a.ZP,{className:"flex flex-col items-center justify-center h-16",type:"text",onClick:()=>{var e;null===(e=p.current)||void 0===e||e.click()},children:[(0,s.jsx)(R.ceS,{className:"text-xl"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"Lịch sử đ\xe1nh gi\xe1"})]}):(0,s.jsxs)(a.ZP,{className:"flex flex-col items-center justify-center h-16",type:"text",onClick:()=>{var e;null===(e=v.current)||void 0===e||e.click()},children:[(0,s.jsx)(M.b12,{className:"text-xl"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"Đ\xe1nh gi\xe1"})]})}):(0,s.jsx)(s.Fragment,{children:e.length>0?(0,s.jsxs)(a.ZP,{className:"flex flex-col items-center justify-center h-16",type:"text",onClick:()=>{var e;null===(e=p.current)||void 0===e||e.click()},children:[(0,s.jsx)(R.ceS,{className:"text-xl"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"Lịch sử đ\xe1nh gi\xe1"})]}):(0,s.jsx)(s.Fragment,{})}),(0,s.jsxs)(a.ZP,{className:"flex flex-col items-center justify-center h-16",type:"text",children:[(0,s.jsx)(V.rkW,{className:"text-xl"}),(0,s.jsx)("span",{className:"text-xs font-medium",children:"B\xe1o c\xe1o"})]})]}),tabPosition:"top"})}),(0,s.jsx)(U,{refBtn:f}),(0,s.jsx)(z,{refBtn:g}),(0,s.jsx)(K.Z,{refBtnWork:j}),(0,s.jsx)(X,{refBtn:v,handleOnclick:()=>N()}),(0,s.jsx)(ee,{refBtn:p,dataSource:e})]})}var en=t(96248),ea=t(41259);function ei(){let e=(0,j.I0)();return(0,r.useEffect)(()=>{e((0,ea.C)()),e((0,en.D)())},[]),(0,s.jsx)("div",{children:(0,s.jsx)(es,{})})}},16114:function(e,l,t){"use strict";t.d(l,{BZ:function(){return n},Ln:function(){return a}});let s=(0,t(20301).oM)({name:"image-preview",initialState:{value:""},reducers:{onChangeImagePreview:(e,l)=>{e.value=l.payload},onDeleteImagePreview:e=>{e.value=""}}}),{onChangeImagePreview:n,onDeleteImagePreview:a}=s.actions;l.ZP=s.reducer}},function(e){e.O(0,[5652,6051,7699,5706,5452,1994,6950,522,3665,8422,5319,5651,6006,8143,7526,7464,7821,3464,9481,314,9970,5270,1412,3281,7651,6399,5422,1250,8970,4967,3569,3344,6498,3984,136,6612,480,7580,8026,8230,9590,3477,8839,1388,4599,6966,2883,9626,4519,6081,2971,2117,1744],function(){return e(e.s=14673)}),_N_E=e.O()}]);