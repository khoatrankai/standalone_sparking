(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5980],{95746:function(e,t,a){Promise.resolve().then(a.bind(a,45984))},45984:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var r=a(57437),n=a(78687),i=a(2265),s=a(82762),o=a(45008),c=a(73609),d=a(14301),l=a(84154),u=a(32768);function p(){let e=(0,o._)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: flex-start;\n  gap: 2px;\n  min-height: 80px;\n  border-radius: 5px;\n  overflow: hidden;\n  max-width: 311px;\n  background: white;\n  margin-top: 15px;\n\n  .secondary-details {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    width: 100%;\n    font-size: 12px;\n    font-weight: 400px;\n    color: #7d7d7d;\n  }\n  /* .priority{ */\n  /* margin-right: 12px; */\n  /* align-self: center;\n    svg{\n      width: 12px !important;\n      height: 12px !important;\n      margin-right: 12px; */\n  /* margin-top: 2px; */\n  /* } */\n  /* } */\n"]);return p=function(){return e},e}let g=c.Z.div(p());var h=e=>{let{item:t,index:a}=e,n=(0,i.useRef)();return(0,r.jsx)(s._l,{draggableId:t.price_quote_id,index:a,children:e=>{var a,i;return(0,r.jsx)("div",{onClick:()=>{},ref:e.innerRef,...e.draggableProps,...e.dragHandleProps,children:(0,r.jsx)(g,{className:"shadow-[0px_2px_3px_-1px_rgba(0,0,0,0.1),0px_1px_0px_0px_rgba(25,28,33,0.02),0px_0px_0px_1px_rgba(25,28,33,0.08)]",onClick:()=>{var e;null===(e=n.current)||void 0===e||e.click()},children:(0,r.jsxs)("div",{className:"p-3 w-full flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex justify-between w-full",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("p",{className:"text-sm font-semibold",children:["B\xe1o gi\xe1 ",t.reference_code]})}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"secondary-details",children:(0,r.jsx)("p",{children:(0,r.jsx)("span",{children:new Date(t.created_at).toLocaleDateString("en-us",{month:"short",day:"2-digit"})})})})})]}),(0,r.jsxs)("div",{className:"flex justify-between w-full",children:[(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(d.Z,{content:t.description,children:(0,r.jsx)(u.lIk,{})}),(0,r.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,r.jsx)(l.G1z,{}),(0,r.jsx)("p",{className:"text-xs font-light",children:null!==(i=null===(a=t.parts)||void 0===a?void 0:a.length)&&void 0!==i?i:0})]})]}),(0,r.jsx)("p",{className:"text-xs text-black/40 font-bold",children:t.project.name})]})]})})})}},t.price_quote_id)},x=a(68575),f=a(16534),m=a(46475),y=a(18528),v=a(64439),_=()=>{let[e,t]=(0,i.useState)([]),a=["draff","send","open","edit","refuse","accept"],{postdata:n}=(0,m.Z)(),o=(0,x.I0)();(0,i.useEffect)(()=>{o((0,y.j)({}))},[]);let{datas:c}=(0,x.v9)(e=>e.get_price_quotes);(0,i.useEffect)(()=>{c&&t(a.map(e=>{let t=c.filter(t=>t.status===e);return{status:e,data:t}}))},[c]);let d=async e=>{let t=e.map(e=>e.data.map(t=>({price_quote_id:t.price_quote_id,status:e.status}))).flat();200===await n(()=>v.Z.updateStatusListPriceQuote(t))&&o((0,y.j)({}))},l=(e,t,a)=>{if(!e.destination)return;let{source:r,destination:n}=e;if(r.droppableId!==n.droppableId){let e=t[Number(r.droppableId)],i=t[Number(n.droppableId)],s=[...e.data],o=[...i.data],[c]=s.splice(r.index,1);o.splice(n.index,0,c),a(e=>e.map((e,t)=>t===Number(r.droppableId)?{...e,data:s}:t===Number(n.droppableId)?{...e,data:o}:e)),d(t.map((e,t)=>t===Number(r.droppableId)?{...e,data:s}:t===Number(n.droppableId)?{...e,data:o}:e))}};return(0,r.jsx)(s.Z5,{onDragEnd:a=>{l(a,e,t)},children:(0,r.jsx)("div",{className:"flex sm:justify-normal justify-center",children:(0,r.jsx)("div",{className:"flex w-full min-h-[60vh] flex-wrap gap-4 sm:justify-normal justify-center",children:Object.entries(e).map(e=>{let[t,a]=e;return(0,r.jsx)(s.bK,{droppableId:t,children:e=>(0,r.jsxs)("div",{className:"bg-gray-100",style:{minHeight:"100px",display:"flex",maxHeight:"fit-content",flexDirection:"column",minWidth:"300px",borderRadius:"15px",padding:"15px 15px"},ref:e.innerRef,...e.droppableProps,children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("div",{style:{fontWeight:"bold",color:"#1BA29B",fontSize:16,marginBottom:"1.5px"},children:"draff"===a.status?"Nh\xe1p":"send"===a.status?"Đ\xe3 gửi":"open"===a.status?"Đ\xe3 Xem":"edit"===a.status?"Đang chỉnh sửa":"refuse"===a.status?"Từ chối":"Chấp nhận"}),(0,r.jsx)("div",{children:(0,r.jsx)(f.P66,{})})]}),(0,r.jsx)("div",{className:"max-h-[70vh] overflow-auto min-h-8",children:a.data.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).map((e,t)=>(console.log(new Date(e.updated_at).getTime()),(0,r.jsx)(h,{item:e,index:t},t)))}),(0,r.jsx)("div",{})]})},t)})})})})},j=a(65624);function w(){let e=(0,x.I0)(),t=(0,j.Z)(["admin-top","price_quote","price_quote-read"]);return(0,i.useEffect)(()=>{t&&e((0,y.j)({}))},[e,t]),(0,r.jsx)("div",{className:"sm:p-8 p-2 bg-[#001529] h-full ",children:t?(0,r.jsx)(_,{}):(0,r.jsx)(n.Z,{})})}},78687:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var r=a(57437),n=a(71047),i=a(91626);function s(){return(0,r.jsx)(n.ZP,{status:"403",title:"403",subTitle:"Sorry, you are not authorized to access this page.",extra:(0,r.jsx)(i.ZP,{type:"primary",children:"Quay lại"})})}a(2265)},46475:function(e,t,a){"use strict";var r=a(2265),n=a(7261);t.Z=()=>{let[e,t]=(0,r.useState)(null),[a,i]=(0,r.useState)(null);return{postdata:async e=>{let a=n.Am.loading("Processing...");try{let r=await e();if(r)return t(r),i(r.statusCode),200===r.statusCode||201===r.statusCode?n.Am.update(a,{render:r.message,type:"success",isLoading:!1,autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):n.Am.update(a,{render:r.message,type:"error",isLoading:!1,position:"bottom-center",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),r.statusCode;return n.Am.update(a,{render:"No response received.",type:"error",isLoading:!1,autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),null}catch(e){n.Am.update(a,{render:"An unexpected error occurred",type:"error",isLoading:!1,autoClose:3e3})}},statusCode:a,response:e}}},18528:function(e,t,a){"use strict";a.d(t,{j:function(){return i}});var r=a(20301),n=a(64439);let i=(0,r.hg)("pricequote/fetchPriceQuotes",async(e,t)=>{try{return await n.Z.getPriceQuotes(e)}catch(e){return t.rejectWithValue("Failed to fetch opportunities")}}),s=(0,r.oM)({name:"pricequote",initialState:{datas:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,t)=>{200===t.payload.statusCode?(e.loading=!1,e.datas=t.payload.data):(e.loading=!1,e.error="Unexpected status code")}).addCase(i.rejected,(e,t)=>{e.loading=!1,e.error=t.payload})}}).reducer;t.Z=s},28223:function(e,t,a){"use strict";a.d(t,{Y:function(){return i}});var r=a(83464);let n=r.Z.create({baseURL:"https://api.sparking.cloud",timeout:2e4,headers:{"Content-Type":"application/json"},withCredentials:!0}),i=r.Z.create({baseURL:"https://api.sparking.cloud",timeout:2e4,headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});t.Z=n},64439:function(e,t,a){"use strict";var r=a(28223),n=a(90382);t.Z={createPriceQuote:async e=>{try{return(await r.Z.post("/price_quote",e)).data}catch(e){throw(0,n.S)(e),e}},updatePriceQuote:async(e,t)=>{try{return(await r.Z.put("/price_quote/id/".concat(e),t)).data}catch(e){throw(0,n.S)(e),e}},updateStatusListPriceQuote:async e=>{try{return(await r.Z.put("/price_quote/list",e)).data}catch(e){throw(0,n.S)(e),e}},getPriceQuotes:async e=>{try{let t=new URLSearchParams;return e&&Object.entries(e).forEach(e=>{let[a,r]=e;null!=r&&t.append(a,r)}),(await r.Z.get("/price_quote/all?".concat(t.toString()))).data}catch(e){throw(0,n.S)(e),e}},getPriceQuoteByOpportunityID:async e=>{try{return(await r.Z.get("/price_quote/by-opportunity/".concat(e))).data}catch(e){throw(0,n.S)(e),e}},deletePriceQuotes:async e=>{try{return(await r.Z.delete("/price_quote",{data:e})).data}catch(e){throw(0,n.S)(e),e}},getPriceQuoteID:async e=>{try{return(await r.Z.get("/price_quote/id/".concat(e))).data}catch(e){throw(0,n.S)(e),e}},getPriceQuoteDashboard:async()=>{try{return(await r.Z.get("/price_quote/dashboard")).data}catch(e){throw(0,n.S)(e),e}},getPriceQuoteRevenueByName:async e=>{try{return(await r.Z.get("/price_quote/revenue-by-name?name=".concat(e))).data}catch(e){throw(0,n.S)(e),e}},getExportPriceQuote:async e=>{try{return(await r.Z.get("/price_quote/export/".concat(e))).data}catch(e){throw(0,n.S)(e),e}},getTypePackages:async()=>(await r.Z.get("/price_quote/type-package")).data,createTypePackage:async e=>{let t=await r.Z.post("/price_quote/type-package",e);if(!t)throw Error("Failed to create type_package price_quote: No response");return t.data},updateTypePackage:async(e,t)=>{let a=await r.Z.put("/price_quote/type-package/".concat(e),{name_package:t});if(!a)throw Error("Failed to update type_package product: No response");return a.data},deleteTypePackage:async e=>(await r.Z.delete("/price_quote/type-package",{data:e})).data}},65624:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var r=a(2265),n=a(68575);function i(e){let[t,a]=(0,r.useState)(!1),{datas:i}=(0,n.v9)(e=>e.get_access_roles);return(0,r.useEffect)(()=>{i&&(null==i?void 0:i.length)>0&&a(i.some(t=>e.includes(t.role_type.name_tag)))},[i,e]),t}},90382:function(e,t,a){"use strict";a.d(t,{S:function(){return n}});var r=a(7261);let n=e=>{var t,a,n;let i=(null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.message)||"An unexpected error occurred",s=null===(n=e.response)||void 0===n?void 0:n.status;r.Am.dismiss(),403===s?r.Am.error("Bạn kh\xf4ng c\xf3 quyền"):r.Am.error(i)}}},function(e){e.O(0,[5706,522,3217,3338,5319,5651,6006,1047,8143,7526,7464,7821,3464,9970,3281,3609,1627,2971,2117,1744],function(){return e(e.s=95746)}),_N_E=e.O()}]);