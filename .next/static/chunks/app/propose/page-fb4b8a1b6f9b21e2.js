(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4365],{75684:function(e,t,l){Promise.resolve().then(l.bind(l,49815))},49815:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return A}});var a=l(57437),s=l(2265),n=l(56612),r=l(11632),i=l(46475),d=l(28223),o=l(90382),c=async e=>{try{return(await d.Z.post("/propose",{...e,price:Number(e.price)})).data}catch(e){throw(0,o.S)(e),e}},u=l(91626),h=l(58970),x=l(42654),m=l(44967),p=l(16836),v=l(90136),f=l(91250),j=l(29487),g=l(28826),y=l(45747),_=l(7140),b=l(32768),N=l(22744),Z=l(68575);function w(){let{datas:e}=(0,Z.v9)(e=>e.province_system),{datas:t}=(0,Z.v9)(e=>e.vat_system),[l,n]=(0,s.useState)(!1),[d,o]=(0,s.useState)([]),w=[{title:"Loại sản phẩm",dataIndex:"type",key:"type",render:e=>(0,a.jsx)("div",{className:"flex gap-1 items-center",children:"VT"===e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"min-w-1 min-h-1 rounded-full bg-blue-500"}),(0,a.jsx)("div",{className:"min-w-1 min-h-1 rounded-full bg-blue-500"}),e]}):(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)("div",{className:"min-w-1 min-h-1 rounded-full bg-red-500"}),e]})})},{title:"M\xe3 sản phẩm",dataIndex:"code_product",key:"code_product"},{title:"T\xean sản phẩm",dataIndex:"name_product",key:"name_product"},{title:"Số lượng",dataIndex:"quantity_product",key:"quantity"},{title:"M\xf4 tả",dataIndex:"description",key:"description"},{title:"Thuế VAT",dataIndex:"vat",key:"vat",render:e=>{var l;return(0,a.jsxs)(a.Fragment,{children:[null==t?void 0:null===(l=t.find(t=>t.vat_id===e))||void 0===l?void 0:l.type_vat,"%"]})}},{title:"Gi\xe1 sản phẩm (VNĐ)",dataIndex:"price_product",key:"price_product",render:e=>"".concat(e.toLocaleString("vi-VN"),"đ")},{title:"",dataIndex:"",key:"",render:()=>(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(u.ZP,{type:"primary",className:"bg-yellow-500",icon:(0,a.jsx)(N.zmo,{})}),(0,a.jsx)(u.ZP,{type:"primary",className:"bg-red-500",icon:(0,a.jsx)(N.ZkW,{})})]})}],[C]=(0,j.Z)(),[W]=(0,j.Z)(),{datas:S}=(0,Z.v9)(e=>e.infos_customer),{postdata:I}=(0,i.Z)(),{datas:T}=(0,Z.v9)(e=>e.get_users),[k,q]=(0,s.useState)(),[L,A]=(0,s.useState)(!1),P=async e=>{let t=await I(()=>c(e));(200===t||201===t)&&A(!1)},V=async e=>{console.log(e),o([...d,e])},O=async()=>{C.submit()};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.ZP,{className:"bg-blue-400 border-0 text-white font-semibold",icon:(0,a.jsx)(b.b0B,{}),onClick:()=>{A(!0)},children:"Th\xeam đề xuất"}),(0,a.jsxs)(h.Z,{title:"Tạo đề xuất",open:L,onCancel:()=>{A(!1)},footer:null,width:"100%",style:{maxWidth:"800px"},children:[(0,a.jsxs)(x.Z,{defaultActiveKey:"1",style:{width:"100%"},type:"line",children:[(0,a.jsx)(_.Z,{tab:"Th\xf4ng tin đề xuất",children:(0,a.jsxs)(m.Z,{form:C,onFinish:P,style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,a.jsx)(m.Z.Item,{name:"name_propose",label:"T\xean đề xuất",rules:[{required:!0,message:"Please input the proposal name!"}],style:{width:"100%"},children:(0,a.jsx)(p.default,{})}),(0,a.jsx)(m.Z.Item,{name:"type_related",label:"Li\xean quan đến",rules:[{required:!0}],style:{minWidth:"320px",flex:"1 1 0%"},children:(0,a.jsxs)(r.Z,{placeholder:"Select a type",onChange:e=>{q(e)},children:[(0,a.jsx)(y.W,{value:"OP",children:"Cơ hội"}),(0,a.jsx)(y.W,{value:"CT",children:"Kh\xe1ch h\xe0ng"})]})}),k&&(0,a.jsx)(m.Z.Item,{name:"related_id",label:"".concat("CT"===k?"ID Kh\xe1ch h\xe0ng":"ID Cơ hội"),rules:[{required:!0}],style:{minWidth:"320px",flex:"1 1 0%"},children:"CT"===k&&(0,a.jsx)(r.Z,{placeholder:"Select a related_id",showSearch:!0,filterOption:(e,t)=>{var l,a;return(null!==(a=null==t?void 0:null===(l=t.children)||void 0===l?void 0:l.join(""))&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},children:null==S?void 0:S.map(e=>{var t,l;return(0,a.jsxs)(y.W,{value:e.info_id,children:[null==e?void 0:null===(l=e.infoContacts)||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:t.customer.full_name,"(",e.name_company,")"]},e.info_id)})})}),(0,a.jsx)(m.Z.Item,{name:"date_start",label:"Ng\xe0y bắt đầu",rules:[{required:!0}],style:{minWidth:"320px",flex:"1 1 0%"},children:(0,a.jsx)(p.default,{type:"datetime-local"})}),(0,a.jsx)(m.Z.Item,{name:"date_end",label:"Ng\xe0y kết th\xfac",rules:[{required:!0}],style:{minWidth:"320px",flex:"1 1 0%"},children:(0,a.jsx)(p.default,{type:"datetime-local"})}),(0,a.jsx)(m.Z.Item,{name:"status",label:"Trạng th\xe1i",rules:[{required:!0}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,a.jsxs)(r.Z,{placeholder:"Select status",children:[(0,a.jsx)(y.W,{value:"draff",children:"Draff"}),(0,a.jsx)(y.W,{value:"send",children:"Send"}),(0,a.jsx)(y.W,{value:"open",children:"Open"}),(0,a.jsx)(y.W,{value:"edit",children:"Edit"}),(0,a.jsx)(y.W,{value:"refuse",children:"Refuse"}),(0,a.jsx)(y.W,{value:"accept",children:"Accept"})]})}),(0,a.jsx)(m.Z.Item,{name:"type_discount",label:"Loại thuế",rules:[{required:!0}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,a.jsxs)(r.Z,{placeholder:"Select discount type",children:[(0,a.jsx)(y.W,{value:"none",children:"None"}),(0,a.jsx)(y.W,{value:"before",children:"Before"}),(0,a.jsx)(y.W,{value:"after",children:"After"})]})}),(0,a.jsx)(m.Z.Item,{name:"type_money",label:"Đơn vị tiền",rules:[{required:!0}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,a.jsxs)(r.Z,{placeholder:"Select a currency type",children:[(0,a.jsx)(y.W,{value:"vnd",children:"VND"}),(0,a.jsx)(y.W,{value:"usd",children:"USD"})]})}),(0,a.jsx)(m.Z.Item,{name:"staff_support",label:"Người phụ tr\xe1ch",rules:[{required:!0}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,a.jsx)(r.Z,{placeholder:"Chọn nh\xe2n vi\xean",showSearch:!0,filterOption:(e,t)=>{var l;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(l=null==t?void 0:t.children)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},children:null==T?void 0:T.map(e=>(0,a.jsxs)(y.W,{value:e.user_id,children:[e.first_name," ",e.last_name]},e.user_id))})}),(0,a.jsx)(m.Z.Item,{name:"email",label:"Email",rules:[{required:!0,type:"email",message:"Please enter a valid email!"}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,a.jsx)(p.default,{})}),(0,a.jsx)(m.Z.Item,{name:"phone_number",label:"Số điện thoại",rules:[{required:!0,message:"Please enter a valid phone number!"}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,a.jsx)(p.default,{})}),(0,a.jsx)(m.Z.Item,{name:"send_to",label:"Gửi đến",rules:[{required:!0}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,a.jsx)(p.default,{})}),(0,a.jsx)(m.Z.Item,{name:"province",label:"Khu vực",rules:[{required:!0}],style:{minWidth:"240px",flex:"1 1 0%"},children:(0,a.jsx)(r.Z,{placeholder:"Chọn khu vực",children:null==e?void 0:e.map(e=>(0,a.jsx)(y.W,{value:e.province_id,children:e.name_province},e.province_id))})})]})},1),(0,a.jsx)(_.Z,{tab:"Th\xf4ng tin sản phẩm",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(r.Z,{placeholder:"Chọn sản phẩm cần th\xeam",showSearch:!0,filterOption:(e,t)=>{var l;return(Array.isArray(null==t?void 0:t.children)?t.children.join(""):null!==(l=null==t?void 0:t.children)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())},children:null==T?void 0:T.map(e=>(0,a.jsxs)(y.W,{value:e.user_id,children:[e.first_name," ",e.last_name]},e.user_id))}),(0,a.jsx)(u.ZP,{type:"primary",onClick:()=>{W.resetFields(),n(!l)},children:"Th\xeam kh\xe1c"})]}),(0,a.jsx)("div",{className:"bg-slate-200 px-1 py-2 rounded-md",hidden:!l,children:(0,a.jsxs)(m.Z,{form:W,onFinish:V,style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:[(0,a.jsx)(m.Z.Item,{name:"code_product",rules:[{required:!1}],style:{minWidth:"200px",flex:"1 1 0%",margin:"0"},children:(0,a.jsx)(p.default,{placeholder:"M\xe3 sản phẩm"})}),(0,a.jsx)(m.Z.Item,{name:"name_product",rules:[{required:!0,message:"Vui l\xf2ng nhập th\xf4ng tin sản phẩm"}],style:{minWidth:"240px",flex:"1 1 0%",margin:"0"},children:(0,a.jsx)(p.default,{placeholder:"T\xean sản phẩm"})}),(0,a.jsx)(m.Z.Item,{name:"quantity_product",rules:[{required:!0,message:"Vui l\xf2ng nhập th\xf4ng tin số lượng"}],style:{minWidth:"150px",flex:"1 1 0%",margin:"0"},children:(0,a.jsx)(v.Z,{className:"w-full",placeholder:"Số lượng"})}),(0,a.jsx)(m.Z.Item,{name:"price_product",rules:[{required:!0,message:"Vui l\xf2ng nhập th\xf4ng tin gi\xe1 trị"}],style:{minWidth:"150px",flex:"1 1 0%",margin:"0"},children:(0,a.jsx)(v.Z,{className:"w-full",placeholder:"Gi\xe1 trị"})}),(0,a.jsx)(m.Z.Item,{name:"type",rules:[{required:!1}],style:{minWidth:"100px",flex:"1 1 0%",margin:"0"},children:(0,a.jsxs)(r.Z,{placeholder:"Chọn loại sản phẩm",children:[(0,a.jsx)(y.W,{value:"TB",children:"Thiết bị"},"TB"),(0,a.jsx)(y.W,{value:"VT",children:"Vật tư"},"VT")]})}),(0,a.jsx)(m.Z.Item,{name:"vat",rules:[{required:!0}],style:{minWidth:"100px",flex:"1 1 0%",margin:"0"},children:(0,a.jsx)(r.Z,{placeholder:"Chọn thuế",children:null==t?void 0:t.map(e=>(0,a.jsxs)(y.W,{value:e.vat_id,children:[e.type_vat,"%"]},e.vat_id))})}),(0,a.jsx)(m.Z.Item,{name:"description",rules:[{required:!0,message:"Vui l\xf2ng nhập th\xf4ng tin m\xf4 tả"}],style:{width:"100%",margin:"0"},children:(0,a.jsx)(g.Z,{placeholder:"M\xf4 tả",autoSize:{minRows:3}})}),(0,a.jsx)(m.Z.Item,{style:{width:"100%",display:"flex",justifyContent:"end",margin:"0"},children:(0,a.jsx)(u.ZP,{className:"bg-green-500 text-white font-semibold",onClick:()=>{W.submit()},children:"Th\xeam"})})]})}),(0,a.jsx)("div",{className:"border-t-2 w-full overflow-x-auto",children:(0,a.jsx)("div",{className:"w-fit",children:(0,a.jsx)(f.Z,{columns:w,dataSource:d,scroll:{x:"max-content"},pagination:{pageSize:10,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showSorterTooltip:{target:"sorter-icon"}})})})]})},2)]}),(0,a.jsx)("div",{className:"flex justify-end w-full mt-4",children:(0,a.jsx)(u.ZP,{type:"primary",onClick:O,children:"Tạo"})})]})]})}let{RangePicker:C}=n.default;function W(e){let{setFilterData:t,filterData:l}=e,{datas:s}=(0,Z.v9)(e=>e.get_users);return(0,a.jsxs)("div",{className:"flex items-start gap-4 w-full flex-col",children:[(0,a.jsx)("div",{className:"flex gap-1 flex-wrap",children:(0,a.jsx)(w,{})}),(0,a.jsxs)("div",{className:"flex flex-wrap w-full items-center justify-end gap-2   pb-4 ",children:[(0,a.jsx)(r.Z,{defaultValue:"0",style:{minWidth:120,flex:"1 1 0%"},onChange:e=>{t({...l,type:e})},options:[{value:"0",label:"Tất cả"},{value:"1",label:"Đ\xe3 hết hạn"},{value:"2",label:"Cơ hội"},{value:"3",label:"Kh\xe1ch h\xe0ng"}]}),(0,a.jsx)(r.Z,{placeholder:"Ng\xe0y",style:{minWidth:120,flex:"1 1 0%"},onChange:e=>{t({...l,type_date:e})},options:[{value:"0",label:"Ng\xe0y đề xuất"},{value:"1",label:"Ng\xe0y hết hạn"}]}),(0,a.jsx)(r.Z,{placeholder:"T\xecnh trạng",onChange:e=>{t({...l,status:e})},style:{minWidth:120,flex:"1 1 0%"},options:[{value:"draff",label:"Draff"},{value:"send",label:"Send"},{value:"open",label:"Open"},{value:"edit",label:"Edit"},{value:"refuse",label:"Refuse"},{value:"accept",label:"Accept"}]}),(0,a.jsx)(C,{style:{minWidth:120,flex:"1 1 0%"},onChange:(e,a)=>{t({...l,date_start:a[0],date_end:a[1]})}}),(0,a.jsx)(r.Z,{placeholder:"Người phụ tr\xe1ch",showSearch:!0,filterOption:(e,t)=>{var l,a;return(null!==(a=null==t?void 0:null===(l=t.children)||void 0===l?void 0:l.join(""))&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())},onChange:e=>{t({...l,staff_support:e})},style:{minWidth:120,flex:"1 1 0%"},children:null==s?void 0:s.map(e=>(0,a.jsxs)(y.W,{value:e.user_id,children:[e.first_name," ",e.last_name]},e.user_id))})]})]})}var S=l(3810),I=l(83410),T=l(56771),k=l(61273);function q(e){let{dataSource:t}=e,[l,n]=(0,s.useState)(25),[i,d]=(0,s.useState)(t);(0,s.useEffect)(()=>{d(null==t?void 0:t.map((e,t)=>({...e,key:t})))},[t]);let o=e=>{d(null==t?void 0:t.filter(t=>String(t.created_at+" "+t.date_end+" "+t.date_start+" "+t.name_propose+" "+t.price+" "+t.propose_id+" "+t.send_to+" "+t.status).toLowerCase().includes(e.toLowerCase())))};return(0,a.jsxs)("div",{className:"",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2 flex-wrap gap-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(r.Z,{defaultValue:l,style:{width:83},onChange:e=>n(e),options:[{value:10,label:10},{value:25,label:25},{value:50,label:50},{value:100,label:100},{value:500,label:500},{value:1e3,label:1e3},{value:1e8,label:"Tất cả"}]}),(0,a.jsx)(I.Z,{className:"ml-1",trigger:["click"],children:(0,a.jsx)(u.ZP,{children:"Xuất ra"})}),(0,a.jsx)(u.ZP,{children:(0,a.jsx)(k.Rc_,{})})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(T.Z,{onChange:e=>{o(e.target.value)},placeholder:"T\xecm kiếm",style:{width:200}})})]}),(0,a.jsx)("div",{className:"w-full overflow-auto",children:(0,a.jsx)("div",{className:"min-w-fit",children:(0,a.jsx)(f.Z,{columns:[{title:"Đề xuất#",className:"text-xs",dataIndex:"propose_id",render:(e,t,l)=>(0,a.jsxs)("div",{className:"flex flex-col gap-1 ",children:[(0,a.jsxs)("strong",{children:["#",l+1,"."]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u.ZP,{type:"text",ghost:!0,className:"text-xs text-blue-600",children:"Xem"}),(0,a.jsx)(u.ZP,{type:"text",ghost:!0,className:"text-xs text-yellow-600",children:"Chỉnh sửa"})]})]}),sorter:(e,t)=>e.propose_id.localeCompare(t.propose_id)},{title:"Ti\xeau đề",className:"text-xs",dataIndex:"name_propose",render:e=>(0,a.jsx)(a.Fragment,{children:e.length>15?"".concat(e.slice(0,15),"..."):e}),sorter:(e,t)=>e.name_propose.localeCompare(t.name_propose)},{title:"Gửi đến",className:"text-xs",dataIndex:"send_to",render:e=>(0,a.jsx)(a.Fragment,{children:e.length>15?"".concat(e.slice(0,15),"..."):e}),sorter:(e,t)=>e.send_to.localeCompare(t.send_to)},{title:"Tổng cộng",className:"text-xs",dataIndex:"price",sorter:(e,t)=>e.price-t.price,render:e=>"".concat(e.toLocaleString("vi-VN"),"đ")},{title:"Ng\xe0y đề xuất",className:"text-xs",dataIndex:"date_start",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>e.date_start.localeCompare(t.date_start)},{title:"Ng\xe0y hết hạn",className:"text-xs",dataIndex:"date_end",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>e.date_end.localeCompare(t.date_end)},{title:"Ng\xe0y tạo",className:"text-xs",dataIndex:"created_at",render:e=>e?new Date(e).toLocaleDateString("vi-VN"):"N/A",sorter:(e,t)=>e.created_at.localeCompare(t.created_at)},{title:"T\xecnh trạng",className:"text-xs",dataIndex:"status",render:e=>(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(S.Z,{color:"draff"===e?"gray":"send"===e?"lightblue":"open"===e?"blue":"edit"===e?"yellow":"refuse"===e?"red":"accept"===e?"green":"",children:[e.charAt(0).toUpperCase()+e.slice(1)," "]})}),sorter:(e,t)=>e.status.localeCompare(t.status)}],rowSelection:{},dataSource:i,scroll:{x:"max-content"},pagination:{pageSize:l,showTotal:(e,t)=>"".concat(t[0],"-").concat(t[1]," of ").concat(e," items")},showSorterTooltip:{target:"sorter-icon"}})})})]})}function L(){let[e,t]=(0,s.useState)({});return(0,a.jsxs)("div",{className:"flex flex-col gap-4 rounded-md p-4 shadow-[0_8px_30px_rgb(0,0,0,0.12)] bg-white",children:[(0,a.jsx)("div",{className:"rounded-md",children:(0,a.jsx)(W,{filterData:e,setFilterData:t})}),(0,a.jsx)("div",{className:"rounded-md",children:(0,a.jsx)(q,{dataSource:[]})})]})}function A(){return(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(L,{})})}},46475:function(e,t,l){"use strict";var a=l(2265),s=l(7261);t.Z=()=>{let[e,t]=(0,a.useState)(null),[l,n]=(0,a.useState)(null);return{postdata:async e=>{let l=s.Am.loading("Processing...");try{let a=await e();if(a)return t(a),n(a.statusCode),200===a.statusCode||201===a.statusCode?s.Am.update(l,{render:a.message,type:"success",isLoading:!1,autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}):s.Am.update(l,{render:a.message,type:"error",isLoading:!1,position:"bottom-center",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),a.statusCode;return s.Am.update(l,{render:"No response received.",type:"error",isLoading:!1,autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),null}catch(e){s.Am.update(l,{render:"An unexpected error occurred",type:"error",isLoading:!1,autoClose:3e3})}},statusCode:l,response:e}}},28223:function(e,t,l){"use strict";l.d(t,{Y:function(){return n}});var a=l(83464);let s=a.Z.create({baseURL:"https://api.sparking.cloud",timeout:2e4,headers:{"Content-Type":"application/json"},withCredentials:!0}),n=a.Z.create({baseURL:"https://api.sparking.cloud",timeout:2e4,headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});t.Z=s},90382:function(e,t,l){"use strict";l.d(t,{S:function(){return s}});var a=l(7261);let s=e=>{var t,l,s;let n=(null===(l=e.response)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:t.message)||"An unexpected error occurred",r=null===(s=e.response)||void 0===s?void 0:s.status;a.Am.dismiss(),403===r?a.Am.error("Bạn kh\xf4ng c\xf3 quyền"):a.Am.error(n)}}},function(e){e.O(0,[6051,5706,7240,5319,5651,6006,8143,7526,7464,7821,3464,9481,314,9970,5270,1412,7651,6399,5422,1250,8970,4967,3344,6498,136,6612,4628,2971,2117,1744],function(){return e(e.s=75684)}),_N_E=e.O()}]);